"use strict";var __spreadArray=function(r,t,e){if(e||2===arguments.length)for(var o,a=0,i=t.length;a<i;a++)!o&&a in t||((o=o||Array.prototype.slice.call(t,0,a))[a]=t[a]);return r.concat(o||Array.prototype.slice.call(t))};!function(r){"object"==typeof module&&"object"==typeof module.exports?r(require,exports):"function"==typeof define&&define.amd&&define(["require","exports","./constants","./utils"],r)}(function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.critical=t.error=t.warn=t.debug=t.all=t.info=t.setLogger=t.getLogger=t.LoggerImp=void 0;var e,n=r("./constants"),i=r("./utils"),o=(a.prototype.buildMessage=function(r,t,e){void 0===e&&(e=void 0);for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return r instanceof Error&&(r=r.message),e&&(r="[".concat(e.toString(),"]").concat(r)),this.logLevel&&(r="[".concat(Object.keys(n.LOGGER_LEVELS)[t],"] - ").concat(r)),this.useTimestamp&&(r="[".concat((0,i.formatDate)(new Date,this.timestampFormat),"]").concat(r)),i.stringFormat.apply(void 0,__spreadArray([r],o,!1))},a.prototype.report=function(r,t,e){void 0===t&&(t=n.LOGGER_LEVELS.INFO),void 0===e&&(e=void 0);for(var o,a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];if(!(t<this.level)){switch(t){case n.LOGGER_LEVELS.WARN:o=console.warn;break;case n.LOGGER_LEVELS.ERROR:case n.LOGGER_LEVELS.CRITICAL:o=console.error;break;case n.LOGGER_LEVELS.INFO:case n.LOGGER_LEVELS.DEBUG:case n.LOGGER_LEVELS.ALL:default:o=console.log}o(this.buildMessage.apply(this,__spreadArray([r,t,e],a,!1))),r instanceof Error&&r.stack&&this.logStackTrace&&o(this.buildMessage("\n-- StackStrace:\n{0}",t,e,r.stack))}},a.prototype.info=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.INFO,t],e,!1))},a.prototype.all=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.ALL,t],e,!1))},a.prototype.debug=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.DEBUG,t],e,!1))},a.prototype.warn=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.WARN,t],e,!1))},a.prototype.error=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.ERROR,t],e,!1))},a.prototype.critical=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.CRITICAL,t],e,!1))},a.prototype.setLevel=function(r){this.debug((0,i.stringFormat)(n.LOGGING_MSG.LEVEL_CHANGED,this.level.toString(),r.toString())),this.level=r},a);function a(r,t,e,o,a){void 0===r&&(r=n.LOGGER_LEVELS.INFO),void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===a&&(a=n.DEFAULT_TIMESTAMP_FORMAT),this.level=r,this.useTimestamp=t,this.logLevel=e,this.logStackTrace=o,this.timestampFormat=a}function s(){return e=e||new o}t.LoggerImp=o,t.getLogger=s,t.setLogger=function(r){e=r,s().debug(n.LOGGING_MSG.LOGGER_CHANGED)};t.info=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).info.apply(t,__spreadArray([r,this],e,!1))},t.all=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).all.apply(t,__spreadArray([r,this],e,!1))},t.debug=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).debug.apply(t,__spreadArray([r,this],e,!1))},t.warn=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).warn.apply(t,__spreadArray([r,this],e,!1))},t.error=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).error.apply(t,__spreadArray([r,this],e,!1))};t.critical=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).critical.apply(t,__spreadArray([r,this],e,!1))}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2dpbmcvbG9nZ2luZy5qcyIsImxvZ2dpbmcvbG9nZ2luZy50cyJdLCJuYW1lcyI6WyJfX3NwcmVhZEFycmF5IiwidG8iLCJmcm9tIiwicGFjayIsImFyZ3VtZW50cyIsImxlbmd0aCIsImFyIiwiaSIsImwiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJjb25jYXQiLCJBcnJheSIsImZhY3RvcnkiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsInYiLCJ1bmRlZmluZWQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiY3JpdGljYWwiLCJlcnJvciIsIndhcm4iLCJkZWJ1ZyIsImFsbCIsImluZm8iLCJzZXRMb2dnZXIiLCJnZXRMb2dnZXIiLCJMb2dnZXJJbXAiLCJjdXJyZW50TG9nZ2VyIiwiY29uc3RhbnRzXzEiLCJ1dGlsc18xIiwiYnVpbGRNZXNzYWdlIiwibWVzc2FnZSIsImxvZ0xldmVsIiwiaXNzdWVyIiwiYXJncyIsIl9pIiwiRXJyb3IiLCJ0b1N0cmluZyIsInRoaXMiLCJrZXlzIiwiTE9HR0VSX0xFVkVMUyIsInVzZVRpbWVzdGFtcCIsImZvcm1hdERhdGUiLCJEYXRlIiwidGltZXN0YW1wRm9ybWF0Iiwic3RyaW5nRm9ybWF0IiwiYXBwbHkiLCJyZXBvcnQiLCJsZXZlbCIsIklORk8iLCJsb2dTdGFja1RyYWNlIiwicmVwb3J0TWV0aG9kIiwiV0FSTiIsImNvbnNvbGUiLCJFUlJPUiIsIkNSSVRJQ0FMIiwiREVCVUciLCJBTEwiLCJsb2ciLCJzdGFjayIsInNldExldmVsIiwiTE9HR0lOR19NU0ciLCJMRVZFTF9DSEFOR0VEIiwiZGVmYXVsdExldmVsIiwiREVGQVVMVF9USU1FU1RBTVBfRk9STUFUIiwibG9nZ2VyIiwiTE9HR0VSX0NIQU5HRUQiLCJfYSJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsY0FBZ0QsU0FBVUMsRUFBSUMsRUFBTUMsR0FDcEUsR0FBSUEsR0FBNkIsSUFB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QUExRSxjQUFBLENBQUNzQyxFQUFTTyxNQUFTSixHQUFJLEtBVzlCekIsRUFBQVUsTUFBUSxTQUFvQlksR0Q5R2pDLElDT0EsSUFBS2dCLEVBdUdvRGIsRUFBQSxHQUFBQyxFQUFBLEVBQUFBLEVBQUF0QyxVQUFBQyxPQUFBcUMsSUFBQUQsRUFBQUMsRUFBQSxHQUFBdEMsVUFBQXNDLElBQzdEZ0MsRUFBQTFDLEtBQVlOLE1BQUsyQixNQUFBcUIsRUFBQTFFLGNBQUEsQ0FBQ3NDLEVBQVNPLE1BQVNKLEdBQUksS0FXL0J6QixFQUFBUyxTQUFXLFNBQW9CYSxHQTlHa0JHLElETHRELElBQUlpQyxFQ21Id0RqQyxFQUFBLEdBQUFDLEVBQUEsRUFBQUEsRUFBQXRDLFVBQUFDLE9BQUFxQyxJQUFBRCxFQUFBQyxFQUFBLEdBQUF0QyxVQUFBc0MsSUFDaEVnQyxFQUFBMUMsS0FBWVAsU0FBUTRCLE1BQUFxQixFQUFBMUUsY0FBQSxDQUFDc0MsRUFBU08sTUFBU0osR0FBSSIsImZpbGUiOiJsb2dnaW5nL2xvZ2dpbmcubWluLmVzbS5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbihmdW5jdGlvbiAoZmFjdG9yeSkge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICB2YXIgdiA9IGZhY3RvcnkocmVxdWlyZSwgZXhwb3J0cyk7XG4gICAgICAgIGlmICh2ICE9PSB1bmRlZmluZWQpIG1vZHVsZS5leHBvcnRzID0gdjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcbiAgICAgICAgZGVmaW5lKFtcInJlcXVpcmVcIiwgXCJleHBvcnRzXCIsIFwiLi9jb25zdGFudHNcIiwgXCIuL3V0aWxzXCJdLCBmYWN0b3J5KTtcbiAgICB9XG59KShmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbiAgICBleHBvcnRzLmNyaXRpY2FsID0gZXhwb3J0cy5lcnJvciA9IGV4cG9ydHMud2FybiA9IGV4cG9ydHMuZGVidWcgPSBleHBvcnRzLmFsbCA9IGV4cG9ydHMuaW5mbyA9IGV4cG9ydHMuc2V0TG9nZ2VyID0gZXhwb3J0cy5nZXRMb2dnZXIgPSBleHBvcnRzLkxvZ2dlckltcCA9IHZvaWQgMDtcbiAgICB2YXIgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XG4gICAgdmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcbiAgICB2YXIgTG9nZ2VySW1wID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTG9nZ2VySW1wKGRlZmF1bHRMZXZlbCwgdXNlVGltZXN0YW1wLCBsb2dMZXZlbCwgbG9nU3RhY2tUcmFjZSwgdGltZXN0YW1wRm9ybWF0KSB7XG4gICAgICAgICAgICBpZiAoZGVmYXVsdExldmVsID09PSB2b2lkIDApIHsgZGVmYXVsdExldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOyB9XG4gICAgICAgICAgICBpZiAodXNlVGltZXN0YW1wID09PSB2b2lkIDApIHsgdXNlVGltZXN0YW1wID0gdHJ1ZTsgfVxuICAgICAgICAgICAgaWYgKGxvZ0xldmVsID09PSB2b2lkIDApIHsgbG9nTGV2ZWwgPSB0cnVlOyB9XG4gICAgICAgICAgICBpZiAobG9nU3RhY2tUcmFjZSA9PT0gdm9pZCAwKSB7IGxvZ1N0YWNrVHJhY2UgPSBmYWxzZTsgfVxuICAgICAgICAgICAgaWYgKHRpbWVzdGFtcEZvcm1hdCA9PT0gdm9pZCAwKSB7IHRpbWVzdGFtcEZvcm1hdCA9IGNvbnN0YW50c18xLkRFRkFVTFRfVElNRVNUQU1QX0ZPUk1BVDsgfVxuICAgICAgICAgICAgdGhpcy5sZXZlbCA9IGRlZmF1bHRMZXZlbDtcbiAgICAgICAgICAgIHRoaXMudXNlVGltZXN0YW1wID0gdXNlVGltZXN0YW1wO1xuICAgICAgICAgICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgICAgICAgICAgdGhpcy5sb2dTdGFja1RyYWNlID0gbG9nU3RhY2tUcmFjZTtcbiAgICAgICAgICAgIHRoaXMudGltZXN0YW1wRm9ybWF0ID0gdGltZXN0YW1wRm9ybWF0O1xuICAgICAgICB9XG4gICAgICAgIExvZ2dlckltcC5wcm90b3R5cGUuYnVpbGRNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGxvZ0xldmVsLCBpc3N1ZXIpIHtcbiAgICAgICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yKVxuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLm1lc3NhZ2U7XG4gICAgICAgICAgICBpZiAoaXNzdWVyKVxuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBcIltcIi5jb25jYXQoaXNzdWVyLnRvU3RyaW5nKCksIFwiXVwiKS5jb25jYXQobWVzc2FnZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5sb2dMZXZlbClcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KE9iamVjdC5rZXlzKGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMpW2xvZ0xldmVsXSwgXCJdIC0gXCIpLmNvbmNhdChtZXNzYWdlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnVzZVRpbWVzdGFtcClcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KCgwLCB1dGlsc18xLmZvcm1hdERhdGUpKG5ldyBEYXRlKCksIHRoaXMudGltZXN0YW1wRm9ybWF0KSwgXCJdXCIpLmNvbmNhdChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLnN0cmluZ0Zvcm1hdC5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLnJlcG9ydCA9IGZ1bmN0aW9uIChtZXNzYWdlLCBsZXZlbCwgaXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAobGV2ZWwgPT09IHZvaWQgMCkgeyBsZXZlbCA9IGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GTzsgfVxuICAgICAgICAgICAgaWYgKGlzc3VlciA9PT0gdm9pZCAwKSB7IGlzc3VlciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMzsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsZXZlbCA8IHRoaXMubGV2ZWwpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIHJlcG9ydE1ldGhvZDtcbiAgICAgICAgICAgIHN3aXRjaCAobGV2ZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS53YXJuO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkNSSVRJQ0FMOlxuICAgICAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GTzpcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuREVCVUc6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLmxvZztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZmluYWxNZXNzYWdlID0gdGhpcy5idWlsZE1lc3NhZ2UuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgbGV2ZWwsIGlzc3Vlcl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgICAgICByZXBvcnRNZXRob2QoZmluYWxNZXNzYWdlKTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IgJiYgbWVzc2FnZS5zdGFjayAmJiB0aGlzLmxvZ1N0YWNrVHJhY2UpXG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kKHRoaXMuYnVpbGRNZXNzYWdlKFwiXFxuLS0gU3RhY2tTdHJhY2U6XFxuezB9XCIsIGxldmVsLCBpc3N1ZXIsIG1lc3NhZ2Uuc3RhY2spKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGlzc3Vlcikge1xuICAgICAgICAgICAgaWYgKGlzc3VlciA9PT0gdm9pZCAwKSB7IGlzc3VlciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GTywgaXNzdWVyXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5hbGwgPSBmdW5jdGlvbiAobWVzc2FnZSwgaXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAoaXNzdWVyID09PSB2b2lkIDApIHsgaXNzdWVyID0gdW5kZWZpbmVkOyB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5BTEwsIGlzc3Vlcl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgIH07XG4gICAgICAgIExvZ2dlckltcC5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAobWVzc2FnZSwgaXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAoaXNzdWVyID09PSB2b2lkIDApIHsgaXNzdWVyID0gdW5kZWZpbmVkOyB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5ERUJVRywgaXNzdWVyXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS53YXJuID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGlzc3Vlcikge1xuICAgICAgICAgICAgaWYgKGlzc3VlciA9PT0gdm9pZCAwKSB7IGlzc3VlciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuV0FSTiwgaXNzdWVyXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlLCBpc3N1ZXIpIHtcbiAgICAgICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkVSUk9SLCBpc3N1ZXJdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLmNyaXRpY2FsID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGlzc3Vlcikge1xuICAgICAgICAgICAgaWYgKGlzc3VlciA9PT0gdm9pZCAwKSB7IGlzc3VlciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuQ1JJVElDQUwsIGlzc3Vlcl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgIH07XG4gICAgICAgIExvZ2dlckltcC5wcm90b3R5cGUuc2V0TGV2ZWwgPSBmdW5jdGlvbiAobGV2ZWwpIHtcbiAgICAgICAgICAgIHRoaXMuZGVidWcoKDAsIHV0aWxzXzEuc3RyaW5nRm9ybWF0KShjb25zdGFudHNfMS5MT0dHSU5HX01TRy5MRVZFTF9DSEFOR0VELCB0aGlzLmxldmVsLnRvU3RyaW5nKCksIGxldmVsLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIExvZ2dlckltcDtcbiAgICB9KCkpO1xuICAgIGV4cG9ydHMuTG9nZ2VySW1wID0gTG9nZ2VySW1wO1xuICAgIHZhciBjdXJyZW50TG9nZ2VyO1xuICAgIGZ1bmN0aW9uIGdldExvZ2dlcigpIHtcbiAgICAgICAgaWYgKCFjdXJyZW50TG9nZ2VyKVxuICAgICAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRMb2dnZXI7XG4gICAgfVxuICAgIGV4cG9ydHMuZ2V0TG9nZ2VyID0gZ2V0TG9nZ2VyO1xuICAgIGZ1bmN0aW9uIHNldExvZ2dlcihsb2dnZXIpIHtcbiAgICAgICAgY3VycmVudExvZ2dlciA9IGxvZ2dlcjtcbiAgICAgICAgZ2V0TG9nZ2VyKCkuZGVidWcoY29uc3RhbnRzXzEuTE9HR0lOR19NU0cuTE9HR0VSX0NIQU5HRUQpO1xuICAgIH1cbiAgICBleHBvcnRzLnNldExvZ2dlciA9IHNldExvZ2dlcjtcbiAgICB2YXIgaW5mbyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgKF9hID0gZ2V0TG9nZ2VyKCkpLmluZm8uYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIHRoaXNdLCBhcmdzLCBmYWxzZSkpO1xuICAgIH07XG4gICAgZXhwb3J0cy5pbmZvID0gaW5mbztcbiAgICB2YXIgYWxsID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSBnZXRMb2dnZXIoKSkuYWxsLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCB0aGlzXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIGV4cG9ydHMuYWxsID0gYWxsO1xuICAgIHZhciBkZWJ1ZyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgKF9hID0gZ2V0TG9nZ2VyKCkpLmRlYnVnLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCB0aGlzXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIGV4cG9ydHMuZGVidWcgPSBkZWJ1ZztcbiAgICB2YXIgd2FybiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgKF9hID0gZ2V0TG9nZ2VyKCkpLndhcm4uYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIHRoaXNdLCBhcmdzLCBmYWxzZSkpO1xuICAgIH07XG4gICAgZXhwb3J0cy53YXJuID0gd2FybjtcbiAgICB2YXIgZXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIChfYSA9IGdldExvZ2dlcigpKS5lcnJvci5hcHBseShfYSwgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgdGhpc10sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBleHBvcnRzLmVycm9yID0gZXJyb3I7XG4gICAgdmFyIGNyaXRpY2FsID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSBnZXRMb2dnZXIoKSkuY3JpdGljYWwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIHRoaXNdLCBhcmdzLCBmYWxzZSkpO1xuICAgIH07XG4gICAgZXhwb3J0cy5jcml0aWNhbCA9IGNyaXRpY2FsO1xufSk7IiwiaW1wb3J0IHtERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQsIExPR0dFUl9MRVZFTFMsIExPR0dJTkdfTVNHfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7Zm9ybWF0RGF0ZSwgc3RyaW5nRm9ybWF0fSBmcm9tIFwiLi91dGlsc1wiO1xuXG4vKipcbiAqIEB0eXBlZGVmIExvZ2dlck1lc3NhZ2VcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IHR5cGUgTG9nZ2VyTWVzc2FnZSA9IEVycm9yIHwgc3RyaW5nO1xuXG4vKipcbiAqIEBpbnRlcmZhY2UgTG9nZ2VyXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyIHtcbiAgICAvKipcbiAgICAgKiBSZXBvcnRzIGEgbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbFxuICAgICAqIEBwYXJhbSB7YW55fSBbaXNzdWVyXSB0aGUgT2JqZWN0L3Byb2Nlc3MgdGhhdCByZXBvcnRzIHRoZSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHthbnlbXX0gW2FyZ3NdXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTG9nZ2VyXG4gICAgICovXG4gICAgcmVwb3J0KG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGxldmVsOiBudW1iZXIsIGlzc3VlcjogYW55LCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQUxMfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIGFsbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBpbmZvKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5ERUJVR31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBkZWJ1ZyhtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICB3YXJuKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5FUlJPUn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQ1JJVElDQUx9XG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHthbnlbXX0gW2FyZ3NdXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTG9nZ2VyXG4gICAgICovXG4gICAgY3JpdGljYWwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIERlZmluZXMgdGhlIExvZ2dlciBsZXZlbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsXG4gICAgICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHNldExldmVsKGxldmVsOiBudW1iZXIsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IExvZ2dlciBJbXBsZW1lbnRhdGlvblxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZWZhdWx0TGV2ZWwgZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlVGltZXN0YW1wIGRlZmF1bHRzIHRvIHRydWVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nTGV2ZWxcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nU3RhY2tUcmFjZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpbWVzdGFtcEZvcm1hdFxuICpcbiAqIEBjbGFzcyBMb2dnZXJJbXBcbiAqIEBpbXBsZW1lbnRzIExvZ2dlclxuICovXG5leHBvcnQgY2xhc3MgTG9nZ2VySW1wIGltcGxlbWVudHMgTG9nZ2VyIHtcbiAgICBwcml2YXRlIGxldmVsOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IHVzZVRpbWVzdGFtcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxvZ0xldmVsOiBib29sZWFuO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdGltZXN0YW1wRm9ybWF0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSByZWFkb25seSBsb2dTdGFja1RyYWNlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoZGVmYXVsdExldmVsOiBudW1iZXIgPSBMT0dHRVJfTEVWRUxTLklORk8sIHVzZVRpbWVzdGFtcCA9IHRydWUsIGxvZ0xldmVsOiBib29sZWFuID0gdHJ1ZSwgbG9nU3RhY2tUcmFjZTogYm9vbGVhbiA9IGZhbHNlLCB0aW1lc3RhbXBGb3JtYXQgPSBERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQpe1xuICAgICAgICB0aGlzLmxldmVsID0gZGVmYXVsdExldmVsO1xuICAgICAgICB0aGlzLnVzZVRpbWVzdGFtcCA9IHVzZVRpbWVzdGFtcDtcbiAgICAgICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgICAgICB0aGlzLmxvZ1N0YWNrVHJhY2UgPSBsb2dTdGFja1RyYWNlO1xuICAgICAgICB0aGlzLnRpbWVzdGFtcEZvcm1hdCA9IHRpbWVzdGFtcEZvcm1hdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsdHMgdGhlIGFjdHVhbCBsb2dnaW5nIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbG9nTGV2ZWwgaWYgdGhlIGxldmVsIGlzIHRvIGJlIGxvZ2dlZFxuICAgICAqIEBwYXJhbSB7YW55fSBpc3N1ZXIgd2hvIGlzIGxvZ2dpbmcgdGhlIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBidWlsZE1lc3NhZ2UobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgbG9nTGV2ZWw6IG51bWJlciwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKXtcbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBFcnJvcilcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLm1lc3NhZ2U7XG5cbiAgICAgICAgaWYgKGlzc3VlcilcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgWyR7aXNzdWVyLnRvU3RyaW5nKCl9XSR7bWVzc2FnZX1gO1xuICAgICAgICBpZiAodGhpcy5sb2dMZXZlbClcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgWyR7T2JqZWN0LmtleXMoTE9HR0VSX0xFVkVMUylbbG9nTGV2ZWxdfV0gLSAke21lc3NhZ2V9YDtcbiAgICAgICAgaWYgKHRoaXMudXNlVGltZXN0YW1wKVxuICAgICAgICAgICAgbWVzc2FnZSA9IGBbJHtmb3JtYXREYXRlKG5ldyBEYXRlKCksIHRoaXMudGltZXN0YW1wRm9ybWF0KX1dJHttZXNzYWdlfWA7XG4gICAgICAgIHJldHVybiBzdHJpbmdGb3JtYXQobWVzc2FnZSwgLi4uYXJncyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGV2ZWwgZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAgICAgKiBAcGFyYW0ge2FueX0gW2lzc3Vlcl0gdGhlIG9iamVjdCB0aGF0IGlzIGNhbGxpbmcgdGhlIHJlcG9ydCBtZXRob2RcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc10gdmFsdWVzIHRvIHJlcGxhY2UgaW4gdGhlIG1lc3NhZ2UgYWNjb3JkaW5nIHRvIHRoZSAnezB9JyBub3RhdGlvblxuICAgICAqL1xuICAgIHJlcG9ydChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyID0gTE9HR0VSX0xFVkVMUy5JTkZPLCBpc3N1ZXI6IGFueSA9IHVuZGVmaW5lZCwgLi4uYXJnczogYW55W10pIDogdm9pZCB7XG4gICAgICAgIGlmIChsZXZlbCA8IHRoaXMubGV2ZWwpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgbGV0IHJlcG9ydE1ldGhvZDogRnVuY3Rpb247XG4gICAgICAgIHN3aXRjaCAobGV2ZWwpe1xuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLldBUk46XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS53YXJuO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkVSUk9SOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMOlxuICAgICAgICAgICAgICAgIHJlcG9ydE1ldGhvZCA9IGNvbnNvbGUuZXJyb3I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuSU5GTzpcbiAgICAgICAgICAgIGNhc2UgTE9HR0VSX0xFVkVMUy5ERUJVRzpcbiAgICAgICAgICAgIGNhc2UgTE9HR0VSX0xFVkVMUy5BTEw6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJlcG9ydE1ldGhvZCA9IGNvbnNvbGUubG9nO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGZpbmFsTWVzc2FnZSA9IHRoaXMuYnVpbGRNZXNzYWdlKG1lc3NhZ2UsIGxldmVsLCBpc3N1ZXIsIC4uLmFyZ3MpO1xuICAgICAgICByZXBvcnRNZXRob2QoZmluYWxNZXNzYWdlKTtcblxuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yICYmIG1lc3NhZ2Uuc3RhY2sgJiYgdGhpcy5sb2dTdGFja1RyYWNlKVxuICAgICAgICAgICAgcmVwb3J0TWV0aG9kKHRoaXMuYnVpbGRNZXNzYWdlKGBcXG4tLSBTdGFja1N0cmFjZTpcXG57MH1gLCBsZXZlbCwgaXNzdWVyLCBtZXNzYWdlLnN0YWNrKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBpbmZvKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGlzc3VlcjogYW55ID0gdW5kZWZpbmVkLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLklORk8sIGlzc3VlciwgLi4uYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgYWxsKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGlzc3VlcjogYW55ID0gdW5kZWZpbmVkLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkFMTCwgaXNzdWVyLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBkZWJ1ZyhtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBpc3N1ZXI6IGFueSA9IHVuZGVmaW5lZCwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5ERUJVRywgaXNzdWVyLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICB3YXJuKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGlzc3VlcjogYW55ID0gdW5kZWZpbmVkLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLldBUk4sIGlzc3VlciwgLi4uYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgZXJyb3IobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuRVJST1IsIGlzc3VlciwgLi4uYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgY3JpdGljYWwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuQ1JJVElDQUwsIGlzc3VlciwgLi4uYXJncyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbmhlcml0RG9jXG4gICAgICovXG4gICAgc2V0TGV2ZWwobGV2ZWw6IG51bWJlcik6IHZvaWQge1xuICAgICAgICB0aGlzLmRlYnVnKHN0cmluZ0Zvcm1hdChMT0dHSU5HX01TRy5MRVZFTF9DSEFOR0VELCB0aGlzLmxldmVsLnRvU3RyaW5nKCksIGxldmVsLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgdGhpcy5sZXZlbCA9IGxldmVsO1xuICAgIH1cbn1cblxubGV0IGN1cnJlbnRMb2dnZXI6IExvZ2dlcjtcblxuLyoqXG4gKiBnZXRzIHRoZSBjdXJyZW50IExvZ2dlclxuICpcbiAqIEBmdW5jdGlvbiBnZXRMb2dnZXJcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb2dnZXIoKXtcbiAgICBpZiAoIWN1cnJlbnRMb2dnZXIpXG4gICAgICAgIGN1cnJlbnRMb2dnZXIgPSBuZXcgTG9nZ2VySW1wKCk7XG4gICAgcmV0dXJuIGN1cnJlbnRMb2dnZXI7XG59XG5cbi8qKlxuICogU2V0cyB0aGUgbG9nZ2VyXG4gKlxuICogQHBhcmFtIHtMb2dnZXJ9IGxvZ2dlclxuICpcbiAqIEBmdW5jdGlvbiBzZXRMb2dnZXJcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzZXRMb2dnZXIobG9nZ2VyOiBMb2dnZXIpe1xuICAgIGN1cnJlbnRMb2dnZXIgPSBsb2dnZXI7XG4gICAgZ2V0TG9nZ2VyKCkuZGVidWcoTE9HR0lOR19NU0cuTE9HR0VSX0NIQU5HRUQpO1xufVxuXG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLklORk99XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gaW5mb1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGluZm8gPSBmdW5jdGlvbih0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgZ2V0TG9nZ2VyKCkuaW5mbyhtZXNzYWdlLCB0aGlzLCAuLi5hcmdzKTtcbn1cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuQUxMfVxuICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGFsbFxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGFsbCA9IGZ1bmN0aW9uKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pIHtcbiAgICBnZXRMb2dnZXIoKS5hbGwobWVzc2FnZSwgdGhpcywgLi4uYXJncyk7XG59XG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLkRFQlVHfVxuICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGRlYnVnXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgZGVidWcgPSBmdW5jdGlvbih0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgZ2V0TG9nZ2VyKCkuZGVidWcobWVzc2FnZSwgdGhpcywgLi4uYXJncyk7XG59XG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLldBUk59XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gd2FyblxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IHdhcm4gPSBmdW5jdGlvbih0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgZ2V0TG9nZ2VyKCkud2FybihtZXNzYWdlLCB0aGlzLCAuLi5hcmdzKTtcbn1cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuRVJST1J9XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gZXJyb3JcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBlcnJvciA9IGZ1bmN0aW9uKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pIHtcbiAgICBnZXRMb2dnZXIoKS5lcnJvcihtZXNzYWdlLCB0aGlzLCAuLi5hcmdzKTtcbn1cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuQ1JJVElDQUx9XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gY3JpdGljYWxcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBjcml0aWNhbCA9IGZ1bmN0aW9uKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pIHtcbiAgICBnZXRMb2dnZXIoKS5jcml0aWNhbChtZXNzYWdlLCB0aGlzLCAuLi5hcmdzKTtcbn0iXX0=
