"use strict";var __spreadArray=function(r,t,e){if(e||2===arguments.length)for(var o,a=0,i=t.length;a<i;a++)!o&&a in t||((o=o||Array.prototype.slice.call(t,0,a))[a]=t[a]);return r.concat(o||Array.prototype.slice.call(t))};!function(r){"object"==typeof module&&"object"==typeof module.exports?r(require,exports):"function"==typeof define&&define.amd&&define(["require","exports","./constants","./utils"],r)}(function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.critical=t.error=t.warn=t.debug=t.all=t.info=t.setLogger=t.getLogger=t.LoggerImp=void 0;var e,n=r("./constants"),i=r("./utils"),o=(a.prototype.buildMessage=function(r,t,e){void 0===e&&(e=void 0);for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return r instanceof Error&&(r=r.message),this.logLevel&&(r="[".concat(Object.keys(n.LOGGER_LEVELS)[t],"] - ").concat(r)),e&&(r="[".concat(e.toString(),"]").concat(r)),this.useTimestamp&&(r="[".concat((0,i.formatDate)(new Date,this.timestampFormat),"]").concat(r)),i.stringFormat.apply(void 0,__spreadArray([r],o,!1))},a.prototype.report=function(r,t,e){void 0===t&&(t=n.LOGGER_LEVELS.INFO),void 0===e&&(e=void 0);for(var o,a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];if(!(t<this.level)){switch(t){case n.LOGGER_LEVELS.WARN:o=console.warn;break;case n.LOGGER_LEVELS.ERROR:case n.LOGGER_LEVELS.CRITICAL:o=console.error;break;case n.LOGGER_LEVELS.INFO:case n.LOGGER_LEVELS.DEBUG:case n.LOGGER_LEVELS.ALL:default:o=console.log}o(this.buildMessage.apply(this,__spreadArray([r,t,e],a,!1))),r instanceof Error&&r.stack&&this.logStackTrace&&o(this.buildMessage("\n-- StackStrace:\n{0}",t,e,r.stack))}},a.prototype.info=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.INFO,t],e,!1))},a.prototype.all=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.ALL,t],e,!1))},a.prototype.debug=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.DEBUG,t],e,!1))},a.prototype.warn=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.WARN,t],e,!1))},a.prototype.error=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.ERROR,t],e,!1))},a.prototype.critical=function(r,t){void 0===t&&(t=void 0);for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.CRITICAL,t],e,!1))},a.prototype.setLevel=function(r){this.debug((0,i.stringFormat)(n.LOGGING_MSG.LEVEL_CHANGED,this.level.toString(),r.toString())),this.level=r},a);function a(r,t,e,o,a){void 0===r&&(r=n.LOGGER_LEVELS.INFO),void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===a&&(a=n.DEFAULT_TIMESTAMP_FORMAT),this.level=r,this.useTimestamp=t,this.logLevel=e,this.logStackTrace=o,this.timestampFormat=a}function s(){return e=e||new o}t.LoggerImp=o,t.getLogger=s,t.setLogger=function(r){e=r,s().debug(n.LOGGING_MSG.LOGGER_CHANGED)};t.info=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).info.apply(t,__spreadArray([r,this],e,!1))},t.all=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).all.apply(t,__spreadArray([r,this],e,!1))},t.debug=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).debug.apply(t,__spreadArray([r,this],e,!1))},t.warn=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).warn.apply(t,__spreadArray([r,this],e,!1))},t.error=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).error.apply(t,__spreadArray([r,this],e,!1))};t.critical=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];(t=s()).critical.apply(t,__spreadArray([r,this],e,!1))}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2dpbmcvbG9nZ2luZy5qcyIsImxvZ2dpbmcvbG9nZ2luZy50cyJdLCJuYW1lcyI6WyJfX3NwcmVhZEFycmF5IiwidG8iLCJmcm9tIiwicGFjayIsImFyZ3VtZW50cyIsImxlbmd0aCIsImFyIiwiaSIsImwiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJjb25jYXQiLCJBcnJheSIsImZhY3RvcnkiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsInYiLCJ1bmRlZmluZWQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiY3JpdGljYWwiLCJlcnJvciIsIndhcm4iLCJkZWJ1ZyIsImFsbCIsImluZm8iLCJzZXRMb2dnZXIiLCJnZXRMb2dnZXIiLCJMb2dnZXJJbXAiLCJjdXJyZW50TG9nZ2VyIiwiY29uc3RhbnRzXzEiLCJ1dGlsc18xIiwiYnVpbGRNZXNzYWdlIiwibWVzc2FnZSIsImxvZ0xldmVsIiwiaXNzdWVyIiwiYXJncyIsIl9pIiwiRXJyb3IiLCJ0aGlzIiwia2V5cyIsIkxPR0dFUl9MRVZFTFMiLCJ0b1N0cmluZyIsInVzZVRpbWVzdGFtcCIsImZvcm1hdERhdGUiLCJEYXRlIiwidGltZXN0YW1wRm9ybWF0Iiwic3RyaW5nRm9ybWF0IiwiYXBwbHkiLCJyZXBvcnQiLCJsZXZlbCIsIklORk8iLCJsb2dTdGFja1RyYWNlIiwicmVwb3J0TWV0aG9kIiwiV0FSTiIsImNvbnNvbGUiLCJFUlJPUiIsIkNSSVRJQ0FMIiwiREVCVUciLCJBTEwiLCJsb2ciLCJzdGFjayIsInNldExldmVsIiwiTE9HR0lOR19NU0ciLCJMRVZFTF9DSEFOR0VEIiwiZGVmYXVsdExldmVsIiwiREVGQVVMVF9USU1FU1RBTVBfRk9STUFUIiwibG9nZ2VyIiwiTE9HR0VSX0NIQU5HRUQiLCJfYSJdLCJtYXBwaW5ncyI6ImFBQUEsSUFBSUEsY0FBZ0QsU0FBVUMsRUFBSUMsRUFBTUMsR0FDcEUsR0FBSUEsR0FBNkIsSUFB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RUFBQTFFLGNBQUEsQ0FBQ3NDLEVBQVNNLE1BQVNILEdBQUksS0FXOUJ6QixFQUFBVSxNQUFRLFNBQW9CWSxHRDlHakMsSUNPQSxJQUFLZ0IsRUF1R29EYixFQUFBLEdBQUFDLEVBQUEsRUFBQUEsRUFBQXRDLFVBQUFDLE9BQUFxQyxJQUFBRCxFQUFBQyxFQUFBLEdBQUF0QyxVQUFBc0MsSUFDN0RnQyxFQUFBMUMsS0FBWU4sTUFBSzJCLE1BQUFxQixFQUFBMUUsY0FBQSxDQUFDc0MsRUFBU00sTUFBU0gsR0FBSSxLQVcvQnpCLEVBQUFTLFNBQVcsU0FBb0JhLEdBOUdrQkcsSURMdEQsSUFBSWlDLEVDbUh3RGpDLEVBQUEsR0FBQUMsRUFBQSxFQUFBQSxFQUFBdEMsVUFBQUMsT0FBQXFDLElBQUFELEVBQUFDLEVBQUEsR0FBQXRDLFVBQUFzQyxJQUNoRWdDLEVBQUExQyxLQUFZUCxTQUFRNEIsTUFBQXFCLEVBQUExRSxjQUFBLENBQUNzQyxFQUFTTSxNQUFTSCxHQUFJIiwiZmlsZSI6ImxvZ2dpbmcvbG9nZ2luZy5taW4uZXNtLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuKGZ1bmN0aW9uIChmYWN0b3J5KSB7XG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIG1vZHVsZS5leHBvcnRzID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHZhciB2ID0gZmFjdG9yeShyZXF1aXJlLCBleHBvcnRzKTtcbiAgICAgICAgaWYgKHYgIT09IHVuZGVmaW5lZCkgbW9kdWxlLmV4cG9ydHMgPSB2O1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSBcImZ1bmN0aW9uXCIgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICBkZWZpbmUoW1wicmVxdWlyZVwiLCBcImV4cG9ydHNcIiwgXCIuL2NvbnN0YW50c1wiLCBcIi4vdXRpbHNcIl0sIGZhY3RvcnkpO1xuICAgIH1cbn0pKGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuICAgIGV4cG9ydHMuY3JpdGljYWwgPSBleHBvcnRzLmVycm9yID0gZXhwb3J0cy53YXJuID0gZXhwb3J0cy5kZWJ1ZyA9IGV4cG9ydHMuYWxsID0gZXhwb3J0cy5pbmZvID0gZXhwb3J0cy5zZXRMb2dnZXIgPSBleHBvcnRzLmdldExvZ2dlciA9IGV4cG9ydHMuTG9nZ2VySW1wID0gdm9pZCAwO1xuICAgIHZhciBjb25zdGFudHNfMSA9IHJlcXVpcmUoXCIuL2NvbnN0YW50c1wiKTtcbiAgICB2YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuL3V0aWxzXCIpO1xuICAgIHZhciBMb2dnZXJJbXAgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBMb2dnZXJJbXAoZGVmYXVsdExldmVsLCB1c2VUaW1lc3RhbXAsIGxvZ0xldmVsLCBsb2dTdGFja1RyYWNlLCB0aW1lc3RhbXBGb3JtYXQpIHtcbiAgICAgICAgICAgIGlmIChkZWZhdWx0TGV2ZWwgPT09IHZvaWQgMCkgeyBkZWZhdWx0TGV2ZWwgPSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLklORk87IH1cbiAgICAgICAgICAgIGlmICh1c2VUaW1lc3RhbXAgPT09IHZvaWQgMCkgeyB1c2VUaW1lc3RhbXAgPSB0cnVlOyB9XG4gICAgICAgICAgICBpZiAobG9nTGV2ZWwgPT09IHZvaWQgMCkgeyBsb2dMZXZlbCA9IHRydWU7IH1cbiAgICAgICAgICAgIGlmIChsb2dTdGFja1RyYWNlID09PSB2b2lkIDApIHsgbG9nU3RhY2tUcmFjZSA9IGZhbHNlOyB9XG4gICAgICAgICAgICBpZiAodGltZXN0YW1wRm9ybWF0ID09PSB2b2lkIDApIHsgdGltZXN0YW1wRm9ybWF0ID0gY29uc3RhbnRzXzEuREVGQVVMVF9USU1FU1RBTVBfRk9STUFUOyB9XG4gICAgICAgICAgICB0aGlzLmxldmVsID0gZGVmYXVsdExldmVsO1xuICAgICAgICAgICAgdGhpcy51c2VUaW1lc3RhbXAgPSB1c2VUaW1lc3RhbXA7XG4gICAgICAgICAgICB0aGlzLmxvZ0xldmVsID0gbG9nTGV2ZWw7XG4gICAgICAgICAgICB0aGlzLmxvZ1N0YWNrVHJhY2UgPSBsb2dTdGFja1RyYWNlO1xuICAgICAgICAgICAgdGhpcy50aW1lc3RhbXBGb3JtYXQgPSB0aW1lc3RhbXBGb3JtYXQ7XG4gICAgICAgIH1cbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5idWlsZE1lc3NhZ2UgPSBmdW5jdGlvbiAobWVzc2FnZSwgbG9nTGV2ZWwsIGlzc3Vlcikge1xuICAgICAgICAgICAgaWYgKGlzc3VlciA9PT0gdm9pZCAwKSB7IGlzc3VlciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMzsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IpXG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UubWVzc2FnZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmxvZ0xldmVsKVxuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBcIltcIi5jb25jYXQoT2JqZWN0LmtleXMoY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUylbbG9nTGV2ZWxdLCBcIl0gLSBcIikuY29uY2F0KG1lc3NhZ2UpO1xuICAgICAgICAgICAgaWYgKGlzc3VlcilcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KGlzc3Vlci50b1N0cmluZygpLCBcIl1cIikuY29uY2F0KG1lc3NhZ2UpO1xuICAgICAgICAgICAgaWYgKHRoaXMudXNlVGltZXN0YW1wKVxuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBcIltcIi5jb25jYXQoKDAsIHV0aWxzXzEuZm9ybWF0RGF0ZSkobmV3IERhdGUoKSwgdGhpcy50aW1lc3RhbXBGb3JtYXQpLCBcIl1cIikuY29uY2F0KG1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIHV0aWxzXzEuc3RyaW5nRm9ybWF0LmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbbWVzc2FnZV0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgIH07XG4gICAgICAgIExvZ2dlckltcC5wcm90b3R5cGUucmVwb3J0ID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGxldmVsLCBpc3N1ZXIpIHtcbiAgICAgICAgICAgIGlmIChsZXZlbCA9PT0gdm9pZCAwKSB7IGxldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOyB9XG4gICAgICAgICAgICBpZiAoaXNzdWVyID09PSB2b2lkIDApIHsgaXNzdWVyID0gdW5kZWZpbmVkOyB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxldmVsIDwgdGhpcy5sZXZlbClcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB2YXIgcmVwb3J0TWV0aG9kO1xuICAgICAgICAgICAgc3dpdGNoIChsZXZlbCkge1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5XQVJOOlxuICAgICAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLndhcm47XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5FUlJPUjpcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuQ1JJVElDQUw6XG4gICAgICAgICAgICAgICAgICAgIHJlcG9ydE1ldGhvZCA9IGNvbnNvbGUuZXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOlxuICAgICAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5ERUJVRzpcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuQUxMOlxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJlcG9ydE1ldGhvZCA9IGNvbnNvbGUubG9nO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmaW5hbE1lc3NhZ2UgPSB0aGlzLmJ1aWxkTWVzc2FnZS5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBsZXZlbCwgaXNzdWVyXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgICAgIHJlcG9ydE1ldGhvZChmaW5hbE1lc3NhZ2UpO1xuICAgICAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBFcnJvciAmJiBtZXNzYWdlLnN0YWNrICYmIHRoaXMubG9nU3RhY2tUcmFjZSlcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoXCJcXG4tLSBTdGFja1N0cmFjZTpcXG57MH1cIiwgbGV2ZWwsIGlzc3VlciwgbWVzc2FnZS5zdGFjaykpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLmluZm8gPSBmdW5jdGlvbiAobWVzc2FnZSwgaXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAoaXNzdWVyID09PSB2b2lkIDApIHsgaXNzdWVyID0gdW5kZWZpbmVkOyB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPLCBpc3N1ZXJdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uIChtZXNzYWdlLCBpc3N1ZXIpIHtcbiAgICAgICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkFMTCwgaXNzdWVyXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5kZWJ1ZyA9IGZ1bmN0aW9uIChtZXNzYWdlLCBpc3N1ZXIpIHtcbiAgICAgICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHLCBpc3N1ZXJdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLndhcm4gPSBmdW5jdGlvbiAobWVzc2FnZSwgaXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAoaXNzdWVyID09PSB2b2lkIDApIHsgaXNzdWVyID0gdW5kZWZpbmVkOyB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5XQVJOLCBpc3N1ZXJdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGlzc3Vlcikge1xuICAgICAgICAgICAgaWYgKGlzc3VlciA9PT0gdm9pZCAwKSB7IGlzc3VlciA9IHVuZGVmaW5lZDsgfVxuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuRVJST1IsIGlzc3Vlcl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgIH07XG4gICAgICAgIExvZ2dlckltcC5wcm90b3R5cGUuY3JpdGljYWwgPSBmdW5jdGlvbiAobWVzc2FnZSwgaXNzdWVyKSB7XG4gICAgICAgICAgICBpZiAoaXNzdWVyID09PSB2b2lkIDApIHsgaXNzdWVyID0gdW5kZWZpbmVkOyB9XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5DUklUSUNBTCwgaXNzdWVyXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5zZXRMZXZlbCA9IGZ1bmN0aW9uIChsZXZlbCkge1xuICAgICAgICAgICAgdGhpcy5kZWJ1ZygoMCwgdXRpbHNfMS5zdHJpbmdGb3JtYXQpKGNvbnN0YW50c18xLkxPR0dJTkdfTVNHLkxFVkVMX0NIQU5HRUQsIHRoaXMubGV2ZWwudG9TdHJpbmcoKSwgbGV2ZWwudG9TdHJpbmcoKSkpO1xuICAgICAgICAgICAgdGhpcy5sZXZlbCA9IGxldmVsO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTG9nZ2VySW1wO1xuICAgIH0oKSk7XG4gICAgZXhwb3J0cy5Mb2dnZXJJbXAgPSBMb2dnZXJJbXA7XG4gICAgdmFyIGN1cnJlbnRMb2dnZXI7XG4gICAgZnVuY3Rpb24gZ2V0TG9nZ2VyKCkge1xuICAgICAgICBpZiAoIWN1cnJlbnRMb2dnZXIpXG4gICAgICAgICAgICBjdXJyZW50TG9nZ2VyID0gbmV3IExvZ2dlckltcCgpO1xuICAgICAgICByZXR1cm4gY3VycmVudExvZ2dlcjtcbiAgICB9XG4gICAgZXhwb3J0cy5nZXRMb2dnZXIgPSBnZXRMb2dnZXI7XG4gICAgZnVuY3Rpb24gc2V0TG9nZ2VyKGxvZ2dlcikge1xuICAgICAgICBjdXJyZW50TG9nZ2VyID0gbG9nZ2VyO1xuICAgICAgICBnZXRMb2dnZXIoKS5kZWJ1Zyhjb25zdGFudHNfMS5MT0dHSU5HX01TRy5MT0dHRVJfQ0hBTkdFRCk7XG4gICAgfVxuICAgIGV4cG9ydHMuc2V0TG9nZ2VyID0gc2V0TG9nZ2VyO1xuICAgIHZhciBpbmZvID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSBnZXRMb2dnZXIoKSkuaW5mby5hcHBseShfYSwgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgdGhpc10sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBleHBvcnRzLmluZm8gPSBpbmZvO1xuICAgIHZhciBhbGwgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIChfYSA9IGdldExvZ2dlcigpKS5hbGwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIHRoaXNdLCBhcmdzLCBmYWxzZSkpO1xuICAgIH07XG4gICAgZXhwb3J0cy5hbGwgPSBhbGw7XG4gICAgdmFyIGRlYnVnID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSBnZXRMb2dnZXIoKSkuZGVidWcuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIHRoaXNdLCBhcmdzLCBmYWxzZSkpO1xuICAgIH07XG4gICAgZXhwb3J0cy5kZWJ1ZyA9IGRlYnVnO1xuICAgIHZhciB3YXJuID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICAoX2EgPSBnZXRMb2dnZXIoKSkud2Fybi5hcHBseShfYSwgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgdGhpc10sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBleHBvcnRzLndhcm4gPSB3YXJuO1xuICAgIHZhciBlcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgKF9hID0gZ2V0TG9nZ2VyKCkpLmVycm9yLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCB0aGlzXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIGV4cG9ydHMuZXJyb3IgPSBlcnJvcjtcbiAgICB2YXIgY3JpdGljYWwgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIChfYSA9IGdldExvZ2dlcigpKS5jcml0aWNhbC5hcHBseShfYSwgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgdGhpc10sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBleHBvcnRzLmNyaXRpY2FsID0gY3JpdGljYWw7XG59KTsiLCJpbXBvcnQge0RFRkFVTFRfVElNRVNUQU1QX0ZPUk1BVCwgTE9HR0VSX0xFVkVMUywgTE9HR0lOR19NU0d9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuaW1wb3J0IHtmb3JtYXREYXRlLCBzdHJpbmdGb3JtYXR9IGZyb20gXCIuL3V0aWxzXCI7XG5cbi8qKlxuICogQHR5cGVkZWYgTG9nZ2VyTWVzc2FnZVxuICogQG1lbWJlck9mIGxvZ2dpbmcubG9nZ2luZ1xuICovXG5leHBvcnQgdHlwZSBMb2dnZXJNZXNzYWdlID0gRXJyb3IgfCBzdHJpbmc7XG5cbi8qKlxuICogQGludGVyZmFjZSBMb2dnZXJcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBMb2dnZXIge1xuICAgIC8qKlxuICAgICAqIFJlcG9ydHMgYSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsXG4gICAgICogQHBhcmFtIHthbnl9IFtpc3N1ZXJdIHRoZSBPYmplY3QvcHJvY2VzcyB0aGF0IHJlcG9ydHMgdGhlIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICByZXBvcnQobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgbGV2ZWw6IG51bWJlciwgaXNzdWVyOiBhbnksIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5BTEx9XG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHthbnlbXX0gW2FyZ3NdXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTG9nZ2VyXG4gICAgICovXG4gICAgYWxsKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5JTkZPfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIGluZm8obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIHtAbGluayBMb2dnZXIjcmVwb3J0fXMgYSBtZXNzYWdlIHVuZGVyIHtAbGluayBMT0dHRVJfTEVWRUxTLkRFQlVHfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIGRlYnVnKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5XQVJOfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHdhcm4obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIHtAbGluayBMb2dnZXIjcmVwb3J0fXMgYSBtZXNzYWdlIHVuZGVyIHtAbGluayBMT0dHRVJfTEVWRUxTLkVSUk9SfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIGVycm9yKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5DUklUSUNBTH1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBjcml0aWNhbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogRGVmaW5lcyB0aGUgTG9nZ2VyIGxldmVsXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbGV2ZWxcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTG9nZ2VyXG4gICAgICovXG4gICAgc2V0TGV2ZWwobGV2ZWw6IG51bWJlciwgLi4uYXJnczogYW55W10pOiB2b2lkO1xufVxuXG4vKipcbiAqIERlZmF1bHQgTG9nZ2VyIEltcGxlbWVudGF0aW9uXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IGRlZmF1bHRMZXZlbCBkZWZhdWx0cyB0byB7QGxpbmsgTE9HR0VSX0xFVkVMUy5JTkZPfVxuICogQHBhcmFtIHtib29sZWFufSB1c2VUaW1lc3RhbXAgZGVmYXVsdHMgdG8gdHJ1ZVxuICogQHBhcmFtIHtib29sZWFufSBsb2dMZXZlbFxuICogQHBhcmFtIHtib29sZWFufSBsb2dTdGFja1RyYWNlXG4gKiBAcGFyYW0ge3N0cmluZ30gdGltZXN0YW1wRm9ybWF0XG4gKlxuICogQGNsYXNzIExvZ2dlckltcFxuICogQGltcGxlbWVudHMgTG9nZ2VyXG4gKi9cbmV4cG9ydCBjbGFzcyBMb2dnZXJJbXAgaW1wbGVtZW50cyBMb2dnZXIge1xuICAgIHByaXZhdGUgbGV2ZWw6IG51bWJlcjtcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgdXNlVGltZXN0YW1wOiBib29sZWFuO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgbG9nTGV2ZWw6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSByZWFkb25seSB0aW1lc3RhbXBGb3JtYXQ6IHN0cmluZztcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxvZ1N0YWNrVHJhY2U6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihkZWZhdWx0TGV2ZWw6IG51bWJlciA9IExPR0dFUl9MRVZFTFMuSU5GTywgdXNlVGltZXN0YW1wID0gdHJ1ZSwgbG9nTGV2ZWw6IGJvb2xlYW4gPSB0cnVlLCBsb2dTdGFja1RyYWNlOiBib29sZWFuID0gZmFsc2UsIHRpbWVzdGFtcEZvcm1hdCA9IERFRkFVTFRfVElNRVNUQU1QX0ZPUk1BVCl7XG4gICAgICAgIHRoaXMubGV2ZWwgPSBkZWZhdWx0TGV2ZWw7XG4gICAgICAgIHRoaXMudXNlVGltZXN0YW1wID0gdXNlVGltZXN0YW1wO1xuICAgICAgICB0aGlzLmxvZ0xldmVsID0gbG9nTGV2ZWw7XG4gICAgICAgIHRoaXMubG9nU3RhY2tUcmFjZSA9IGxvZ1N0YWNrVHJhY2U7XG4gICAgICAgIHRoaXMudGltZXN0YW1wRm9ybWF0ID0gdGltZXN0YW1wRm9ybWF0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWx0cyB0aGUgYWN0dWFsIGxvZ2dpbmcgbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsb2dMZXZlbCBpZiB0aGUgbGV2ZWwgaXMgdG8gYmUgbG9nZ2VkXG4gICAgICogQHBhcmFtIHthbnl9IGlzc3VlciB3aG8gaXMgbG9nZ2luZyB0aGUgbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAgICAgKiBAcHJvdGVjdGVkXG4gICAgICovXG4gICAgcHJvdGVjdGVkIGJ1aWxkTWVzc2FnZShtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsb2dMZXZlbDogbnVtYmVyLCBpc3N1ZXI6IGFueSA9IHVuZGVmaW5lZCwgLi4uYXJnczogYW55W10pe1xuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yKVxuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UubWVzc2FnZTtcblxuICAgICAgICBpZiAodGhpcy5sb2dMZXZlbClcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgWyR7T2JqZWN0LmtleXMoTE9HR0VSX0xFVkVMUylbbG9nTGV2ZWxdfV0gLSAke21lc3NhZ2V9YDtcbiAgICAgICAgaWYgKGlzc3VlcilcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgWyR7aXNzdWVyLnRvU3RyaW5nKCl9XSR7bWVzc2FnZX1gO1xuICAgICAgICBpZiAodGhpcy51c2VUaW1lc3RhbXApXG4gICAgICAgICAgICBtZXNzYWdlID0gYFske2Zvcm1hdERhdGUobmV3IERhdGUoKSwgdGhpcy50aW1lc3RhbXBGb3JtYXQpfV0ke21lc3NhZ2V9YDtcbiAgICAgICAgcmV0dXJuIHN0cmluZ0Zvcm1hdChtZXNzYWdlLCAuLi5hcmdzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbCBkZWZhdWx0cyB0byB7QGxpbmsgTE9HR0VSX0xFVkVMUy5JTkZPfVxuICAgICAqIEBwYXJhbSB7YW55fSBbaXNzdWVyXSB0aGUgb2JqZWN0IHRoYXQgaXMgY2FsbGluZyB0aGUgcmVwb3J0IG1ldGhvZFxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXSB2YWx1ZXMgdG8gcmVwbGFjZSBpbiB0aGUgbWVzc2FnZSBhY2NvcmRpbmcgdG8gdGhlICd7MH0nIG5vdGF0aW9uXG4gICAgICovXG4gICAgcmVwb3J0KG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGxldmVsOiBudW1iZXIgPSBMT0dHRVJfTEVWRUxTLklORk8sIGlzc3VlcjogYW55ID0gdW5kZWZpbmVkLCAuLi5hcmdzOiBhbnlbXSkgOiB2b2lkIHtcbiAgICAgICAgaWYgKGxldmVsIDwgdGhpcy5sZXZlbClcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBsZXQgcmVwb3J0TWV0aG9kOiBGdW5jdGlvbjtcbiAgICAgICAgc3dpdGNoIChsZXZlbCl7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLndhcm47XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuQ1JJVElDQUw6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5lcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTE9HR0VSX0xFVkVMUy5JTkZPOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkRFQlVHOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5sb2c7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZmluYWxNZXNzYWdlID0gdGhpcy5idWlsZE1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIGlzc3VlciwgLi4uYXJncyk7XG4gICAgICAgIHJlcG9ydE1ldGhvZChmaW5hbE1lc3NhZ2UpO1xuXG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IgJiYgbWVzc2FnZS5zdGFjayAmJiB0aGlzLmxvZ1N0YWNrVHJhY2UpXG4gICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoYFxcbi0tIFN0YWNrU3RyYWNlOlxcbnswfWAsIGxldmVsLCBpc3N1ZXIsIG1lc3NhZ2Uuc3RhY2spKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGluZm8obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuSU5GTywgaXNzdWVyLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBhbGwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuQUxMLCBpc3N1ZXIsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGRlYnVnKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGlzc3VlcjogYW55ID0gdW5kZWZpbmVkLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkRFQlVHLCBpc3N1ZXIsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIHdhcm4obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuV0FSTiwgaXNzdWVyLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBpc3N1ZXI6IGFueSA9IHVuZGVmaW5lZCwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5FUlJPUiwgaXNzdWVyLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBjcml0aWNhbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBpc3N1ZXI6IGFueSA9IHVuZGVmaW5lZCwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5DUklUSUNBTCwgaXNzdWVyLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBzZXRMZXZlbChsZXZlbDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGVidWcoc3RyaW5nRm9ybWF0KExPR0dJTkdfTVNHLkxFVkVMX0NIQU5HRUQsIHRoaXMubGV2ZWwudG9TdHJpbmcoKSwgbGV2ZWwudG9TdHJpbmcoKSkpO1xuICAgICAgICB0aGlzLmxldmVsID0gbGV2ZWw7XG4gICAgfVxufVxuXG5sZXQgY3VycmVudExvZ2dlcjogTG9nZ2VyO1xuXG4vKipcbiAqIGdldHMgdGhlIGN1cnJlbnQgTG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIGdldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvZ2dlcigpe1xuICAgIGlmICghY3VycmVudExvZ2dlcilcbiAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICByZXR1cm4gY3VycmVudExvZ2dlcjtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSBsb2dnZXJcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlcn0gbG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIHNldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldExvZ2dlcihsb2dnZXI6IExvZ2dlcil7XG4gICAgY3VycmVudExvZ2dlciA9IGxvZ2dlcjtcbiAgICBnZXRMb2dnZXIoKS5kZWJ1ZyhMT0dHSU5HX01TRy5MT0dHRVJfQ0hBTkdFRCk7XG59XG5cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBpbmZvXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgaW5mbyA9IGZ1bmN0aW9uKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pIHtcbiAgICBnZXRMb2dnZXIoKS5pbmZvKG1lc3NhZ2UsIHRoaXMsIC4uLmFyZ3MpO1xufVxuLyoqXG4gKiBSZXBvcnRzIGEgbWVzc2FnZSB0byB0aGUgbG9nZ2VyIHVuZGVyIHRoZSBsZXZlbCB7QGxpbmsgTE9HR0VSX0xFVkVMUy5BTEx9XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gYWxsXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgYWxsID0gZnVuY3Rpb24odGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkge1xuICAgIGdldExvZ2dlcigpLmFsbChtZXNzYWdlLCB0aGlzLCAuLi5hcmdzKTtcbn1cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuREVCVUd9XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gZGVidWdcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBkZWJ1ZyA9IGZ1bmN0aW9uKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pIHtcbiAgICBnZXRMb2dnZXIoKS5kZWJ1ZyhtZXNzYWdlLCB0aGlzLCAuLi5hcmdzKTtcbn1cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiB3YXJuXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3Qgd2FybiA9IGZ1bmN0aW9uKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pIHtcbiAgICBnZXRMb2dnZXIoKS53YXJuKG1lc3NhZ2UsIHRoaXMsIC4uLmFyZ3MpO1xufVxuLyoqXG4gKiBSZXBvcnRzIGEgbWVzc2FnZSB0byB0aGUgbG9nZ2VyIHVuZGVyIHRoZSBsZXZlbCB7QGxpbmsgTE9HR0VSX0xFVkVMUy5FUlJPUn1cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBlcnJvclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGVycm9yID0gZnVuY3Rpb24odGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkge1xuICAgIGdldExvZ2dlcigpLmVycm9yKG1lc3NhZ2UsIHRoaXMsIC4uLmFyZ3MpO1xufVxuLyoqXG4gKiBSZXBvcnRzIGEgbWVzc2FnZSB0byB0aGUgbG9nZ2VyIHVuZGVyIHRoZSBsZXZlbCB7QGxpbmsgTE9HR0VSX0xFVkVMUy5DUklUSUNBTH1cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBjcml0aWNhbFxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGNyaXRpY2FsID0gZnVuY3Rpb24odGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkge1xuICAgIGdldExvZ2dlcigpLmNyaXRpY2FsKG1lc3NhZ2UsIHRoaXMsIC4uLmFyZ3MpO1xufSJdfQ==
