"use strict";var __spreadArray=function(r,t,e){if(e||2===arguments.length)for(var o,a=0,n=t.length;a<n;a++)!o&&a in t||((o=o||Array.prototype.slice.call(t,0,a))[a]=t[a]);return r.concat(o||Array.prototype.slice.call(t))};!function(r){"object"==typeof module&&"object"==typeof module.exports?r(require,exports):"function"==typeof define&&define.amd&&define(["require","exports","./constants","../errors","./utils"],r)}(function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.critical=t.error=t.warn=t.debug=t.all=t.info=t.setLogger=t.getLogger=t.LoggerImp=void 0;var e,n=r("./constants"),i=r("../errors"),s=r("./utils"),o=(a.prototype.buildMessage=function(r,t,e){void 0===e&&(e=void 0);for(var o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return r instanceof Error&&(r.stack,r=r.message),this.logLevel&&(r="[".concat(Object.keys(n.LOGGER_LEVELS)[t],"] - ").concat(r)),e&&(r="[".concat(e.toString(),"]").concat(r)),this.useTimestamp&&(r="[".concat((0,s.formatDate)(new Date,this.timestampFormat),"]").concat(r)),s.stringFormat.apply(void 0,__spreadArray([r],o,!1))},a.prototype.report=function(r,t){void 0===t&&(t=n.LOGGER_LEVELS.INFO);for(var e,o=[],a=2;a<arguments.length;a++)o[a-2]=arguments[a];if(!(t<this.level||r instanceof i.LoggedError&&r.logged)){switch(t){case n.LOGGER_LEVELS.WARN:e=console.warn;break;case n.LOGGER_LEVELS.ERROR:case n.LOGGER_LEVELS.CRITICAL:e=console.error;break;case n.LOGGER_LEVELS.INFO:case n.LOGGER_LEVELS.DEBUG:case n.LOGGER_LEVELS.ALL:default:e=console.log}e(this.buildMessage.apply(this,__spreadArray([r,t,void 0],o,!1))),r instanceof Error&&r.stack&&this.logStackTrace&&(console.log(r),e(this.buildMessage("\n-- StackStrace:\n".concat(r.stack),t))),r instanceof i.LoggedError&&(r.logged=!0)}},a.prototype.info=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.INFO],t,!1))},a.prototype.all=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.ALL],t,!1))},a.prototype.debug=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.DEBUG],t,!1))},a.prototype.warn=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.WARN],t,!1))},a.prototype.error=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.ERROR],t,!1))},a.prototype.critical=function(r){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];this.report.apply(this,__spreadArray([r,n.LOGGER_LEVELS.CRITICAL],t,!1))},a.prototype.setLevel=function(r){this.debug((0,s.stringFormat)(n.LOGGING_MSG.LEVEL_CHANGED,this.level.toString(),r.toString())),this.level=r},a);function a(r,t,e,o,a){void 0===r&&(r=n.LOGGER_LEVELS.INFO),void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===a&&(a=n.DEFAULT_TIMESTAMP_FORMAT),this.level=r,this.useTimestamp=t,this.logLevel=e,this.logStackTrace=o,this.timestampFormat=a}function p(){return e=e||new o}t.LoggerImp=o,t.getLogger=p,t.setLogger=function(r){e=r,p().debug(n.LOGGING_MSG.LOGGER_CHANGED)};t.info=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(t=p()).info.apply(t,__spreadArray([r],e,!1))},t.all=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(t=p()).all.apply(t,__spreadArray([r],e,!1))},t.debug=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(t=p()).debug.apply(t,__spreadArray([r],e,!1))},t.warn=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(t=p()).warn.apply(t,__spreadArray([r],e,!1))},t.error=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(t=p()).error.apply(t,__spreadArray([r],e,!1))};t.critical=function(r){for(var t,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(t=p()).critical.apply(t,__spreadArray([r],e,!1))}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2dpbmcvbG9nZ2luZy5qcyIsImxvZ2dpbmcvbG9nZ2luZy50cyJdLCJuYW1lcyI6WyJfX3NwcmVhZEFycmF5IiwidG8iLCJmcm9tIiwicGFjayIsImFyZ3VtZW50cyIsImxlbmd0aCIsImFyIiwiaSIsImwiLCJwcm90b3R5cGUiLCJzbGljZSIsImNhbGwiLCJjb25jYXQiLCJBcnJheSIsImZhY3RvcnkiLCJtb2R1bGUiLCJleHBvcnRzIiwicmVxdWlyZSIsImRlZmluZSIsImFtZCIsInYiLCJ1bmRlZmluZWQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiY3JpdGljYWwiLCJlcnJvciIsIndhcm4iLCJkZWJ1ZyIsImFsbCIsImluZm8iLCJzZXRMb2dnZXIiLCJnZXRMb2dnZXIiLCJMb2dnZXJJbXAiLCJjdXJyZW50TG9nZ2VyIiwiY29uc3RhbnRzXzEiLCJlcnJvcnNfMSIsInV0aWxzXzEiLCJidWlsZE1lc3NhZ2UiLCJtZXNzYWdlIiwibG9nTGV2ZWwiLCJpc3N1ZXIiLCJ1c2VUaW1lc3RhbXAiLCJhcmdzIiwiX2kiLCJFcnJvciIsInN0YWNrIiwidGhpcyIsImtleXMiLCJMT0dHRVJfTEVWRUxTIiwidG9TdHJpbmciLCJmb3JtYXREYXRlIiwiRGF0ZSIsInRpbWVzdGFtcEZvcm1hdCIsInN0cmluZ0Zvcm1hdCIsImFwcGx5IiwicmVwb3J0IiwibGV2ZWwiLCJJTkZPIiwicmVwb3J0TWV0aG9kIiwiTG9nZ2VkRXJyb3IiLCJsb2dnZWQiLCJXQVJOIiwiY29uc29sZSIsIkVSUk9SIiwiQ1JJVElDQUwiLCJERUJVRyIsIkFMTCIsImxvZyIsImxvZ1N0YWNrVHJhY2UiLCJzZXRMZXZlbCIsIkxPR0dJTkdfTVNHIiwiTEVWRUxfQ0hBTkdFRCIsImRlZmF1bHRMZXZlbCIsIkRFRkFVTFRfVElNRVNUQU1QX0ZPUk1BVCIsImxvZ2dlciIsIkxPR0dFUl9DSEFOR0VEIiwiX2EiXSwibWFwcGluZ3MiOiJhQUFBLElBQUlBLGNBQWdELFNBQVVD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QSxFQUFBQSxFQUFBeEMsVUFBQUMsT0FBQXVDLElBQUFELEVBQUFDLEVBQUEsR0FBQXhDLFVBQUF3QyxHQUFtQixPQUFBaUMsRUFBQTdDLEtBQVlOLE1BQUs2QixNQUFBc0IsRUFBQTdFLGNBQUEsQ0FBQ3VDLEdBQVlJLEdBQUksS0FVdEYzQixFQUFBUyxTQUFXLFNBQUNjLEdEN0dqQixJQ3pHS3ZCLElBQUFpQixFQXNOb0NVLEVBQUEsR0FBQUMsRUFBQSxFQUFBQSxFQUFBeEMsVUFBQUMsT0FBQXVDLElBQUFELEVBQUFDLEVBQUEsR0FBQXhDLFVBQUF3QyxHQUFtQixPQUFBaUMsRUFBQTdDLEtBQVlQLFNBQVE4QixNQUFBc0IsRUFBQTdFLGNBQUEsQ0FBQ3VDLEdBQVlJLEdBQUkiLCJmaWxlIjoibG9nZ2luZy9sb2dnaW5nLm1pbi5lc20uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG4oZnVuY3Rpb24gKGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIG1vZHVsZSA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgdmFyIHYgPSBmYWN0b3J5KHJlcXVpcmUsIGV4cG9ydHMpO1xuICAgICAgICBpZiAodiAhPT0gdW5kZWZpbmVkKSBtb2R1bGUuZXhwb3J0cyA9IHY7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIGRlZmluZShbXCJyZXF1aXJlXCIsIFwiZXhwb3J0c1wiLCBcIi4vY29uc3RhbnRzXCIsIFwiLi4vZXJyb3JzXCIsIFwiLi91dGlsc1wiXSwgZmFjdG9yeSk7XG4gICAgfVxufSkoZnVuY3Rpb24gKHJlcXVpcmUsIGV4cG9ydHMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4gICAgZXhwb3J0cy5jcml0aWNhbCA9IGV4cG9ydHMuZXJyb3IgPSBleHBvcnRzLndhcm4gPSBleHBvcnRzLmRlYnVnID0gZXhwb3J0cy5hbGwgPSBleHBvcnRzLmluZm8gPSBleHBvcnRzLnNldExvZ2dlciA9IGV4cG9ydHMuZ2V0TG9nZ2VyID0gZXhwb3J0cy5Mb2dnZXJJbXAgPSB2b2lkIDA7XG4gICAgdmFyIGNvbnN0YW50c18xID0gcmVxdWlyZShcIi4vY29uc3RhbnRzXCIpO1xuICAgIHZhciBlcnJvcnNfMSA9IHJlcXVpcmUoXCIuLi9lcnJvcnNcIik7XG4gICAgdmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcbiAgICB2YXIgTG9nZ2VySW1wID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTG9nZ2VySW1wKGRlZmF1bHRMZXZlbCwgdXNlVGltZXN0YW1wLCBsb2dMZXZlbCwgbG9nU3RhY2tUcmFjZSwgdGltZXN0YW1wRm9ybWF0KSB7XG4gICAgICAgICAgICBpZiAoZGVmYXVsdExldmVsID09PSB2b2lkIDApIHsgZGVmYXVsdExldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOyB9XG4gICAgICAgICAgICBpZiAodXNlVGltZXN0YW1wID09PSB2b2lkIDApIHsgdXNlVGltZXN0YW1wID0gdHJ1ZTsgfVxuICAgICAgICAgICAgaWYgKGxvZ0xldmVsID09PSB2b2lkIDApIHsgbG9nTGV2ZWwgPSB0cnVlOyB9XG4gICAgICAgICAgICBpZiAobG9nU3RhY2tUcmFjZSA9PT0gdm9pZCAwKSB7IGxvZ1N0YWNrVHJhY2UgPSBmYWxzZTsgfVxuICAgICAgICAgICAgaWYgKHRpbWVzdGFtcEZvcm1hdCA9PT0gdm9pZCAwKSB7IHRpbWVzdGFtcEZvcm1hdCA9IGNvbnN0YW50c18xLkRFRkFVTFRfVElNRVNUQU1QX0ZPUk1BVDsgfVxuICAgICAgICAgICAgdGhpcy5sZXZlbCA9IGRlZmF1bHRMZXZlbDtcbiAgICAgICAgICAgIHRoaXMudXNlVGltZXN0YW1wID0gdXNlVGltZXN0YW1wO1xuICAgICAgICAgICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgICAgICAgICAgdGhpcy5sb2dTdGFja1RyYWNlID0gbG9nU3RhY2tUcmFjZTtcbiAgICAgICAgICAgIHRoaXMudGltZXN0YW1wRm9ybWF0ID0gdGltZXN0YW1wRm9ybWF0O1xuICAgICAgICB9XG4gICAgICAgIExvZ2dlckltcC5wcm90b3R5cGUuYnVpbGRNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGxvZ0xldmVsLCBpc3N1ZXIpIHtcbiAgICAgICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3RhY2tzVHJhY2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgc3RhY2tzVHJhY2UgPSBtZXNzYWdlLnN0YWNrO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlLm1lc3NhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5sb2dMZXZlbClcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KE9iamVjdC5rZXlzKGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMpW2xvZ0xldmVsXSwgXCJdIC0gXCIpLmNvbmNhdChtZXNzYWdlKTtcbiAgICAgICAgICAgIGlmIChpc3N1ZXIpXG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IFwiW1wiLmNvbmNhdChpc3N1ZXIudG9TdHJpbmcoKSwgXCJdXCIpLmNvbmNhdChtZXNzYWdlKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnVzZVRpbWVzdGFtcClcbiAgICAgICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KCgwLCB1dGlsc18xLmZvcm1hdERhdGUpKG5ldyBEYXRlKCksIHRoaXMudGltZXN0YW1wRm9ybWF0KSwgXCJdXCIpLmNvbmNhdChtZXNzYWdlKTtcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLnN0cmluZ0Zvcm1hdC5hcHBseSh2b2lkIDAsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLnJlcG9ydCA9IGZ1bmN0aW9uIChtZXNzYWdlLCBsZXZlbCkge1xuICAgICAgICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLklORk87IH1cbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobGV2ZWwgPCB0aGlzLmxldmVsKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgZXJyb3JzXzEuTG9nZ2VkRXJyb3IgJiYgbWVzc2FnZS5sb2dnZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIHJlcG9ydE1ldGhvZDtcbiAgICAgICAgICAgIHN3aXRjaCAobGV2ZWwpIHtcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS53YXJuO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkNSSVRJQ0FMOlxuICAgICAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLmVycm9yO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GTzpcbiAgICAgICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuREVCVUc6XG4gICAgICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLmxvZztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZmluYWxNZXNzYWdlID0gdGhpcy5idWlsZE1lc3NhZ2UuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgbGV2ZWwsIHVuZGVmaW5lZF0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgICAgICByZXBvcnRNZXRob2QoZmluYWxNZXNzYWdlKTtcbiAgICAgICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IgJiYgbWVzc2FnZS5zdGFjayAmJiB0aGlzLmxvZ1N0YWNrVHJhY2UpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoXCJcXG4tLSBTdGFja1N0cmFjZTpcXG5cIi5jb25jYXQobWVzc2FnZS5zdGFjayksIGxldmVsKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIGVycm9yc18xLkxvZ2dlZEVycm9yKVxuICAgICAgICAgICAgICAgIG1lc3NhZ2UubG9nZ2VkID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5pbmZvID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLklORk9dLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5BTExdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLmRlYnVnID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS53YXJuID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLldBUk5dLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBMb2dnZXJJbXAucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkVSUk9SXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgTG9nZ2VySW1wLnByb3RvdHlwZS5jcml0aWNhbCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5DUklUSUNBTF0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgIH07XG4gICAgICAgIExvZ2dlckltcC5wcm90b3R5cGUuc2V0TGV2ZWwgPSBmdW5jdGlvbiAobGV2ZWwpIHtcbiAgICAgICAgICAgIHRoaXMuZGVidWcoKDAsIHV0aWxzXzEuc3RyaW5nRm9ybWF0KShjb25zdGFudHNfMS5MT0dHSU5HX01TRy5MRVZFTF9DSEFOR0VELCB0aGlzLmxldmVsLnRvU3RyaW5nKCksIGxldmVsLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgICAgIHRoaXMubGV2ZWwgPSBsZXZlbDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIExvZ2dlckltcDtcbiAgICB9KCkpO1xuICAgIGV4cG9ydHMuTG9nZ2VySW1wID0gTG9nZ2VySW1wO1xuICAgIHZhciBjdXJyZW50TG9nZ2VyO1xuICAgIGZ1bmN0aW9uIGdldExvZ2dlcigpIHtcbiAgICAgICAgaWYgKCFjdXJyZW50TG9nZ2VyKVxuICAgICAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRMb2dnZXI7XG4gICAgfVxuICAgIGV4cG9ydHMuZ2V0TG9nZ2VyID0gZ2V0TG9nZ2VyO1xuICAgIGZ1bmN0aW9uIHNldExvZ2dlcihsb2dnZXIpIHtcbiAgICAgICAgY3VycmVudExvZ2dlciA9IGxvZ2dlcjtcbiAgICAgICAgZ2V0TG9nZ2VyKCkuZGVidWcoY29uc3RhbnRzXzEuTE9HR0lOR19NU0cuTE9HR0VSX0NIQU5HRUQpO1xuICAgIH1cbiAgICBleHBvcnRzLnNldExvZ2dlciA9IHNldExvZ2dlcjtcbiAgICB2YXIgaW5mbyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS5pbmZvLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIGV4cG9ydHMuaW5mbyA9IGluZm87XG4gICAgdmFyIGFsbCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS5hbGwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xuICAgIH07XG4gICAgZXhwb3J0cy5hbGwgPSBhbGw7XG4gICAgdmFyIGRlYnVnID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKF9hID0gZ2V0TG9nZ2VyKCkpLmRlYnVnLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIGV4cG9ydHMuZGVidWcgPSBkZWJ1ZztcbiAgICB2YXIgd2FybiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS53YXJuLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIGV4cG9ydHMud2FybiA9IHdhcm47XG4gICAgdmFyIGVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKF9hID0gZ2V0TG9nZ2VyKCkpLmVycm9yLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIGV4cG9ydHMuZXJyb3IgPSBlcnJvcjtcbiAgICB2YXIgY3JpdGljYWwgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoX2EgPSBnZXRMb2dnZXIoKSkuY3JpdGljYWwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xuICAgIH07XG4gICAgZXhwb3J0cy5jcml0aWNhbCA9IGNyaXRpY2FsO1xufSk7IiwiaW1wb3J0IHtERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQsIExPR0dFUl9MRVZFTFMsIExPR0dJTkdfTVNHfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7TG9nZ2VkRXJyb3J9IGZyb20gXCIuLi9lcnJvcnNcIjtcbmltcG9ydCB7Zm9ybWF0RGF0ZSwgc3RyaW5nRm9ybWF0fSBmcm9tIFwiLi91dGlsc1wiO1xuXG4vKipcbiAqIEB0eXBlZGVmIExvZ2dlck1lc3NhZ2VcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IHR5cGUgTG9nZ2VyTWVzc2FnZSA9IEVycm9yIHwgc3RyaW5nO1xuXG4vKipcbiAqIEBpbnRlcmZhY2UgTG9nZ2VyXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyIHtcbiAgICAvKipcbiAgICAgKiBSZXBvcnRzIGEgbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbFxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHJlcG9ydChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQUxMfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIGFsbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBpbmZvKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5ERUJVR31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBkZWJ1ZyhtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICB3YXJuKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5FUlJPUn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQ1JJVElDQUx9XG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHthbnlbXX0gW2FyZ3NdXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTG9nZ2VyXG4gICAgICovXG4gICAgY3JpdGljYWwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIERlZmluZXMgdGhlIExvZ2dlciBsZXZlbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsXG4gICAgICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHNldExldmVsKGxldmVsOiBudW1iZXIsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IExvZ2dlciBJbXBsZW1lbnRhdGlvblxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZWZhdWx0TGV2ZWwgZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlVGltZXN0YW1wIGRlZmF1bHRzIHRvIHRydWVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nTGV2ZWxcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nU3RhY2tUcmFjZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpbWVzdGFtcEZvcm1hdFxuICpcbiAqIEBjbGFzcyBMb2dnZXJJbXBcbiAqIEBpbXBsZW1lbnRzIExvZ2dlclxuICovXG5leHBvcnQgY2xhc3MgTG9nZ2VySW1wIGltcGxlbWVudHMgTG9nZ2VyIHtcbiAgICBwcml2YXRlIGxldmVsOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IHVzZVRpbWVzdGFtcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxvZ0xldmVsOiBib29sZWFuO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdGltZXN0YW1wRm9ybWF0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSByZWFkb25seSBsb2dTdGFja1RyYWNlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoZGVmYXVsdExldmVsOiBudW1iZXIgPSBMT0dHRVJfTEVWRUxTLklORk8sIHVzZVRpbWVzdGFtcCA9IHRydWUsIGxvZ0xldmVsOiBib29sZWFuID0gdHJ1ZSwgbG9nU3RhY2tUcmFjZTogYm9vbGVhbiA9IGZhbHNlLCB0aW1lc3RhbXBGb3JtYXQgPSBERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQpe1xuICAgICAgICB0aGlzLmxldmVsID0gZGVmYXVsdExldmVsO1xuICAgICAgICB0aGlzLnVzZVRpbWVzdGFtcCA9IHVzZVRpbWVzdGFtcDtcbiAgICAgICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgICAgICB0aGlzLmxvZ1N0YWNrVHJhY2UgPSBsb2dTdGFja1RyYWNlO1xuICAgICAgICB0aGlzLnRpbWVzdGFtcEZvcm1hdCA9IHRpbWVzdGFtcEZvcm1hdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsdHMgdGhlIGFjdHVhbCBsb2dnaW5nIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbG9nTGV2ZWwgaWYgdGhlIGxldmVsIGlzIHRvIGJlIGxvZ2dlZFxuICAgICAqIEBwYXJhbSB7YW55fSBpc3N1ZXIgd2hvIGlzIGxvZ2dpbmcgdGhlIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBidWlsZE1lc3NhZ2UobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgbG9nTGV2ZWw6IG51bWJlciwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKXtcbiAgICAgICAgbGV0IHN0YWNrc1RyYWNlOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3Ipe1xuICAgICAgICAgICAgc3RhY2tzVHJhY2UgPSBtZXNzYWdlLnN0YWNrO1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UubWVzc2FnZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmxvZ0xldmVsKVxuICAgICAgICAgICAgbWVzc2FnZSA9IGBbJHtPYmplY3Qua2V5cyhMT0dHRVJfTEVWRUxTKVtsb2dMZXZlbF19XSAtICR7bWVzc2FnZX1gO1xuICAgICAgICBpZiAoaXNzdWVyKVxuICAgICAgICAgICAgbWVzc2FnZSA9IGBbJHtpc3N1ZXIudG9TdHJpbmcoKX1dJHttZXNzYWdlfWA7XG4gICAgICAgIGlmICh0aGlzLnVzZVRpbWVzdGFtcClcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgWyR7Zm9ybWF0RGF0ZShuZXcgRGF0ZSgpLCB0aGlzLnRpbWVzdGFtcEZvcm1hdCl9XSR7bWVzc2FnZX1gO1xuICAgICAgICByZXR1cm4gc3RyaW5nRm9ybWF0KG1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsIGRlZmF1bHRzIHRvIHtAbGluayBMT0dHRVJfTEVWRUxTLklORk99XG4gICAgICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICAgICAqL1xuICAgIHJlcG9ydChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyID0gTE9HR0VSX0xFVkVMUy5JTkZPLCAuLi5hcmdzOiBhbnlbXSkgOiB2b2lkIHtcbiAgICAgICAgaWYgKGxldmVsIDwgdGhpcy5sZXZlbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBMb2dnZWRFcnJvciAmJiBtZXNzYWdlLmxvZ2dlZClcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBsZXQgcmVwb3J0TWV0aG9kOiBGdW5jdGlvbjtcbiAgICAgICAgc3dpdGNoIChsZXZlbCl7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLndhcm47XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuQ1JJVElDQUw6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5lcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTE9HR0VSX0xFVkVMUy5JTkZPOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkRFQlVHOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5sb2c7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZmluYWxNZXNzYWdlID0gdGhpcy5idWlsZE1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIHVuZGVmaW5lZCwgLi4uYXJncyk7XG4gICAgICAgIHJlcG9ydE1ldGhvZChmaW5hbE1lc3NhZ2UpO1xuXG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IgJiYgbWVzc2FnZS5zdGFjayAmJiB0aGlzLmxvZ1N0YWNrVHJhY2Upe1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoYFxcbi0tIFN0YWNrU3RyYWNlOlxcbiR7bWVzc2FnZS5zdGFja31gLCBsZXZlbCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBMb2dnZWRFcnJvcilcbiAgICAgICAgICAgIG1lc3NhZ2UubG9nZ2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGluZm8obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5JTkZPLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBhbGwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5BTEwsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGRlYnVnKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuREVCVUcsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIHdhcm4obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5XQVJOLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkVSUk9SLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBjcml0aWNhbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBzZXRMZXZlbChsZXZlbDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGVidWcoc3RyaW5nRm9ybWF0KExPR0dJTkdfTVNHLkxFVkVMX0NIQU5HRUQsIHRoaXMubGV2ZWwudG9TdHJpbmcoKSwgbGV2ZWwudG9TdHJpbmcoKSkpO1xuICAgICAgICB0aGlzLmxldmVsID0gbGV2ZWw7XG4gICAgfVxufVxuXG5sZXQgY3VycmVudExvZ2dlcjogTG9nZ2VyO1xuXG4vKipcbiAqIGdldHMgdGhlIGN1cnJlbnQgTG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIGdldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvZ2dlcigpe1xuICAgIGlmICghY3VycmVudExvZ2dlcilcbiAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICByZXR1cm4gY3VycmVudExvZ2dlcjtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSBsb2dnZXJcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlcn0gbG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIHNldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldExvZ2dlcihsb2dnZXI6IExvZ2dlcil7XG4gICAgY3VycmVudExvZ2dlciA9IGxvZ2dlcjtcbiAgICBnZXRMb2dnZXIoKS5kZWJ1ZyhMT0dHSU5HX01TRy5MT0dHRVJfQ0hBTkdFRCk7XG59XG5cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBpbmZvXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgaW5mbyA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkuaW5mbyhtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuQUxMfVxuICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGFsbFxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGFsbCA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkuYWxsKG1lc3NhZ2UsIC4uLmFyZ3MpO1xuLyoqXG4gKiBSZXBvcnRzIGEgbWVzc2FnZSB0byB0aGUgbG9nZ2VyIHVuZGVyIHRoZSBsZXZlbCB7QGxpbmsgTE9HR0VSX0xFVkVMUy5ERUJVR31cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBkZWJ1Z1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGRlYnVnID0gKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKSA9PiBnZXRMb2dnZXIoKS5kZWJ1ZyhtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiB3YXJuXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3Qgd2FybiA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkud2FybihtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuRVJST1J9XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gZXJyb3JcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBlcnJvciA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkuZXJyb3IobWVzc2FnZSwgLi4uYXJncyk7XG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMfVxuICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGNyaXRpY2FsXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgY3JpdGljYWwgPSAobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pID0+IGdldExvZ2dlcigpLmNyaXRpY2FsKG1lc3NhZ2UsIC4uLmFyZ3MpOyJdfQ==
