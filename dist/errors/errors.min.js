"use strict";var __extends=this&&this.__extends||function(){var o=function(r,l){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,l){r.__proto__=l}||function(r,l){for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(r[a]=l[a])})(r,l)};return function(r,l){if("function"!=typeof l&&null!==l)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");function a(){this.constructor=r}o(r,l),r.prototype=null===l?Object.create(l):(a.prototype=l.prototype,new a)}}(),__spreadArray=this&&this.__spreadArray||function(r,l,a){if(a||2===arguments.length)for(var o,e=0,t=l.length;e<t;e++)!o&&e in l||((o=o||Array.prototype.slice.call(l,0,e))[e]=l[e]);return r.concat(o||Array.prototype.slice.call(l))},logging_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CriticalError=exports.LoggedError=exports.criticalCallback=exports.errorCallback=exports.warningCallback=exports.infoCallback=exports.debugCallback=exports.allCallback=exports.loggedCallback=void 0,require("../logging"));function loggedCallback(r,l,a){for(var o=[],e=3;e<arguments.length;e++)o[e-3]=arguments[e];a(new(LoggedError.bind.apply(LoggedError,__spreadArray([void 0,r,this&&"loggedCallback"!==this.name?this:void 0,l],o,!1))))}function allCallback(r,l){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];loggedCallback.call.apply(loggedCallback,__spreadArray([this,r,logging_1.LOGGER_LEVELS.ALL,l],a,!1))}function debugCallback(r,l){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];loggedCallback.call.apply(loggedCallback,__spreadArray([this,r,logging_1.LOGGER_LEVELS.DEBUG,l],a,!1))}function infoCallback(r,l){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];loggedCallback.call.apply(loggedCallback,__spreadArray([this,r,logging_1.LOGGER_LEVELS.INFO,l],a,!1))}function warningCallback(r,l){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];loggedCallback.call.apply(loggedCallback,__spreadArray([this,r,logging_1.LOGGER_LEVELS.WARN,l],a,!1))}function errorCallback(r,l){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];loggedCallback.call.apply(loggedCallback,__spreadArray([this,r,logging_1.LOGGER_LEVELS.ERROR,l],a,!1))}function criticalCallback(r,l){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];loggedCallback.call.apply(loggedCallback,__spreadArray([this,r,logging_1.LOGGER_LEVELS.CRITICAL,l],a,!1))}exports.loggedCallback=loggedCallback,exports.allCallback=allCallback,exports.debugCallback=debugCallback,exports.infoCallback=infoCallback,exports.warningCallback=warningCallback,exports.errorCallback=errorCallback,exports.criticalCallback=criticalCallback;var LoggedError=function(g){function r(r,l,a){void 0===l&&(l=void 0),void 0===a&&(a=logging_1.LOGGER_LEVELS.ALL);for(var o=[],e=3;e<arguments.length;e++)o[e-3]=arguments[e];var t=g.call(this,r instanceof Error?r.message:r)||this;return t.name="LoggedError",t.loggedAt=r instanceof Error&&"LoggedError"===r.name?r.loggedAt:void 0,t.issuer=l,(void 0===r.loggedAt||r.loggedAt<a)&&((r=(0,logging_1.getLogger)()).report.apply(r,__spreadArray([t,a,l],o,!1)),t.loggedAt=a),t}return __extends(r,g),r}(Error),CriticalError=function(e){function r(r,l){void 0===l&&(l=void 0);for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];return e.apply(this,__spreadArray([r,l,logging_1.LOGGER_LEVELS.CRITICAL],a,!1))||this}return __extends(r,e),r}(exports.LoggedError=LoggedError);exports.CriticalError=CriticalError;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVycm9ycy9lcnJvcnMuanMiLCJlcnJvcnMvZXJyb3JzLnRzIl0sIm5hbWVzIjpbIl9fZXh0ZW5kcyIsInRoaXMiLCJleHRlbmRTdGF0aWNzIiwiT2JqZWN0Iiwic2V0UHJvdG90eXBlT2YiLCJBcnJheSIsImQiLCJiIiwiX19wcm90b19fIiwicCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlR5cGVFcnJvciIsIlN0cmluZyIsImNvbnN0cnVjdG9yIiwiY3JlYXRlIiwiX18iLCJfX3NwcmVhZEFycmF5IiwiZnJvbSIsInBhY2siLCJsZW5ndGgiLCJhciIsImkiLCJsIiwic2xpY2UiLCJsb2dnaW5nXzEiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsIkNyaXRpY2FsRXJyb3IiLCJMb2dnZWRFcnJvciIsImNyaXRpY2FsQ2FsbGJhY2siLCJlcnJvckNhbGxiYWNrIiwid2FybmluZ0NhbGxiYWNrIiwiaW5mb0NhbGxiYWNrIiwiZGVidWdDYWxsYmFjayIsImFsbENhbGxiYWNrIiwibG9nZ2VkQ2FsbGJhY2siLCJyZXF1aXJlIiwibWVzc2FnZSIsImxldmVsIiwiY2FsbGJhY2siLCJhcmdzIiwiX2kiLCJhcmd1bWVudHMiLCJiaW5kIiwiYXBwbHkiLCJuYW1lIiwidW5kZWZpbmVkIiwiTE9HR0VSX0xFVkVMUyIsIkFMTCIsIkRFQlVHIiwiSU5GTyIsIldBUk4iLCJFUlJPUiIsIkNSSVRJQ0FMIiwiX3N1cGVyIiwiZXJyb3IiLCJpc3N1ZXIiLCJfdGhpcyIsIkVycm9yIiwibG9nZ2VkQXQiLCJfYSIsImdldExvZ2dlciIsInJlcG9ydCJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBSUEsVUFBYUMsTUFBUUEsS0FBS0QsV0FBZSxXQUF6Q0EsSUFBQUEsRUFBcUIsU0FBS0EsRUFBQUEsR0FHakIsT0FGTEUsRUFBZ0JDLE9BQUFDLGdCQUNoQkYsQ0FBQUEsVUFBc0IsY0FBTkcsT0FDWCxTQUFBQyxFQUFBQyxHQUFBRCxFQUFBRSxV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QkcsTUFBUUgsRUFBTWxCLFFBQVVrQixJQUFNekQsS0FyRDdEaUMsT0FzRFEwQixFQUFLWixLQUFPLGNBRVpZLEVBQUtFLFNBQVdKLGFBQWlCRyxPQUF3QixnQkFBZkgsRUFBTVYsS0FBeUJVLEVBQU1JLGNBQVdiLEVBQzFGVyxFQUFLRCxPQUFTQSxRQUdTVixJQUFuQlMsRUFBTUksVUFBMEJKLEVBQU1JLFNBQVdyQixNQUNqRHNCLEdBQUEsRUFBQXJDLFVBQUFzQyxjQUFZQyxPQUFNbEIsTUFBQWdCLEVBQUE3QyxjQUFBLENBQUMwQyxFQUFNbkIsRUFBT2tCLEdBQVdoQixHQUFJLElBQy9DaUIsRUFBS0UsU0FBV3JCLEdBOUQ1QlAsRUFpRUEsT0FwQmlDbEMsVUFBQStCLEVBQUEwQixHQW9CakMxQixFQXBCQSxDQUFpQzhCLE9BNkJqQy9CLGNBQUEsU0FBQTJCLEdBQ0ksU0FBQTNCLEVBQVk0QixFQUFzQkMsUUFBQSxJQUFBQSxJQUFBQSxPQUFBVixHQTNEckMsSUEyRDhELElBQUFOLEVBQUEsR0FBQUMsRUFBQSxFQUFBQSxFQUFBQyxVQUFBeEIsT0FBQXVCLElBQUFELEVBQUFDLEVBQUEsR0FBQUMsVUFBQUQsR0Q3QnZELE9BQU9hLEVBQU9WLE1BQU05QyxLQUFNaUIsY0FBYyxDQzhCbEN3QyxFQUFPQyxFQUFRakMsVUFBQXdCLGNBQWNNLFVBQWFiLEdBQUksS0FBQTFDLEtBRTVELE9BSm1DRCxVQUFBOEIsRUFBQTJCLEdBSW5DM0IsRUFKQSxDQTdCYUYsUUFBQUcsWUFBQUEsYUE2QkFILFFBQUFFLGNBQUFBIiwiZmlsZSI6ImVycm9ycy9lcnJvcnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5Dcml0aWNhbEVycm9yID0gZXhwb3J0cy5Mb2dnZWRFcnJvciA9IGV4cG9ydHMuY3JpdGljYWxDYWxsYmFjayA9IGV4cG9ydHMuZXJyb3JDYWxsYmFjayA9IGV4cG9ydHMud2FybmluZ0NhbGxiYWNrID0gZXhwb3J0cy5pbmZvQ2FsbGJhY2sgPSBleHBvcnRzLmRlYnVnQ2FsbGJhY2sgPSBleHBvcnRzLmFsbENhbGxiYWNrID0gZXhwb3J0cy5sb2dnZWRDYWxsYmFjayA9IHZvaWQgMDtcbnZhciBsb2dnaW5nXzEgPSByZXF1aXJlKFwiLi4vbG9nZ2luZ1wiKTtcbmZ1bmN0aW9uIGxvZ2dlZENhbGxiYWNrKG1lc3NhZ2UsIGxldmVsLCBjYWxsYmFjaykge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDNdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIGVycm9yID0gbmV3IChMb2dnZWRFcnJvci5iaW5kLmFwcGx5KExvZ2dlZEVycm9yLCBfX3NwcmVhZEFycmF5KFt2b2lkIDAsIG1lc3NhZ2UsIHRoaXMgJiYgdGhpcy5uYW1lICE9PSBcImxvZ2dlZENhbGxiYWNrXCIgPyB0aGlzIDogdW5kZWZpbmVkLCBsZXZlbF0sIGFyZ3MsIGZhbHNlKSkpKCk7XG4gICAgY2FsbGJhY2soZXJyb3IpO1xufVxuZXhwb3J0cy5sb2dnZWRDYWxsYmFjayA9IGxvZ2dlZENhbGxiYWNrO1xuZnVuY3Rpb24gYWxsQ2FsbGJhY2sobWVzc2FnZSwgY2FsbGJhY2spIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwuYXBwbHkobG9nZ2VkQ2FsbGJhY2ssIF9fc3ByZWFkQXJyYXkoW3RoaXMsIG1lc3NhZ2UsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLkFMTCwgY2FsbGJhY2tdLCBhcmdzLCBmYWxzZSkpO1xufVxuZXhwb3J0cy5hbGxDYWxsYmFjayA9IGFsbENhbGxiYWNrO1xuZnVuY3Rpb24gZGVidWdDYWxsYmFjayhtZXNzYWdlLCBjYWxsYmFjaykge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbC5hcHBseShsb2dnZWRDYWxsYmFjaywgX19zcHJlYWRBcnJheShbdGhpcywgbWVzc2FnZSwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuREVCVUcsIGNhbGxiYWNrXSwgYXJncywgZmFsc2UpKTtcbn1cbmV4cG9ydHMuZGVidWdDYWxsYmFjayA9IGRlYnVnQ2FsbGJhY2s7XG5mdW5jdGlvbiBpbmZvQ2FsbGJhY2sobWVzc2FnZSwgY2FsbGJhY2spIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwuYXBwbHkobG9nZ2VkQ2FsbGJhY2ssIF9fc3ByZWFkQXJyYXkoW3RoaXMsIG1lc3NhZ2UsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLklORk8sIGNhbGxiYWNrXSwgYXJncywgZmFsc2UpKTtcbn1cbmV4cG9ydHMuaW5mb0NhbGxiYWNrID0gaW5mb0NhbGxiYWNrO1xuZnVuY3Rpb24gd2FybmluZ0NhbGxiYWNrKG1lc3NhZ2UsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsLmFwcGx5KGxvZ2dlZENhbGxiYWNrLCBfX3NwcmVhZEFycmF5KFt0aGlzLCBtZXNzYWdlLCBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5XQVJOLCBjYWxsYmFja10sIGFyZ3MsIGZhbHNlKSk7XG59XG5leHBvcnRzLndhcm5pbmdDYWxsYmFjayA9IHdhcm5pbmdDYWxsYmFjaztcbmZ1bmN0aW9uIGVycm9yQ2FsbGJhY2sobWVzc2FnZSwgY2FsbGJhY2spIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwuYXBwbHkobG9nZ2VkQ2FsbGJhY2ssIF9fc3ByZWFkQXJyYXkoW3RoaXMsIG1lc3NhZ2UsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLkVSUk9SLCBjYWxsYmFja10sIGFyZ3MsIGZhbHNlKSk7XG59XG5leHBvcnRzLmVycm9yQ2FsbGJhY2sgPSBlcnJvckNhbGxiYWNrO1xuZnVuY3Rpb24gY3JpdGljYWxDYWxsYmFjayhtZXNzYWdlLCBjYWxsYmFjaykge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbC5hcHBseShsb2dnZWRDYWxsYmFjaywgX19zcHJlYWRBcnJheShbdGhpcywgbWVzc2FnZSwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuQ1JJVElDQUwsIGNhbGxiYWNrXSwgYXJncywgZmFsc2UpKTtcbn1cbmV4cG9ydHMuY3JpdGljYWxDYWxsYmFjayA9IGNyaXRpY2FsQ2FsbGJhY2s7XG52YXIgTG9nZ2VkRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMb2dnZWRFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMb2dnZWRFcnJvcihlcnJvciwgaXNzdWVyLCBsZXZlbCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5BTEw7IH1cbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBlcnJvcikgfHwgdGhpcztcbiAgICAgICAgX3RoaXMubmFtZSA9IFwiTG9nZ2VkRXJyb3JcIjtcbiAgICAgICAgX3RoaXMubG9nZ2VkQXQgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm5hbWUgPT09ICdMb2dnZWRFcnJvcicgPyBlcnJvci5sb2dnZWRBdCA6IHVuZGVmaW5lZDtcbiAgICAgICAgX3RoaXMuaXNzdWVyID0gaXNzdWVyO1xuICAgICAgICBpZiAoZXJyb3IubG9nZ2VkQXQgPT09IHVuZGVmaW5lZCB8fCBlcnJvci5sb2dnZWRBdCA8IGxldmVsKSB7XG4gICAgICAgICAgICAoX2EgPSAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKSkucmVwb3J0LmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFtfdGhpcywgbGV2ZWwsIGlzc3Vlcl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgICAgICAgICBfdGhpcy5sb2dnZWRBdCA9IGxldmVsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIExvZ2dlZEVycm9yO1xufShFcnJvcikpO1xuZXhwb3J0cy5Mb2dnZWRFcnJvciA9IExvZ2dlZEVycm9yO1xudmFyIENyaXRpY2FsRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDcml0aWNhbEVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENyaXRpY2FsRXJyb3IoZXJyb3IsIGlzc3Vlcikge1xuICAgICAgICBpZiAoaXNzdWVyID09PSB2b2lkIDApIHsgaXNzdWVyID0gdW5kZWZpbmVkOyB9XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbZXJyb3IsIGlzc3VlciwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuQ1JJVElDQUxdLCBhcmdzLCBmYWxzZSkpIHx8IHRoaXM7XG4gICAgfVxuICAgIHJldHVybiBDcml0aWNhbEVycm9yO1xufShMb2dnZWRFcnJvcikpO1xuZXhwb3J0cy5Dcml0aWNhbEVycm9yID0gQ3JpdGljYWxFcnJvcjsiLCJpbXBvcnQge0NhbGxiYWNrLCBnZXRMb2dnZXIsIExPR0dFUl9MRVZFTFMsIExvZ2dlck1lc3NhZ2V9IGZyb20gXCIuLi9sb2dnaW5nXCI7XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcGFyYW0ge251bWJlcn0gbGV2ZWxcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAqXG4gKiBAZnVuY3Rpb24gbG9nZ2VkQ2FsbGJhY2tcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ2dlZENhbGxiYWNrKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgbGV2ZWw6IG51bWJlciwgY2FsbGJhY2s6IENhbGxiYWNrLCAuLi5hcmdzOiBhbnlbXSl7XG4gICAgY29uc3QgZXJyb3I6IExvZ2dlZEVycm9yID0gbmV3IExvZ2dlZEVycm9yKG1lc3NhZ2UsIHRoaXMgJiYgdGhpcy5uYW1lICE9PSBcImxvZ2dlZENhbGxiYWNrXCIgPyB0aGlzIDogdW5kZWZpbmVkLCBsZXZlbCwgLi4uYXJncyk7XG4gICAgY2FsbGJhY2soZXJyb3IpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAqXG4gKiBAZnVuY3Rpb24gYWxsQ2FsbGJhY2tcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFsbENhbGxiYWNrKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgY2FsbGJhY2s6IENhbGxiYWNrLCAuLi5hcmdzOiBhbnlbXSl7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkFMTCwgY2FsbGJhY2ssIC4uLmFyZ3MpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAqXG4gKiBAZnVuY3Rpb24gZGVidWdDYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGVidWdDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGNhbGxiYWNrOiBDYWxsYmFjaywgLi4uYXJnczogYW55W10pe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5ERUJVRywgY2FsbGJhY2ssIC4uLmFyZ3MpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAqXG4gKiBAZnVuY3Rpb24gaW5mb0NhbGxiYWNrXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMuZXJyb3JzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmZvQ2FsbGJhY2sodGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBjYWxsYmFjazogQ2FsbGJhY2ssIC4uLmFyZ3M6IGFueVtdKXtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuSU5GTywgY2FsbGJhY2ssIC4uLmFyZ3MpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAqXG4gKiBAZnVuY3Rpb24gd2FybmluZ0NhbGxiYWNrXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMuZXJyb3JzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YXJuaW5nQ2FsbGJhY2sodGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBjYWxsYmFjazogQ2FsbGJhY2ssIC4uLmFyZ3M6IGFueVtdKXtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuV0FSTiwgY2FsbGJhY2ssIC4uLmFyZ3MpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAqXG4gKiBAZnVuY3Rpb24gZXJyb3JDYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGNhbGxiYWNrOiBDYWxsYmFjaywgLi4uYXJnczogYW55W10pe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5FUlJPUiwgY2FsbGJhY2ssIC4uLmFyZ3MpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAqXG4gKiBAZnVuY3Rpb24gY3JpdGljYWxDYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JpdGljYWxDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGNhbGxiYWNrOiBDYWxsYmFjaywgLi4uYXJnczogYW55W10pe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5DUklUSUNBTCwgY2FsbGJhY2ssIC4uLmFyZ3MpO1xufVxuXG4vKipcbiAqIFdyYXBwZXIgQ2xhc3MgZm9yIExvZ2dlZCBFcnJvcnNcbiAqIFdpbGwgdHJpZ2dlciBhIGNhbGwgdG8gdGhlIGxvZ2dlciBpZiBpdCBoYXNuJ3QgYmVlbiBsb2dnZWQgYmVmb3JlIG9vIGlmIGl0J3MgYmVpbmcgY2FsbGVkIGF0IGEgaGlnaGVyIGxldmVsXG4gKlxuICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBlcnJvclxuICogQHBhcmFtIHthbnl9IFtpc3N1ZXJdXG4gKiBAcGFyYW0ge251bWJlcn0gbGV2ZWwgZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuRVJST1J9XG4gKiBAcGFyYW0ge2FueVtdfSBbYXJnc10gYXJndW1lbnRzIHRvIGJlIHBhc3NlZCBhcyByZXBsYWNlbWVudHMgdG8gdGhlIGxvZ2dlclxuICpcbiAqIEBjbGFzcyBMb2dnZWRFcnJvclxuICogQGV4dGVuZHMgRXJyb3JcbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBMb2dnZWRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICAvKipcbiAgICAgKiBAcHJvcGVydHkge251bWJlcn0gbG9nZ2VkXG4gICAgICovXG4gICAgbG9nZ2VkQXQ/OiBudW1iZXI7XG4gICAgaXNzdWVyPzogYW55O1xuXG4gICAgY29uc3RydWN0b3IoZXJyb3I6IExvZ2dlck1lc3NhZ2UsIGlzc3VlcjogYW55ID0gdW5kZWZpbmVkLCBsZXZlbDogbnVtYmVyID0gTE9HR0VSX0xFVkVMUy5BTEwsIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgICAgIHN1cGVyKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IpO1xuICAgICAgICB0aGlzLm5hbWUgPSBcIkxvZ2dlZEVycm9yXCI7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgdGhpcy5sb2dnZWRBdCA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubmFtZSA9PT0gJ0xvZ2dlZEVycm9yJyA/IGVycm9yLmxvZ2dlZEF0IDogdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmlzc3VlciA9IGlzc3VlcjtcblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGlmIChlcnJvci5sb2dnZWRBdCA9PT0gdW5kZWZpbmVkIHx8IGVycm9yLmxvZ2dlZEF0IDwgbGV2ZWwpe1xuICAgICAgICAgICAgZ2V0TG9nZ2VyKCkucmVwb3J0KHRoaXMsIGxldmVsLCBpc3N1ZXIsIC4uLmFyZ3MpO1xuICAgICAgICAgICAgdGhpcy5sb2dnZWRBdCA9IGxldmVsO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIFdyYXBwZXIgQ2xhc3MgZm9yIENyaXRpY2FsIEVycm9yc1xuICpcbiAqIEBjbGFzcyBDcml0aWNhbEVycm9yXG4gKiBAZXh0ZW5kcyBMb2dnZWRFcnJvclxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIENyaXRpY2FsRXJyb3IgZXh0ZW5kcyBMb2dnZWRFcnJvciB7XG4gICAgY29uc3RydWN0b3IoZXJyb3I6IExvZ2dlck1lc3NhZ2UsIGlzc3VlcjogYW55ID0gdW5kZWZpbmVkLCAuLi5hcmdzOiBhbnlbXSkge1xuICAgICAgICBzdXBlcihlcnJvciwgaXNzdWVyLCBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMLCAuLi5hcmdzKTtcbiAgICB9XG59Il19
