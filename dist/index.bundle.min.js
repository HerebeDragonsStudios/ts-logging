"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(t,r,e,o){void 0===o&&(o=e),Object.defineProperty(t,o,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,o){t[o=void 0===o?e:o]=r[e]}),__exportStar=this&&this.__exportStar||function(t,r){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(r,e)||__createBinding(r,t,e)},__extends=(Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(require("./errors"),exports),__exportStar(require("./logging"),exports),this&&this.__extends||function(){var o=function(t,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}()),logging_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CriticalError=exports.LoggedError=exports.criticalCallback=exports.errorCallback=exports.warningCallback=exports.infoCallback=exports.debugCallback=exports.allCallback=exports.loggedCallback=void 0,require("../logging"));function loggedCallback(t,r,e){e||(e=r,r=logging_1.LOGGER_LEVELS.INFO),(0,logging_1.getLogger)().report(t instanceof Error?t:new LoggedError(t),r,"loggedCallback"!==this.name?this:void 0),e(t)}function allCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.ALL,r)}function debugCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.DEBUG,r)}function infoCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.INFO,r)}function warningCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.WARN,r)}function errorCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.ERROR,r)}function criticalCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.CRITICAL,r)}exports.loggedCallback=loggedCallback,exports.allCallback=allCallback,exports.debugCallback=debugCallback,exports.infoCallback=infoCallback,exports.warningCallback=warningCallback,exports.errorCallback=errorCallback,exports.criticalCallback=criticalCallback;var LoggedError=function(o){function n(t,r){void 0===r&&(r=logging_1.LOGGER_LEVELS.ERROR);var e=o.call(this,t instanceof Error?t.message:t)||this;return e.logged=!1,e.logged=t instanceof n&&t.logged,e.logged||(0,logging_1.getLogger)().report(t,r),e}return __extends(n,o),n}(Error),CriticalError=function(r){function t(t){return r.call(this,t,logging_1.LOGGER_LEVELS.CRITICAL)||this}return __extends(t,r),t}(exports.LoggedError=LoggedError),__createBinding=(exports.CriticalError=CriticalError,this&&this.__createBinding||(Object.create?function(t,r,e,o){void 0===o&&(o=e),Object.defineProperty(t,o,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,o){t[o=void 0===o?e:o]=r[e]})),__exportStar=this&&this.__exportStar||function(t,r){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(r,e)||__createBinding(r,t,e)},__spreadArray=(Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(require("./errors"),exports),Object.defineProperty(exports,"__esModule",{value:!0}),exports.DAYS_OF_WEEK_NAMES=exports.MONTH_NAMES=exports.DEFAULT_TIMESTAMP_FORMAT=exports.LOGGING_MSG=exports.LOGGER_LEVELS=void 0,exports.LOGGER_LEVELS={ALL:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,CRITICAL:5},exports.LOGGING_MSG={LEVEL_CHANGED:"Logger Level changed from {0} to {1}",LOGGER_CHANGED:"Logger changed"},exports.DEFAULT_TIMESTAMP_FORMAT="dd/MM/yyyy HH:mm:ss:S",exports.MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],exports.DAYS_OF_WEEK_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this&&this.__spreadArray||function(t,r,e){if(e||2===arguments.length)for(var o,n=0,a=r.length;n<a;n++)!o&&n in r||((o=o||Array.prototype.slice.call(r,0,n))[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}),errors_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.logSync=exports.logAsync=exports.StopWatch=void 0,require("../errors")),logging_1=require("./logging"),constants_1=require("./constants"),StopWatch=function(){function t(){}return t.prototype.start=function(){this.startTime=Date.now()},t.prototype.check=function(){if(!this.startTime)throw new Error("StopWatch didnt start");return Date.now()-this.startTime},t.prototype.stop=function(){var t=this.check();return this.startTime=void 0,t},t}();function logAsync(s,g){return void 0===s&&(s=constants_1.LOGGER_LEVELS.DEBUG),g||"boolean"!=typeof s||(g=s,s=constants_1.LOGGER_LEVELS.DEBUG),function(t,i,r){var e=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=t.pop();if(!o||"function"!=typeof o)throw new errors_1.CriticalError("Missing Callback");var n,a=this.name&&"Function"!==this.name?this.name:this.constructor&&this.constructor.name||this;(0,logging_1.getLogger)().report("[{0}] - Entering Method {1} with args: {2}",s,a,i,t.map(function(t){return t.toString()}).join(" | "));g&&(n=new StopWatch).start(),e.call.apply(e,__spreadArray(__spreadArray([this.__originalObject||this],t,!1),[function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];if(n&&(0,logging_1.getLogger)().report("[{0}][BENCHMARK] - Leaving Method {1} after {2}ms",s,a,i,n.stop()),t)return(0,logging_1.getLogger)().report("[{0}][ERROR] - Leaving Method {1} with error {2}",s,a,i,t),o(t);(0,logging_1.getLogger)().report("[{0}] - Leaving Method {1} with results: {2}",s,a,i,r?r.map(function(t){return t.toString()}).join(" | "):"void"),o.apply(void 0,__spreadArray([void 0],r,!1))}],!1))}}}function logSync(s,g){return void 0===s&&(s=constants_1.LOGGER_LEVELS.DEBUG),g||"boolean"!=typeof s||(g=s,s=constants_1.LOGGER_LEVELS.DEBUG),function(t,a,r){var i=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e,o=this.name&&"Function"!==this.name?this.name:this.constructor&&this.constructor.name||this,n=((0,logging_1.getLogger)().report("[{0}] - Entering Method {1} with args: {2}",s,o,a,t.map(function(t){return t.toString()}).join(" | ")),void 0);g&&(n=new StopWatch).start();try{e=i.call.apply(i,__spreadArray([this.__originalObject||this],t,!1))}catch(t){throw n&&(0,logging_1.getLogger)().report("[{0}][BENCHMARK] - Leaving Method {1} after {2}ms",s,o,a,n.stop()),(0,logging_1.getLogger)().report("[{0}][ERROR] - Leaving Method {1} with error {2}",s,o,a,t),t}return n&&(0,logging_1.getLogger)().report("[{0}][BENCHMARK] - Leaving Method {1} after {2}ms",s,o,a,n.stop()),(0,logging_1.getLogger)().report("[{0}] - Leaving Method {1} with results: {2}",s,o,a,e||"void"),e}}}exports.StopWatch=StopWatch,exports.logAsync=logAsync,exports.logSync=logSync;var currentLogger,__createBinding=this&&this.__createBinding||(Object.create?function(t,r,e,o){void 0===o&&(o=e),Object.defineProperty(t,o,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,o){t[o=void 0===o?e:o]=r[e]}),__exportStar=this&&this.__exportStar||function(t,r){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(r,e)||__createBinding(r,t,e)},__spreadArray=(Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(require("./constants"),exports),__exportStar(require("./logging"),exports),__exportStar(require("./decorators"),exports),this&&this.__spreadArray||function(t,r,e){if(e||2===arguments.length)for(var o,n=0,a=r.length;n<a;n++)!o&&n in r||((o=o||Array.prototype.slice.call(r,0,n))[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}),constants_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.critical=exports.error=exports.warn=exports.debug=exports.all=exports.info=exports.setLogger=exports.getLogger=exports.LoggerImp=void 0,require("./constants")),errors_1=require("../errors"),utils_1=require("./utils"),LoggerImp=function(){function t(t,r,e,o,n){void 0===t&&(t=constants_1.LOGGER_LEVELS.INFO),void 0===r&&(r=!0),void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===n&&(n=constants_1.DEFAULT_TIMESTAMP_FORMAT),this.level=t,this.useTimestamp=r,this.logLevel=e,this.logStackTrace=o,this.timestampFormat=n}return t.prototype.buildMessage=function(t,r,e){void 0===e&&(e=void 0);for(var o=[],n=3;n<arguments.length;n++)o[n-3]=arguments[n];return t instanceof Error&&(t.stack,t=t.message),this.logLevel&&(t="[".concat(Object.keys(constants_1.LOGGER_LEVELS)[r],"] - ").concat(t)),e&&(t="[".concat(e.toString(),"]").concat(t)),this.useTimestamp&&(t="[".concat((0,utils_1.formatDate)(new Date,this.timestampFormat),"]").concat(t)),utils_1.stringFormat.apply(void 0,__spreadArray([t],o,!1))},t.prototype.report=function(t,r){void 0===r&&(r=constants_1.LOGGER_LEVELS.INFO);for(var e,o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];if(!(r<this.level||t instanceof errors_1.LoggedError&&t.logged)){switch(r){case constants_1.LOGGER_LEVELS.WARN:e=console.warn;break;case constants_1.LOGGER_LEVELS.ERROR:case constants_1.LOGGER_LEVELS.CRITICAL:e=console.error;break;case constants_1.LOGGER_LEVELS.INFO:case constants_1.LOGGER_LEVELS.DEBUG:case constants_1.LOGGER_LEVELS.ALL:default:e=console.log}e(this.buildMessage.apply(this,__spreadArray([t,r,void 0],o,!1))),t instanceof Error&&t.stack&&this.logStackTrace&&(console.log(t),e(this.buildMessage("\n-- StackStrace:\n".concat(t.stack),r))),t instanceof errors_1.LoggedError&&(t.logged=!0)}},t.prototype.info=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.INFO],r,!1))},t.prototype.all=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.ALL],r,!1))},t.prototype.debug=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.DEBUG],r,!1))},t.prototype.warn=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.WARN],r,!1))},t.prototype.error=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.ERROR],r,!1))},t.prototype.critical=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.CRITICAL],r,!1))},t.prototype.setLevel=function(t){this.debug((0,utils_1.stringFormat)(constants_1.LOGGING_MSG.LEVEL_CHANGED,this.level.toString(),t.toString())),this.level=t},t}();function getLogger(){return currentLogger=currentLogger||new LoggerImp}function setLogger(t){currentLogger=t,getLogger().debug(constants_1.LOGGING_MSG.LOGGER_CHANGED)}exports.LoggerImp=LoggerImp,exports.getLogger=getLogger,exports.setLogger=setLogger;var info=function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).info.apply(r,__spreadArray([t],e,!1))},all=(exports.info=info,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).all.apply(r,__spreadArray([t],e,!1))}),debug=(exports.all=all,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).debug.apply(r,__spreadArray([t],e,!1))}),warn=(exports.debug=debug,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).warn.apply(r,__spreadArray([t],e,!1))}),error=(exports.warn=warn,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).error.apply(r,__spreadArray([t],e,!1))}),critical=(exports.error=error,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).critical.apply(r,__spreadArray([t],e,!1))}),constants_1=(exports.critical=critical,Object.defineProperty(exports,"__esModule",{value:!0}),exports.twoDigitPad=exports.formatDate=exports.stringFormat=void 0,require("./constants"));function stringFormat(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.replace(/{(\d+)}/g,function(t,r){return void 0!==e[r]?e[r]:t})}function formatDate(t,r){void 0===r&&(r="yyyy/MM/dd");var e=t.getDate(),o=t.getMonth(),n=t.getFullYear(),a=t.getHours(),i=t.getMinutes(),s=t.getSeconds(),l=t.getMilliseconds(),g=a%12,p=twoDigitPad(g),_=twoDigitPad(a),u=twoDigitPad(i),d=twoDigitPad(s),L=a<12?"AM":"PM",t=constants_1.DAYS_OF_WEEK_NAMES[t.getDay()],E=t.substr(0,3),f=twoDigitPad(e),c=o+1,h=twoDigitPad(c),o=constants_1.MONTH_NAMES[o],y=o.substr(0,3),n=n+"",v=n.substr(2,2);return r=-1<(r=r.replace("hh",p).replace("h",g.toString()).replace("HH",_).replace("H",a.toString()).replace("mm",u).replace("m",i.toString()).replace("ss",d).replace("s",s.toString()).replace("S",l.toString()).replace("dd",f).replace("d",e.toString()).replace("EEEE",t).replace("EEE",E).replace("yyyy",n).replace("yy",v).replace("aaa",L)).indexOf("MMM")?r.replace("MMMM",o).replace("MMM",y):r.replace("MM",h).replace("M",c.toString())}function twoDigitPad(t){return t<10?"0"+t:t.toString()}exports.stringFormat=stringFormat,exports.formatDate=formatDate,exports.twoDigitPad=twoDigitPad;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiZXJyb3JzL2Vycm9ycy5qcyIsImluZGV4LnRzIiwiZXJyb3JzL2Vycm9ycy50cyIsImVycm9ycy9pbmRleC5qcyIsImxvZ2dpbmcvZGVjb3JhdG9ycy5qcyIsImVycm9ycy9pbmRleC50cyIsImxvZ2dpbmcvY29uc3RhbnRzLmpzIiwibG9nZ2luZy9jb25zdGFudHMudHMiLCJsb2dnaW5nL2RlY29yYXRvcnMudHMiLCJsb2dnaW5nL2luZGV4LmpzIiwibG9nZ2luZy9sb2dnaW5nLnRzIiwibG9nZ2luZy9sb2dnaW5nLmpzIiwibG9nZ2luZy9pbmRleC50cyIsImxvZ2dpbmcvdXRpbHMudHMiLCJsb2dnaW5nL3V0aWxzLmpzIl0sIm5hbWVzIjpbIl9fY3JlYXRlQmluZGluZyIsInRoaXMiLCJPYmplY3QiLCJjcmVhdGUiLCJvIiwibSIsImsiLCJrMiIsInVuZGVmaW5lZCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIl9fZXhwb3J0U3RhciIsImV4cG9ydHMiLCJwIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX19leHRlbmRzIiwidmFsdWUiLCJyZXF1aXJlIiwiZXh0ZW5kU3RhdGljcyIsImQiLCJiIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsIlR5cGVFcnJvciIsIlN0cmluZyIsIl9fIiwiY29uc3RydWN0b3IiLCJsb2dnaW5nXzEiLCJDcml0aWNhbEVycm9yIiwiTG9nZ2VkRXJyb3IiLCJjcml0aWNhbENhbGxiYWNrIiwiZXJyb3JDYWxsYmFjayIsIndhcm5pbmdDYWxsYmFjayIsImluZm9DYWxsYmFjayIsImRlYnVnQ2FsbGJhY2siLCJhbGxDYWxsYmFjayIsImxvZ2dlZENhbGxiYWNrIiwibWVzc2FnZSIsImxldmVsIiwiY2FsbGJhY2siLCJMT0dHRVJfTEVWRUxTIiwiSU5GTyIsImdldExvZ2dlciIsInJlcG9ydCIsIkVycm9yIiwibmFtZSIsIkFMTCIsIkRFQlVHIiwiV0FSTiIsIkVSUk9SIiwiQ1JJVElDQUwiLCJfc3VwZXIiLCJlcnJvciIsIl90aGlzIiwibG9nZ2VkIiwiX19zcHJlYWRBcnJheSIsIkRBWVNfT0ZfV0VFS19OQU1FUyIsIk1PTlRIX05BTUVTIiwiREVGQVVMVF9USU1FU1RBTVBfRk9STUFUIiwiTE9HR0lOR19NU0ciLCJMRVZFTF9DSEFOR0VEIiwiTE9HR0VSX0NIQU5HRUQiLCJ0byIsImZyb20iLCJwYWNrIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiYXIiLCJpIiwibCIsInNsaWNlIiwiY29uY2F0IiwiZXJyb3JzXzEiLCJsb2dTeW5jIiwibG9nQXN5bmMiLCJTdG9wV2F0Y2giLCJjb25zdGFudHNfMSIsInN0YXJ0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImNoZWNrIiwic3RvcCIsInJlc3VsdCIsImJlbmNobWFyayIsInRhcmdldCIsInByb3BlcnR5S2V5IiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwiYXJncyIsIl9pIiwicG9wIiwic3RvcFdhdGNoIiwibWFwIiwiYSIsInRvU3RyaW5nIiwiam9pbiIsImFwcGx5IiwiX19vcmlnaW5hbE9iamVjdCIsImVyciIsInJlc3VsdHMiLCJlIiwiY3VycmVudExvZ2dlciIsImNyaXRpY2FsIiwid2FybiIsImRlYnVnIiwiYWxsIiwiaW5mbyIsInNldExvZ2dlciIsIkxvZ2dlckltcCIsInV0aWxzXzEiLCJkZWZhdWx0TGV2ZWwiLCJ1c2VUaW1lc3RhbXAiLCJsb2dMZXZlbCIsImxvZ1N0YWNrVHJhY2UiLCJ0aW1lc3RhbXBGb3JtYXQiLCJidWlsZE1lc3NhZ2UiLCJpc3N1ZXIiLCJzdGFjayIsImtleXMiLCJmb3JtYXREYXRlIiwic3RyaW5nRm9ybWF0IiwicmVwb3J0TWV0aG9kIiwiY29uc29sZSIsImxvZyIsInNldExldmVsIiwibG9nZ2VyIiwiX2EiLCJ0d29EaWdpdFBhZCIsInN0cmluZyIsInJlcGxhY2UiLCJtYXRjaCIsIm51bWJlciIsImRhdGUiLCJwYXR0ZXJuU3RyIiwiZGF5IiwiZ2V0RGF0ZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJob3VyIiwiZ2V0SG91cnMiLCJtaW51dGUiLCJnZXRNaW51dGVzIiwic2Vjb25kIiwiZ2V0U2Vjb25kcyIsIm1pbGlzZWNvbmRzIiwiZ2V0TWlsbGlzZWNvbmRzIiwiaCIsImhoIiwiSEgiLCJtbSIsInNzIiwiYWFhIiwiRUVFRSIsImdldERheSIsIkVFRSIsInN1YnN0ciIsImRkIiwiTSIsIk1NIiwiTU1NTSIsIk1NTSIsInl5eXkiLCJ5eSIsImluZGV4T2YiLCJudW0iXSwibWFwcGluZ3MiOiJhQUNBLElBQUlBLGdCQUFtQkMsTUFBUUEsS0FBS0Qsa0JBQXFCRSxPQUFPQyxPQUFVLFNBQVNDLEVBQUdDLEVBQUdDLEVBQUdDLFFBQzdFQyxJQUFQRCxJQUFrQkEsRUFBS0QsR0FDM0JKLE9BQU9PLGVBQWVMLEVBQUdHLEVBQUksQ0FBRUcsWUFBWSxFQUFNQyxJQUFLLFdBQWEsT0FBT04sRUFBRUMsT0FDMUUsU0FBU0YsRUFBR0MsRUFBR0MsRUFBR0MsR0FFcEJILEVBRHNCRyxPQUFYQyxJQUFQRCxFQUF1QkQsRUFDekJDLEdBQU1GLEVBQUVDLEtBRVZNLGFBQWdCWCxNQUFRQSxLQUFLVyxjQUFpQixTQUFTUCxFQUFHUSxHQUMxRCxJQUFLLElBQUlDLEtBQUtULEVBQWEsWUFBTlMsR0FBb0JaLE9BQU9hLFVBQVVDLGVBQWVDLEtBQUtKLEVBQVNDLElBQUlkLGdCQUFnQmEsRUFBU1IsRUFBR1MsSUNSdkhJLFdEVUpoQixPQUFPTyxlQUFlSSxRQUFTLGFBQWMsQ0FBRU0sT0FBTyxJRVB0RFAsYUFBQVEsUUFBQSxZQUFBUCxTQUNBRCxhQUFBUSxRQUFBLGFBQUFQLFNESmlCWixNQUFRQSxLQUFLaUIsV0FBZSxXQUN6QyxJQUFJRyxFQUFnQixTQUFVQyxFQUFHQyxHQUk3QixPQUhBRixFQUFnQm5CLE9BQU9zQixnQkFDbEIsQ0FBRUMsVUFBVyxjQUFnQkMsT0FBUyxTQUFVSixFQUFHQyxHQUFLRCxFQUFF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c291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19jcmVhdGVCaW5kaW5nID0gKHRoaXMgJiYgdGhpcy5fX2NyZWF0ZUJpbmRpbmcpIHx8IChPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XG59KSA6IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgb1trMl0gPSBtW2tdO1xufSkpO1xudmFyIF9fZXhwb3J0U3RhciA9ICh0aGlzICYmIHRoaXMuX19leHBvcnRTdGFyKSB8fCBmdW5jdGlvbihtLCBleHBvcnRzKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChleHBvcnRzLCBwKSkgX19jcmVhdGVCaW5kaW5nKGV4cG9ydHMsIG0sIHApO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9lcnJvcnNcIiksIGV4cG9ydHMpO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2xvZ2dpbmdcIiksIGV4cG9ydHMpOyIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuQ3JpdGljYWxFcnJvciA9IGV4cG9ydHMuTG9nZ2VkRXJyb3IgPSBleHBvcnRzLmNyaXRpY2FsQ2FsbGJhY2sgPSBleHBvcnRzLmVycm9yQ2FsbGJhY2sgPSBleHBvcnRzLndhcm5pbmdDYWxsYmFjayA9IGV4cG9ydHMuaW5mb0NhbGxiYWNrID0gZXhwb3J0cy5kZWJ1Z0NhbGxiYWNrID0gZXhwb3J0cy5hbGxDYWxsYmFjayA9IGV4cG9ydHMubG9nZ2VkQ2FsbGJhY2sgPSB2b2lkIDA7XG52YXIgbG9nZ2luZ18xID0gcmVxdWlyZShcIi4uL2xvZ2dpbmdcIik7XG5mdW5jdGlvbiBsb2dnZWRDYWxsYmFjayhtZXNzYWdlLCBsZXZlbCwgY2FsbGJhY2spIHtcbiAgICBpZiAoIWNhbGxiYWNrKSB7XG4gICAgICAgIGNhbGxiYWNrID0gbGV2ZWw7XG4gICAgICAgIGxldmVsID0gbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuSU5GTztcbiAgICB9XG4gICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KG1lc3NhZ2UgaW5zdGFuY2VvZiBFcnJvciA/IG1lc3NhZ2UgOiBuZXcgTG9nZ2VkRXJyb3IobWVzc2FnZSksIGxldmVsLCB0aGlzLm5hbWUgIT09IFwibG9nZ2VkQ2FsbGJhY2tcIiA/IHRoaXMgOiB1bmRlZmluZWQpO1xuICAgIGNhbGxiYWNrKG1lc3NhZ2UpO1xufVxuZXhwb3J0cy5sb2dnZWRDYWxsYmFjayA9IGxvZ2dlZENhbGxiYWNrO1xuZnVuY3Rpb24gYWxsQ2FsbGJhY2sobWVzc2FnZSwgY2FsbGJhY2spIHtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLkFMTCwgY2FsbGJhY2spO1xufVxuZXhwb3J0cy5hbGxDYWxsYmFjayA9IGFsbENhbGxiYWNrO1xuZnVuY3Rpb24gZGVidWdDYWxsYmFjayhtZXNzYWdlLCBjYWxsYmFjaykge1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuREVCVUcsIGNhbGxiYWNrKTtcbn1cbmV4cG9ydHMuZGVidWdDYWxsYmFjayA9IGRlYnVnQ2FsbGJhY2s7XG5mdW5jdGlvbiBpbmZvQ2FsbGJhY2sobWVzc2FnZSwgY2FsbGJhY2spIHtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLklORk8sIGNhbGxiYWNrKTtcbn1cbmV4cG9ydHMuaW5mb0NhbGxiYWNrID0gaW5mb0NhbGxiYWNrO1xuZnVuY3Rpb24gd2FybmluZ0NhbGxiYWNrKG1lc3NhZ2UsIGNhbGxiYWNrKSB7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5XQVJOLCBjYWxsYmFjayk7XG59XG5leHBvcnRzLndhcm5pbmdDYWxsYmFjayA9IHdhcm5pbmdDYWxsYmFjaztcbmZ1bmN0aW9uIGVycm9yQ2FsbGJhY2sobWVzc2FnZSwgY2FsbGJhY2spIHtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLkVSUk9SLCBjYWxsYmFjayk7XG59XG5leHBvcnRzLmVycm9yQ2FsbGJhY2sgPSBlcnJvckNhbGxiYWNrO1xuZnVuY3Rpb24gY3JpdGljYWxDYWxsYmFjayhtZXNzYWdlLCBjYWxsYmFjaykge1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuQ1JJVElDQUwsIGNhbGxiYWNrKTtcbn1cbmV4cG9ydHMuY3JpdGljYWxDYWxsYmFjayA9IGNyaXRpY2FsQ2FsbGJhY2s7XG52YXIgTG9nZ2VkRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhMb2dnZWRFcnJvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMb2dnZWRFcnJvcihlcnJvciwgbGV2ZWwpIHtcbiAgICAgICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5FUlJPUjsgfVxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IGVycm9yKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5sb2dnZWQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMubG9nZ2VkID0gZXJyb3IgaW5zdGFuY2VvZiBMb2dnZWRFcnJvciAmJiBlcnJvci5sb2dnZWQ7XG4gICAgICAgIGlmICghX3RoaXMubG9nZ2VkKVxuICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KGVycm9yLCBsZXZlbCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIExvZ2dlZEVycm9yO1xufShFcnJvcikpO1xuZXhwb3J0cy5Mb2dnZWRFcnJvciA9IExvZ2dlZEVycm9yO1xudmFyIENyaXRpY2FsRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDcml0aWNhbEVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENyaXRpY2FsRXJyb3IoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIGVycm9yLCBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5DUklUSUNBTCkgfHwgdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIENyaXRpY2FsRXJyb3I7XG59KExvZ2dlZEVycm9yKSk7XG5leHBvcnRzLkNyaXRpY2FsRXJyb3IgPSBDcml0aWNhbEVycm9yOyIsIi8qKlxuICogQG1vZHVsZSBsb2dnaW5nXG4gKi9cblxuZXhwb3J0ICogZnJvbSAnLi9lcnJvcnMnO1xuZXhwb3J0ICogZnJvbSAnLi9sb2dnaW5nJzsiLCJpbXBvcnQge0NhbGxiYWNrLCBnZXRMb2dnZXIsIExPR0dFUl9MRVZFTFMsIExvZ2dlck1lc3NhZ2V9IGZyb20gXCIuLi9sb2dnaW5nXCI7XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcGFyYW0ge251bWJlcn0gbGV2ZWxcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKlxuICogQGZ1bmN0aW9uIGxvZ2dlZENhbGxiYWNrXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMuZXJyb3JzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2dnZWRDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGxldmVsOiBudW1iZXIgfCBDYWxsYmFjaywgY2FsbGJhY2s6IENhbGxiYWNrKXtcbiAgICBpZiAoIWNhbGxiYWNrKXtcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICBjYWxsYmFjayA9IGxldmVsO1xuICAgICAgICBsZXZlbCA9IExPR0dFUl9MRVZFTFMuSU5GTztcbiAgICB9XG5cbiAgICBnZXRMb2dnZXIoKS5yZXBvcnQobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yID8gbWVzc2FnZSA6IG5ldyBMb2dnZWRFcnJvcihtZXNzYWdlKSwgbGV2ZWwgYXMgbnVtYmVyLCB0aGlzLm5hbWUgIT09IFwibG9nZ2VkQ2FsbGJhY2tcIiA/IHRoaXMgOiB1bmRlZmluZWQpO1xuICAgIGNhbGxiYWNrKG1lc3NhZ2UpO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKlxuICogQGZ1bmN0aW9uIGFsbENhbGxiYWNrXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMuZXJyb3JzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBhbGxDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGNhbGxiYWNrOiBDYWxsYmFjayl7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkFMTCwgY2FsbGJhY2spO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKlxuICogQGZ1bmN0aW9uIGRlYnVnQ2FsbGJhY2tcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlYnVnQ2FsbGJhY2sodGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBjYWxsYmFjazogQ2FsbGJhY2spe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5ERUJVRywgY2FsbGJhY2spO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKlxuICogQGZ1bmN0aW9uIGluZm9DYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaW5mb0NhbGxiYWNrKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgY2FsbGJhY2s6IENhbGxiYWNrKXtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuSU5GTywgY2FsbGJhY2spO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKlxuICogQGZ1bmN0aW9uIHdhcm5pbmdDYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gd2FybmluZ0NhbGxiYWNrKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgY2FsbGJhY2s6IENhbGxiYWNrKXtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuV0FSTiwgY2FsbGJhY2spO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKlxuICogQGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2tcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2sodGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBjYWxsYmFjazogQ2FsbGJhY2spe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5FUlJPUiwgY2FsbGJhY2spO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7Q2FsbGJhY2t9IGNhbGxiYWNrXG4gKlxuICogQGZ1bmN0aW9uIGNyaXRpY2FsQ2FsbGJhY2tcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyaXRpY2FsQ2FsbGJhY2sodGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBjYWxsYmFjazogQ2FsbGJhY2spe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5DUklUSUNBTCwgY2FsbGJhY2spO1xufVxuXG4vKipcbiAqIFdyYXBwZXIgQ2xhc3MgZm9yIExvZ2dlZCBFcnJvcnNcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IGVycm9yXG4gKiBAcGFyYW0ge251bWJlcn0gbGV2ZWwgZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuRVJST1J9XG4gKlxuICogQGNsYXNzIExvZ2dlZEVycm9yXG4gKiBAZXh0ZW5kcyBFcnJvclxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIExvZ2dlZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIC8qKlxuICAgICAqIEBwcm9wZXJ0eSBsb2dnZWRcbiAgICAgKi9cbiAgICBsb2dnZWQgPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKGVycm9yOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyID0gTE9HR0VSX0xFVkVMUy5FUlJPUikge1xuICAgICAgICBzdXBlcihlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IGVycm9yKTtcbiAgICAgICAgdGhpcy5sb2dnZWQgPSBlcnJvciBpbnN0YW5jZW9mIExvZ2dlZEVycm9yICYmIGVycm9yLmxvZ2dlZDtcbiAgICAgICAgaWYgKCF0aGlzLmxvZ2dlZClcbiAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChlcnJvciwgbGV2ZWwpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBXcmFwcGVyIENsYXNzIGZvciBDcml0aWNhbCBFcnJvcnNcbiAqXG4gKiBAY2xhc3MgQ3JpdGljYWxFcnJvclxuICogQGV4dGVuZHMgTG9nZ2VkRXJyb3JcbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBDcml0aWNhbEVycm9yIGV4dGVuZHMgTG9nZ2VkRXJyb3J7XG4gICAgY29uc3RydWN0b3IoZXJyb3I6IExvZ2dlck1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIoZXJyb3IsIExPR0dFUl9MRVZFTFMuQ1JJVElDQUwpO1xuICAgIH1cbn0iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9KTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19leHBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2V4cG9ydFN0YXIpIHx8IGZ1bmN0aW9uKG0sIGV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGV4cG9ydHMsIHApKSBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2Vycm9yc1wiKSwgZXhwb3J0cyk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19zcHJlYWRBcnJheSA9ICh0aGlzICYmIHRoaXMuX19zcHJlYWRBcnJheSkgfHwgZnVuY3Rpb24gKHRvLCBmcm9tLCBwYWNrKSB7XG4gICAgaWYgKHBhY2sgfHwgYXJndW1lbnRzLmxlbmd0aCA9PT0gMikgZm9yICh2YXIgaSA9IDAsIGwgPSBmcm9tLmxlbmd0aCwgYXI7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgaWYgKGFyIHx8ICEoaSBpbiBmcm9tKSkge1xuICAgICAgICAgICAgaWYgKCFhcikgYXIgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLCAwLCBpKTtcbiAgICAgICAgICAgIGFyW2ldID0gZnJvbVtpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdG8uY29uY2F0KGFyIHx8IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20pKTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLmxvZ1N5bmMgPSBleHBvcnRzLmxvZ0FzeW5jID0gZXhwb3J0cy5TdG9wV2F0Y2ggPSB2b2lkIDA7XG52YXIgZXJyb3JzXzEgPSByZXF1aXJlKFwiLi4vZXJyb3JzXCIpO1xudmFyIGxvZ2dpbmdfMSA9IHJlcXVpcmUoXCIuL2xvZ2dpbmdcIik7XG52YXIgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XG52YXIgU3RvcFdhdGNoID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTdG9wV2F0Y2goKSB7XG4gICAgfVxuICAgIFN0b3BXYXRjaC5wcm90b3R5cGUuc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB9O1xuICAgIFN0b3BXYXRjaC5wcm90b3R5cGUuY2hlY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5zdGFydFRpbWUpXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1N0b3BXYXRjaCBkaWRudCBzdGFydCcpO1xuICAgICAgICByZXR1cm4gRGF0ZS5ub3coKSAtIHRoaXMuc3RhcnRUaW1lO1xuICAgIH07XG4gICAgU3RvcFdhdGNoLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5jaGVjaygpO1xuICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIHJldHVybiBTdG9wV2F0Y2g7XG59KCkpO1xuZXhwb3J0cy5TdG9wV2F0Y2ggPSBTdG9wV2F0Y2g7XG5mdW5jdGlvbiBsb2dBc3luYyhsZXZlbCwgYmVuY2htYXJrKSB7XG4gICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHOyB9XG4gICAgaWYgKCFiZW5jaG1hcmsgJiYgdHlwZW9mIGxldmVsID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgYmVuY2htYXJrID0gbGV2ZWw7XG4gICAgICAgIGxldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5ERUJVRztcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIHByb3BlcnR5S2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgICAgIHZhciBtZXRob2RXcmFwcGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJncy5wb3AoKTtcbiAgICAgICAgICAgIGlmICghY2FsbGJhY2sgfHwgdHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBlcnJvcnNfMS5Dcml0aWNhbEVycm9yKFwiTWlzc2luZyBDYWxsYmFja1wiKTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gdGhpcy5uYW1lICYmIHRoaXMubmFtZSAhPT0gJ0Z1bmN0aW9uJyA/IHRoaXMubmFtZSA6IHRoaXMuY29uc3RydWN0b3IgJiYgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lIHx8IHRoaXM7XG4gICAgICAgICAgICAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKS5yZXBvcnQoXCJbezB9XSAtIEVudGVyaW5nIE1ldGhvZCB7MX0gd2l0aCBhcmdzOiB7Mn1cIiwgbGV2ZWwsIG5hbWUsIHByb3BlcnR5S2V5LCBhcmdzLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gYS50b1N0cmluZygpOyB9KS5qb2luKCcgfCAnKSk7XG4gICAgICAgICAgICB2YXIgc3RvcFdhdGNoO1xuICAgICAgICAgICAgdmFyIGNiID0gZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0c1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHN0b3BXYXRjaClcbiAgICAgICAgICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KFwiW3swfV1bQkVOQ0hNQVJLXSAtIExlYXZpbmcgTWV0aG9kIHsxfSBhZnRlciB7Mn1tc1wiLCBsZXZlbCwgbmFtZSwgcHJvcGVydHlLZXksIHN0b3BXYXRjaC5zdG9wKCkpO1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KFwiW3swfV1bRVJST1JdIC0gTGVhdmluZyBNZXRob2QgezF9IHdpdGggZXJyb3IgezJ9XCIsIGxldmVsLCBuYW1lLCBwcm9wZXJ0eUtleSwgZXJyKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKGVycik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICgwLCBsb2dnaW5nXzEuZ2V0TG9nZ2VyKSgpLnJlcG9ydChcIlt7MH1dIC0gTGVhdmluZyBNZXRob2QgezF9IHdpdGggcmVzdWx0czogezJ9XCIsIGxldmVsLCBuYW1lLCBwcm9wZXJ0eUtleSwgcmVzdWx0cyA/IHJlc3VsdHMubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnRvU3RyaW5nKCk7IH0pLmpvaW4oJyB8ICcpIDogXCJ2b2lkXCIpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbdW5kZWZpbmVkXSwgcmVzdWx0cywgZmFsc2UpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoYmVuY2htYXJrKSB7XG4gICAgICAgICAgICAgICAgc3RvcFdhdGNoID0gbmV3IFN0b3BXYXRjaCgpO1xuICAgICAgICAgICAgICAgIHN0b3BXYXRjaC5zdGFydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3JpZ2luYWxNZXRob2QuY2FsbC5hcHBseShvcmlnaW5hbE1ldGhvZCwgX19zcHJlYWRBcnJheShfX3NwcmVhZEFycmF5KFt0aGlzLl9fb3JpZ2luYWxPYmplY3QgfHwgdGhpc10sIGFyZ3MsIGZhbHNlKSwgW2NiXSwgZmFsc2UpKTtcbiAgICAgICAgfTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IG1ldGhvZFdyYXBwZXI7XG4gICAgfTtcbn1cbmV4cG9ydHMubG9nQXN5bmMgPSBsb2dBc3luYztcbmZ1bmN0aW9uIGxvZ1N5bmMobGV2ZWwsIGJlbmNobWFyaykge1xuICAgIGlmIChsZXZlbCA9PT0gdm9pZCAwKSB7IGxldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5ERUJVRzsgfVxuICAgIGlmICghYmVuY2htYXJrICYmIHR5cGVvZiBsZXZlbCA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgIGJlbmNobWFyayA9IGxldmVsO1xuICAgICAgICBsZXZlbCA9IGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuREVCVUc7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBwcm9wZXJ0eUtleSwgZGVzY3JpcHRvcikge1xuICAgICAgICB2YXIgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgICAgICB2YXIgbWV0aG9kV3JhcHBlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBuYW1lID0gdGhpcy5uYW1lICYmIHRoaXMubmFtZSAhPT0gJ0Z1bmN0aW9uJyA/IHRoaXMubmFtZSA6IHRoaXMuY29uc3RydWN0b3IgJiYgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lIHx8IHRoaXM7XG4gICAgICAgICAgICAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKS5yZXBvcnQoXCJbezB9XSAtIEVudGVyaW5nIE1ldGhvZCB7MX0gd2l0aCBhcmdzOiB7Mn1cIiwgbGV2ZWwsIG5hbWUsIHByb3BlcnR5S2V5LCBhcmdzLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gYS50b1N0cmluZygpOyB9KS5qb2luKCcgfCAnKSk7XG4gICAgICAgICAgICB2YXIgc3RvcFdhdGNoID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgIGlmIChiZW5jaG1hcmspIHtcbiAgICAgICAgICAgICAgICBzdG9wV2F0Y2ggPSBuZXcgU3RvcFdhdGNoKCk7XG4gICAgICAgICAgICAgICAgc3RvcFdhdGNoLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IG9yaWdpbmFsTWV0aG9kLmNhbGwuYXBwbHkob3JpZ2luYWxNZXRob2QsIF9fc3ByZWFkQXJyYXkoW3RoaXMuX19vcmlnaW5hbE9iamVjdCB8fCB0aGlzXSwgYXJncywgZmFsc2UpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0b3BXYXRjaClcbiAgICAgICAgICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KFwiW3swfV1bQkVOQ0hNQVJLXSAtIExlYXZpbmcgTWV0aG9kIHsxfSBhZnRlciB7Mn1tc1wiLCBsZXZlbCwgbmFtZSwgcHJvcGVydHlLZXksIHN0b3BXYXRjaC5zdG9wKCkpO1xuICAgICAgICAgICAgICAgICgwLCBsb2dnaW5nXzEuZ2V0TG9nZ2VyKSgpLnJlcG9ydChcIlt7MH1dW0VSUk9SXSAtIExlYXZpbmcgTWV0aG9kIHsxfSB3aXRoIGVycm9yIHsyfVwiLCBsZXZlbCwgbmFtZSwgcHJvcGVydHlLZXksIGUpO1xuICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3RvcFdhdGNoKVxuICAgICAgICAgICAgICAgICgwLCBsb2dnaW5nXzEuZ2V0TG9nZ2VyKSgpLnJlcG9ydChcIlt7MH1dW0JFTkNITUFSS10gLSBMZWF2aW5nIE1ldGhvZCB7MX0gYWZ0ZXIgezJ9bXNcIiwgbGV2ZWwsIG5hbWUsIHByb3BlcnR5S2V5LCBzdG9wV2F0Y2guc3RvcCgpKTtcbiAgICAgICAgICAgICgwLCBsb2dnaW5nXzEuZ2V0TG9nZ2VyKSgpLnJlcG9ydChcIlt7MH1dIC0gTGVhdmluZyBNZXRob2QgezF9IHdpdGggcmVzdWx0czogezJ9XCIsIGxldmVsLCBuYW1lLCBwcm9wZXJ0eUtleSwgcmVzdWx0ID8gcmVzdWx0IDogXCJ2b2lkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IG1ldGhvZFdyYXBwZXI7XG4gICAgfTtcbn1cbmV4cG9ydHMubG9nU3luYyA9IGxvZ1N5bmM7IiwiLyoqXG4gKiBAbmFtZXNwYWNlIGRiLWRlY29yYXRvcnMuZXJyb3JzXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9yc1xuICovXG5cbmV4cG9ydCAqIGZyb20gJy4vZXJyb3JzJzsiLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuREFZU19PRl9XRUVLX05BTUVTID0gZXhwb3J0cy5NT05USF9OQU1FUyA9IGV4cG9ydHMuREVGQVVMVF9USU1FU1RBTVBfRk9STUFUID0gZXhwb3J0cy5MT0dHSU5HX01TRyA9IGV4cG9ydHMuTE9HR0VSX0xFVkVMUyA9IHZvaWQgMDtcbmV4cG9ydHMuTE9HR0VSX0xFVkVMUyA9IHtcbiAgICBBTEw6IDAsXG4gICAgREVCVUc6IDEsXG4gICAgSU5GTzogMixcbiAgICBXQVJOOiAzLFxuICAgIEVSUk9SOiA0LFxuICAgIENSSVRJQ0FMOiA1XG59O1xuZXhwb3J0cy5MT0dHSU5HX01TRyA9IHtcbiAgICBMRVZFTF9DSEFOR0VEOiBcIkxvZ2dlciBMZXZlbCBjaGFuZ2VkIGZyb20gezB9IHRvIHsxfVwiLFxuICAgIExPR0dFUl9DSEFOR0VEOiBcIkxvZ2dlciBjaGFuZ2VkXCJcbn07XG5leHBvcnRzLkRFRkFVTFRfVElNRVNUQU1QX0ZPUk1BVCA9IFwiZGQvTU0veXl5eSBISDptbTpzczpTXCI7XG5leHBvcnRzLk1PTlRIX05BTUVTID0gW1xuICAgIFwiSmFudWFyeVwiLCBcIkZlYnJ1YXJ5XCIsIFwiTWFyY2hcIiwgXCJBcHJpbFwiLCBcIk1heVwiLCBcIkp1bmVcIiwgXCJKdWx5XCIsXG4gICAgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPY3RvYmVyXCIsIFwiTm92ZW1iZXJcIiwgXCJEZWNlbWJlclwiXG5dO1xuZXhwb3J0cy5EQVlTX09GX1dFRUtfTkFNRVMgPSBbXG4gICAgXCJTdW5kYXlcIiwgXCJNb25kYXlcIiwgXCJUdWVzZGF5XCIsXG4gICAgXCJXZWRuZXNkYXlcIiwgXCJUaHVyc2RheVwiLCBcIkZyaWRheVwiLCBcIlNhdHVyZGF5XCJcbl07IiwiLyoqXG4gKiBAZW51bSBMT0dHRVJfTEVWRUxTXG4gKlxuICogQGNhdGVnb3J5IENvbnN0YW50c1xuICovXG5leHBvcnQgY29uc3QgTE9HR0VSX0xFVkVMUyA9IHtcbiAgICBBTEw6IDAsXG4gICAgREVCVUc6IDEsXG4gICAgSU5GTzogMixcbiAgICBXQVJOOiAzLFxuICAgIEVSUk9SOiA0LFxuICAgIENSSVRJQ0FMOiA1XG59XG5cbi8qKlxuICogRGVmYXVsdCBtZXNzYWdlc1xuICpcbiAqIGNvbnN0YW50IExPR0dJTkdfTVNHXG4gKlxuICogQG1lbWJlck9mIGxvZ2dpbmcubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgTE9HR0lOR19NU0cgPSB7XG4gICAgTEVWRUxfQ0hBTkdFRDogXCJMb2dnZXIgTGV2ZWwgY2hhbmdlZCBmcm9tIHswfSB0byB7MX1cIixcbiAgICBMT0dHRVJfQ0hBTkdFRDogXCJMb2dnZXIgY2hhbmdlZFwiXG59XG5cbi8qKlxuICogQHR5cGVkZWYgRXJyXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKiAqL1xuZXhwb3J0IHR5cGUgRXJyID0gRXJyb3IgfCBzdHJpbmcgfCB1bmRlZmluZWQ7XG4vKipcbiAqIEB0eXBlZGVmIENhbGxiYWNrXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKiAqL1xuZXhwb3J0IHR5cGUgQ2FsbGJhY2sgPSAoZXJyPzogRXJyLCAuLi5hcmdzOiBhbnlbXSkgPT4gdm9pZDtcblxuLyoqXG4gKiBAY29uc3RhbnQgREVGQVVMVF9USU1FU1RBTVBfRk9STUFUXG4gKiBAY2F0ZWdvcnkgQ29uc3RhbnRzXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQgPSBcImRkL01NL3l5eXkgSEg6bW06c3M6U1wiO1xuXG4vKipcbiAqIENhbiBiZSBjaGFuZ2VkIGZvciBsb2NhbGl6YXRpb24gcHVycG9zZXNcbiAqXG4gKiBAY29uc3RhbnQgTU9OVEhfTkFNRVNcbiAqL1xuZXhwb3J0IGNvbnN0IE1PTlRIX05BTUVTID0gW1xuICAgIFwiSmFudWFyeVwiLCBcIkZlYnJ1YXJ5XCIsIFwiTWFyY2hcIiwgXCJBcHJpbFwiLCBcIk1heVwiLCBcIkp1bmVcIiwgXCJKdWx5XCIsXG4gICAgXCJBdWd1c3RcIiwgXCJTZXB0ZW1iZXJcIiwgXCJPY3RvYmVyXCIsIFwiTm92ZW1iZXJcIiwgXCJEZWNlbWJlclwiXG5dO1xuXG4vKipcbiAqIENhbiBiZSBjaGFuZ2VkIGZvciBsb2NhbGl6YXRpb24gcHVycG9zZXNcbiAqXG4gKiBAY29uc3RhbnQgREFZU19PRl9XRUVLX05BTUVTXG4gKi9cbmV4cG9ydCBjb25zdCBEQVlTX09GX1dFRUtfTkFNRVMgPSBbXG4gICAgXCJTdW5kYXlcIiwgXCJNb25kYXlcIiwgXCJUdWVzZGF5XCIsXG4gICAgXCJXZWRuZXNkYXlcIiwgXCJUaHVyc2RheVwiLCBcIkZyaWRheVwiLCBcIlNhdHVyZGF5XCJcbl07IiwiaW1wb3J0IHtDcml0aWNhbEVycm9yfSBmcm9tIFwiLi4vZXJyb3JzXCI7XG5pbXBvcnQge2dldExvZ2dlcn0gZnJvbSBcIi4vbG9nZ2luZ1wiO1xuaW1wb3J0IHtDYWxsYmFjaywgRXJyLCBMT0dHRVJfTEVWRUxTfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcblxuLyoqXG4gKiBVdGlsIGNsYXNzIHRvIG1lYXN1cmUgdGltZSBiZXR3ZWVuIHR3byBwb2ludHMgaW4gdGltZTtcbiAqXG4gKiBAY2xhc3MgU3RvcFdhdGNoXG4gKlxuICovXG5leHBvcnQgY2xhc3MgU3RvcFdhdGNoe1xuICAgIHByaXZhdGUgc3RhcnRUaW1lPzogbnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBzdGFydCB0aW1lXG4gICAgICovXG4gICAgc3RhcnQoKXtcbiAgICAgICAgdGhpcy5zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJldHVybnMgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiBub3cgYW5kIHRoZSBzdGFydCB0aW1lXG4gICAgICovXG4gICAgY2hlY2soKTogbnVtYmVyIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0VGltZSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU3RvcFdhdGNoIGRpZG50IHN0YXJ0Jyk7XG4gICAgICAgIHJldHVybiBEYXRlLm5vdygpIC0gdGhpcy5zdGFydFRpbWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmV0dXJucyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIG5vdyBhbmQgdGhlIHN0YXJ0IHRpbWVcbiAgICAgKiBzdG9wcyB0aGUgVGltZVdhdGNoXG4gICAgICovXG4gICAgc3RvcCgpOiBudW1iZXIge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmNoZWNrKCk7XG4gICAgICAgIHRoaXMuc3RhcnRUaW1lID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbn1cblxuLyoqXG4gKiBBc3luYyBNZXRob2QgZGVjb3JhdG9yIHRvIGxvZyB0aGUgaW5wdXQgYW5kIG91dHB1dCBvZiB0aGF0IG1ldGhvZFxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBbbGV2ZWxdIExvZ2dpbmcgTGV2ZWwgYXMgaW4ge0BsaW5rIExPR0dFUl9MRVZFTFN9IGRlZmF1bHRzIHRvIHtAbGluayBMT0dHRVJfTEVWRUxTLkRFQlVHfVxuICogQHBhcmFtIHtib29sZWFufSBbYmVuY2htYXJrXSBkZXRlcm1pbmVzIGlmIHRoZSBsb2dnaW5nIGluY2x1ZGVzIHRoZSBkdXJhdGlvbiBpbiBtcy4gZGVmYXVsdHMgdG8gZmFsc2VcbiAqXG4gKiBAZGVjb3JhdG9yIGxvZ0FzeW5jXG4gKlxuICogQGNhdGVnb3J5IERlY29yYXRvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ0FzeW5jKGxldmVsOiBudW1iZXIgfCBib29sZWFuID0gTE9HR0VSX0xFVkVMUy5ERUJVRywgYmVuY2htYXJrPzogYm9vbGVhbikge1xuXG4gICAgaWYgKCFiZW5jaG1hcmsgJiYgdHlwZW9mIGxldmVsID09PSAnYm9vbGVhbicpe1xuICAgICAgICBiZW5jaG1hcmsgPSBsZXZlbDtcbiAgICAgICAgbGV2ZWwgPSBMT0dHRVJfTEVWRUxTLkRFQlVHO1xuICAgIH1cblxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0OiBhbnksIHByb3BlcnR5S2V5OiBzdHJpbmcsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcikge1xuXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcblxuICAgICAgICBjb25zdCBtZXRob2RXcmFwcGVyID0gZnVuY3Rpb24odGhpczogYW55LCAuLi5hcmdzOiBhbnlbXSl7XG4gICAgICAgICAgICBsZXQgY2FsbGJhY2s6IENhbGxiYWNrID0gYXJncy5wb3AoKTtcbiAgICAgICAgICAgIGlmICghY2FsbGJhY2sgfHwgdHlwZW9mIGNhbGxiYWNrICE9PSAnZnVuY3Rpb24nKVxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDcml0aWNhbEVycm9yKGBNaXNzaW5nIENhbGxiYWNrYCk7XG5cbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLm5hbWUgJiYgdGhpcy5uYW1lICE9PSAnRnVuY3Rpb24nID8gdGhpcy5uYW1lIDogdGhpcy5jb25zdHJ1Y3RvciAmJiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUgfHwgdGhpcztcbiAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChgW3swfV0gLSBFbnRlcmluZyBNZXRob2QgezF9IHdpdGggYXJnczogezJ9YCwgbGV2ZWwgYXMgbnVtYmVyLCBuYW1lLCBwcm9wZXJ0eUtleSwgYXJncy5tYXAoYSA9PiBhLnRvU3RyaW5nKCkpLmpvaW4oJyB8ICcpKTtcblxuICAgICAgICAgICAgbGV0IHN0b3BXYXRjaDogU3RvcFdhdGNoO1xuXG4gICAgICAgICAgICBjb25zdCBjYiA9IChlcnI6IEVyciwgLi4ucmVzdWx0czogYW55W10pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoc3RvcFdhdGNoKVxuICAgICAgICAgICAgICAgICAgICBnZXRMb2dnZXIoKS5yZXBvcnQoYFt7MH1dW0JFTkNITUFSS10gLSBMZWF2aW5nIE1ldGhvZCB7MX0gYWZ0ZXIgezJ9bXNgLCBsZXZlbCBhcyBudW1iZXIsIG5hbWUsIHByb3BlcnR5S2V5LCBzdG9wV2F0Y2guc3RvcCgpKTtcbiAgICAgICAgICAgICAgICBpZiAoZXJyKXtcbiAgICAgICAgICAgICAgICAgICAgZ2V0TG9nZ2VyKCkucmVwb3J0KGBbezB9XVtFUlJPUl0gLSBMZWF2aW5nIE1ldGhvZCB7MX0gd2l0aCBlcnJvciB7Mn1gLCBsZXZlbCBhcyBudW1iZXIsIG5hbWUsIHByb3BlcnR5S2V5LCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBnZXRMb2dnZXIoKS5yZXBvcnQoYFt7MH1dIC0gTGVhdmluZyBNZXRob2QgezF9IHdpdGggcmVzdWx0czogezJ9YCwgbGV2ZWwgYXMgbnVtYmVyLCBuYW1lLCBwcm9wZXJ0eUtleSwgcmVzdWx0cyA/IHJlc3VsdHMubWFwKGEgPT4gYS50b1N0cmluZygpKS5qb2luKCcgfCAnKSA6IFwidm9pZFwiKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh1bmRlZmluZWQsIC4uLnJlc3VsdHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYmVuY2htYXJrKXtcbiAgICAgICAgICAgICAgICBzdG9wV2F0Y2ggPSBuZXcgU3RvcFdhdGNoKCk7XG4gICAgICAgICAgICAgICAgc3RvcFdhdGNoLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG9yaWdpbmFsTWV0aG9kLmNhbGwodGhpcy5fX29yaWdpbmFsT2JqZWN0IHx8IHRoaXMsIC4uLmFyZ3MsIGNiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlc2NyaXB0b3IudmFsdWUgPSBtZXRob2RXcmFwcGVyO1xuICAgIH1cbn1cblxuLyoqXG4gKiBTeW5jIE1ldGhvZCBkZWNvcmF0b3IgdG8gbG9nIHRoZSBpbnB1dCBhbmQgb3V0cHV0IG9mIHRoYXQgbWV0aG9kXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IFtsZXZlbF0gTG9nZ2luZyBMZXZlbCBhcyBpbiB7QGxpbmsgTE9HR0VSX0xFVkVMU30gZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuREVCVUd9XG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtiZW5jaG1hcmtdIGRldGVybWluZXMgaWYgdGhlIGxvZ2dpbmcgaW5jbHVkZXMgdGhlIGR1cmF0aW9uIGluIG1zLiBkZWZhdWx0cyB0byBmYWxzZVxuICpcbiAqIEBkZWNvcmF0b3IgbG9nU3luY1xuICpcbiAqIEBjYXRlZ29yeSBEZWNvcmF0b3JzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsb2dTeW5jKGxldmVsOiBudW1iZXIgfCBib29sZWFuID0gTE9HR0VSX0xFVkVMUy5ERUJVRywgYmVuY2htYXJrPzogYm9vbGVhbikge1xuXG4gICAgaWYgKCFiZW5jaG1hcmsgJiYgdHlwZW9mIGxldmVsID09PSAnYm9vbGVhbicpe1xuICAgICAgICBiZW5jaG1hcmsgPSBsZXZlbDtcbiAgICAgICAgbGV2ZWwgPSBMT0dHRVJfTEVWRUxTLkRFQlVHO1xuICAgIH1cblxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0OiBhbnksIHByb3BlcnR5S2V5OiBzdHJpbmcsIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvcikge1xuXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcblxuICAgICAgICBjb25zdCBtZXRob2RXcmFwcGVyID0gZnVuY3Rpb24odGhpczogYW55LCAuLi5hcmdzOiBhbnlbXSl7XG4gICAgICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5uYW1lICYmIHRoaXMubmFtZSAhPT0gJ0Z1bmN0aW9uJyA/IHRoaXMubmFtZSA6IHRoaXMuY29uc3RydWN0b3IgJiYgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lIHx8IHRoaXM7XG5cbiAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChgW3swfV0gLSBFbnRlcmluZyBNZXRob2QgezF9IHdpdGggYXJnczogezJ9YCwgbGV2ZWwgYXMgbnVtYmVyLCBuYW1lLCBwcm9wZXJ0eUtleSwgYXJncy5tYXAoYSA9PiBhLnRvU3RyaW5nKCkpLmpvaW4oJyB8ICcpKTtcbiAgICAgICAgICAgIGxldCBzdG9wV2F0Y2g6IFN0b3BXYXRjaCB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgbGV0IHJlc3VsdDtcbiAgICAgICAgICAgIGlmIChiZW5jaG1hcmspe1xuICAgICAgICAgICAgICAgIHN0b3BXYXRjaCA9IG5ldyBTdG9wV2F0Y2goKTtcbiAgICAgICAgICAgICAgICBzdG9wV2F0Y2guc3RhcnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBvcmlnaW5hbE1ldGhvZC5jYWxsKHRoaXMuX19vcmlnaW5hbE9iamVjdCB8fCB0aGlzLCAuLi5hcmdzKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RvcFdhdGNoKVxuICAgICAgICAgICAgICAgICAgICBnZXRMb2dnZXIoKS5yZXBvcnQoYFt7MH1dW0JFTkNITUFSS10gLSBMZWF2aW5nIE1ldGhvZCB7MX0gYWZ0ZXIgezJ9bXNgLCBsZXZlbCBhcyBudW1iZXIsIG5hbWUsIHByb3BlcnR5S2V5LCBzdG9wV2F0Y2guc3RvcCgpKTtcbiAgICAgICAgICAgICAgICBnZXRMb2dnZXIoKS5yZXBvcnQoYFt7MH1dW0VSUk9SXSAtIExlYXZpbmcgTWV0aG9kIHsxfSB3aXRoIGVycm9yIHsyfWAsIGxldmVsIGFzIG51bWJlciwgbmFtZSwgcHJvcGVydHlLZXksIGUpO1xuICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3RvcFdhdGNoKVxuICAgICAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChgW3swfV1bQkVOQ0hNQVJLXSAtIExlYXZpbmcgTWV0aG9kIHsxfSBhZnRlciB7Mn1tc2AsIGxldmVsIGFzIG51bWJlciwgbmFtZSwgcHJvcGVydHlLZXksIHN0b3BXYXRjaC5zdG9wKCkpO1xuICAgICAgICAgICAgZ2V0TG9nZ2VyKCkucmVwb3J0KGBbezB9XSAtIExlYXZpbmcgTWV0aG9kIHsxfSB3aXRoIHJlc3VsdHM6IHsyfWAsIGxldmVsIGFzIG51bWJlciwgbmFtZSwgcHJvcGVydHlLZXksIHJlc3VsdCA/IHJlc3VsdCA6IFwidm9pZFwiKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICBkZXNjcmlwdG9yLnZhbHVlID0gbWV0aG9kV3JhcHBlcjtcbiAgICB9XG59XG4iLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9KTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19leHBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2V4cG9ydFN0YXIpIHx8IGZ1bmN0aW9uKG0sIGV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGV4cG9ydHMsIHApKSBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2NvbnN0YW50c1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vbG9nZ2luZ1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vZGVjb3JhdG9yc1wiKSwgZXhwb3J0cyk7IiwiaW1wb3J0IHtERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQsIExPR0dFUl9MRVZFTFMsIExPR0dJTkdfTVNHfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7TG9nZ2VkRXJyb3J9IGZyb20gXCIuLi9lcnJvcnNcIjtcbmltcG9ydCB7Zm9ybWF0RGF0ZSwgc3RyaW5nRm9ybWF0fSBmcm9tIFwiLi91dGlsc1wiO1xuXG4vKipcbiAqIEB0eXBlZGVmIExvZ2dlck1lc3NhZ2VcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IHR5cGUgTG9nZ2VyTWVzc2FnZSA9IEVycm9yIHwgc3RyaW5nO1xuXG4vKipcbiAqIEBpbnRlcmZhY2UgTG9nZ2VyXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyIHtcbiAgICAvKipcbiAgICAgKiBSZXBvcnRzIGEgbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbFxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHJlcG9ydChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQUxMfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIGFsbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBpbmZvKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5ERUJVR31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBkZWJ1ZyhtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICB3YXJuKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5FUlJPUn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQ1JJVElDQUx9XG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHthbnlbXX0gW2FyZ3NdXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTG9nZ2VyXG4gICAgICovXG4gICAgY3JpdGljYWwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIERlZmluZXMgdGhlIExvZ2dlciBsZXZlbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsXG4gICAgICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHNldExldmVsKGxldmVsOiBudW1iZXIsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IExvZ2dlciBJbXBsZW1lbnRhdGlvblxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZWZhdWx0TGV2ZWwgZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlVGltZXN0YW1wIGRlZmF1bHRzIHRvIHRydWVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nTGV2ZWxcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nU3RhY2tUcmFjZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpbWVzdGFtcEZvcm1hdFxuICpcbiAqIEBjbGFzcyBMb2dnZXJJbXBcbiAqIEBpbXBsZW1lbnRzIExvZ2dlclxuICovXG5leHBvcnQgY2xhc3MgTG9nZ2VySW1wIGltcGxlbWVudHMgTG9nZ2VyIHtcbiAgICBwcml2YXRlIGxldmVsOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IHVzZVRpbWVzdGFtcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxvZ0xldmVsOiBib29sZWFuO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdGltZXN0YW1wRm9ybWF0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSByZWFkb25seSBsb2dTdGFja1RyYWNlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoZGVmYXVsdExldmVsOiBudW1iZXIgPSBMT0dHRVJfTEVWRUxTLklORk8sIHVzZVRpbWVzdGFtcCA9IHRydWUsIGxvZ0xldmVsOiBib29sZWFuID0gdHJ1ZSwgbG9nU3RhY2tUcmFjZTogYm9vbGVhbiA9IGZhbHNlLCB0aW1lc3RhbXBGb3JtYXQgPSBERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQpe1xuICAgICAgICB0aGlzLmxldmVsID0gZGVmYXVsdExldmVsO1xuICAgICAgICB0aGlzLnVzZVRpbWVzdGFtcCA9IHVzZVRpbWVzdGFtcDtcbiAgICAgICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgICAgICB0aGlzLmxvZ1N0YWNrVHJhY2UgPSBsb2dTdGFja1RyYWNlO1xuICAgICAgICB0aGlzLnRpbWVzdGFtcEZvcm1hdCA9IHRpbWVzdGFtcEZvcm1hdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsdHMgdGhlIGFjdHVhbCBsb2dnaW5nIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbG9nTGV2ZWwgaWYgdGhlIGxldmVsIGlzIHRvIGJlIGxvZ2dlZFxuICAgICAqIEBwYXJhbSB7YW55fSBpc3N1ZXIgd2hvIGlzIGxvZ2dpbmcgdGhlIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBidWlsZE1lc3NhZ2UobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgbG9nTGV2ZWw6IG51bWJlciwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKXtcbiAgICAgICAgbGV0IHN0YWNrc1RyYWNlOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3Ipe1xuICAgICAgICAgICAgc3RhY2tzVHJhY2UgPSBtZXNzYWdlLnN0YWNrO1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UubWVzc2FnZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmxvZ0xldmVsKVxuICAgICAgICAgICAgbWVzc2FnZSA9IGBbJHtPYmplY3Qua2V5cyhMT0dHRVJfTEVWRUxTKVtsb2dMZXZlbF19XSAtICR7bWVzc2FnZX1gO1xuICAgICAgICBpZiAoaXNzdWVyKVxuICAgICAgICAgICAgbWVzc2FnZSA9IGBbJHtpc3N1ZXIudG9TdHJpbmcoKX1dJHttZXNzYWdlfWA7XG4gICAgICAgIGlmICh0aGlzLnVzZVRpbWVzdGFtcClcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgWyR7Zm9ybWF0RGF0ZShuZXcgRGF0ZSgpLCB0aGlzLnRpbWVzdGFtcEZvcm1hdCl9XSR7bWVzc2FnZX1gO1xuICAgICAgICByZXR1cm4gc3RyaW5nRm9ybWF0KG1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsIGRlZmF1bHRzIHRvIHtAbGluayBMT0dHRVJfTEVWRUxTLklORk99XG4gICAgICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICAgICAqL1xuICAgIHJlcG9ydChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyID0gTE9HR0VSX0xFVkVMUy5JTkZPLCAuLi5hcmdzOiBhbnlbXSkgOiB2b2lkIHtcbiAgICAgICAgaWYgKGxldmVsIDwgdGhpcy5sZXZlbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBMb2dnZWRFcnJvciAmJiBtZXNzYWdlLmxvZ2dlZClcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBsZXQgcmVwb3J0TWV0aG9kOiBGdW5jdGlvbjtcbiAgICAgICAgc3dpdGNoIChsZXZlbCl7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLndhcm47XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuQ1JJVElDQUw6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5lcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTE9HR0VSX0xFVkVMUy5JTkZPOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkRFQlVHOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5sb2c7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZmluYWxNZXNzYWdlID0gdGhpcy5idWlsZE1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIHVuZGVmaW5lZCwgLi4uYXJncyk7XG4gICAgICAgIHJlcG9ydE1ldGhvZChmaW5hbE1lc3NhZ2UpO1xuXG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IgJiYgbWVzc2FnZS5zdGFjayAmJiB0aGlzLmxvZ1N0YWNrVHJhY2Upe1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoYFxcbi0tIFN0YWNrU3RyYWNlOlxcbiR7bWVzc2FnZS5zdGFja31gLCBsZXZlbCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBMb2dnZWRFcnJvcilcbiAgICAgICAgICAgIG1lc3NhZ2UubG9nZ2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGluZm8obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5JTkZPLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBhbGwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5BTEwsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGRlYnVnKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuREVCVUcsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIHdhcm4obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5XQVJOLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkVSUk9SLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBjcml0aWNhbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBzZXRMZXZlbChsZXZlbDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGVidWcoc3RyaW5nRm9ybWF0KExPR0dJTkdfTVNHLkxFVkVMX0NIQU5HRUQsIHRoaXMubGV2ZWwudG9TdHJpbmcoKSwgbGV2ZWwudG9TdHJpbmcoKSkpO1xuICAgICAgICB0aGlzLmxldmVsID0gbGV2ZWw7XG4gICAgfVxufVxuXG5sZXQgY3VycmVudExvZ2dlcjogTG9nZ2VyO1xuXG4vKipcbiAqIGdldHMgdGhlIGN1cnJlbnQgTG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIGdldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvZ2dlcigpe1xuICAgIGlmICghY3VycmVudExvZ2dlcilcbiAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICByZXR1cm4gY3VycmVudExvZ2dlcjtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSBsb2dnZXJcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlcn0gbG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIHNldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldExvZ2dlcihsb2dnZXI6IExvZ2dlcil7XG4gICAgY3VycmVudExvZ2dlciA9IGxvZ2dlcjtcbiAgICBnZXRMb2dnZXIoKS5kZWJ1ZyhMT0dHSU5HX01TRy5MT0dHRVJfQ0hBTkdFRCk7XG59XG5cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGluZm9cbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBpbmZvID0gKG1lc3NhZ2U6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+IGdldExvZ2dlcigpLmluZm8obWVzc2FnZSwgLi4uYXJncyk7XG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLkFMTH1cbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGFsbFxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGFsbCA9IChtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiBnZXRMb2dnZXIoKS5hbGwobWVzc2FnZSwgLi4uYXJncyk7XG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLkRFQlVHfVxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gZGVidWdcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBkZWJ1ZyA9IChtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiBnZXRMb2dnZXIoKS5kZWJ1ZyhtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIHdhcm5cbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCB3YXJuID0gKG1lc3NhZ2U6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+IGdldExvZ2dlcigpLndhcm4obWVzc2FnZSwgLi4uYXJncyk7XG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLkVSUk9SfVxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gZXJyb3JcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBlcnJvciA9IChtZXNzYWdlOiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKSA9PiBnZXRMb2dnZXIoKS5lcnJvcihtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuQ1JJVElDQUx9XG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBjcml0aWNhbFxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGNyaXRpY2FsID0gKG1lc3NhZ2U6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+IGdldExvZ2dlcigpLmNyaXRpY2FsKG1lc3NhZ2UsIC4uLmFyZ3MpOyIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5jcml0aWNhbCA9IGV4cG9ydHMuZXJyb3IgPSBleHBvcnRzLndhcm4gPSBleHBvcnRzLmRlYnVnID0gZXhwb3J0cy5hbGwgPSBleHBvcnRzLmluZm8gPSBleHBvcnRzLnNldExvZ2dlciA9IGV4cG9ydHMuZ2V0TG9nZ2VyID0gZXhwb3J0cy5Mb2dnZXJJbXAgPSB2b2lkIDA7XG52YXIgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XG52YXIgZXJyb3JzXzEgPSByZXF1aXJlKFwiLi4vZXJyb3JzXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcbnZhciBMb2dnZXJJbXAgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExvZ2dlckltcChkZWZhdWx0TGV2ZWwsIHVzZVRpbWVzdGFtcCwgbG9nTGV2ZWwsIGxvZ1N0YWNrVHJhY2UsIHRpbWVzdGFtcEZvcm1hdCkge1xuICAgICAgICBpZiAoZGVmYXVsdExldmVsID09PSB2b2lkIDApIHsgZGVmYXVsdExldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOyB9XG4gICAgICAgIGlmICh1c2VUaW1lc3RhbXAgPT09IHZvaWQgMCkgeyB1c2VUaW1lc3RhbXAgPSB0cnVlOyB9XG4gICAgICAgIGlmIChsb2dMZXZlbCA9PT0gdm9pZCAwKSB7IGxvZ0xldmVsID0gdHJ1ZTsgfVxuICAgICAgICBpZiAobG9nU3RhY2tUcmFjZSA9PT0gdm9pZCAwKSB7IGxvZ1N0YWNrVHJhY2UgPSBmYWxzZTsgfVxuICAgICAgICBpZiAodGltZXN0YW1wRm9ybWF0ID09PSB2b2lkIDApIHsgdGltZXN0YW1wRm9ybWF0ID0gY29uc3RhbnRzXzEuREVGQVVMVF9USU1FU1RBTVBfRk9STUFUOyB9XG4gICAgICAgIHRoaXMubGV2ZWwgPSBkZWZhdWx0TGV2ZWw7XG4gICAgICAgIHRoaXMudXNlVGltZXN0YW1wID0gdXNlVGltZXN0YW1wO1xuICAgICAgICB0aGlzLmxvZ0xldmVsID0gbG9nTGV2ZWw7XG4gICAgICAgIHRoaXMubG9nU3RhY2tUcmFjZSA9IGxvZ1N0YWNrVHJhY2U7XG4gICAgICAgIHRoaXMudGltZXN0YW1wRm9ybWF0ID0gdGltZXN0YW1wRm9ybWF0O1xuICAgIH1cbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmJ1aWxkTWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlLCBsb2dMZXZlbCwgaXNzdWVyKSB7XG4gICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YWNrc1RyYWNlID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICBzdGFja3NUcmFjZSA9IG1lc3NhZ2Uuc3RhY2s7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5tZXNzYWdlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmxvZ0xldmVsKVxuICAgICAgICAgICAgbWVzc2FnZSA9IFwiW1wiLmNvbmNhdChPYmplY3Qua2V5cyhjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTKVtsb2dMZXZlbF0sIFwiXSAtIFwiKS5jb25jYXQobWVzc2FnZSk7XG4gICAgICAgIGlmIChpc3N1ZXIpXG4gICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KGlzc3Vlci50b1N0cmluZygpLCBcIl1cIikuY29uY2F0KG1lc3NhZ2UpO1xuICAgICAgICBpZiAodGhpcy51c2VUaW1lc3RhbXApXG4gICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KCgwLCB1dGlsc18xLmZvcm1hdERhdGUpKG5ldyBEYXRlKCksIHRoaXMudGltZXN0YW1wRm9ybWF0KSwgXCJdXCIpLmNvbmNhdChtZXNzYWdlKTtcbiAgICAgICAgcmV0dXJuIHV0aWxzXzEuc3RyaW5nRm9ybWF0LmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbbWVzc2FnZV0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLnJlcG9ydCA9IGZ1bmN0aW9uIChtZXNzYWdlLCBsZXZlbCkge1xuICAgICAgICBpZiAobGV2ZWwgPT09IHZvaWQgMCkgeyBsZXZlbCA9IGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GTzsgfVxuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGV2ZWwgPCB0aGlzLmxldmVsKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIGVycm9yc18xLkxvZ2dlZEVycm9yICYmIG1lc3NhZ2UubG9nZ2VkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgcmVwb3J0TWV0aG9kO1xuICAgICAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLndhcm47XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuQ1JJVElDQUw6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5lcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOlxuICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHOlxuICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5sb2c7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbmFsTWVzc2FnZSA9IHRoaXMuYnVpbGRNZXNzYWdlLmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGxldmVsLCB1bmRlZmluZWRdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICByZXBvcnRNZXRob2QoZmluYWxNZXNzYWdlKTtcbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBFcnJvciAmJiBtZXNzYWdlLnN0YWNrICYmIHRoaXMubG9nU3RhY2tUcmFjZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoXCJcXG4tLSBTdGFja1N0cmFjZTpcXG5cIi5jb25jYXQobWVzc2FnZS5zdGFjayksIGxldmVsKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBlcnJvcnNfMS5Mb2dnZWRFcnJvcilcbiAgICAgICAgICAgIG1lc3NhZ2UubG9nZ2VkID0gdHJ1ZTtcbiAgICB9O1xuICAgIExvZ2dlckltcC5wcm90b3R5cGUuaW5mbyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GT10sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuQUxMXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIExvZ2dlckltcC5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIExvZ2dlckltcC5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuV0FSTl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5FUlJPUl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmNyaXRpY2FsID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5DUklUSUNBTF0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLnNldExldmVsID0gZnVuY3Rpb24gKGxldmVsKSB7XG4gICAgICAgIHRoaXMuZGVidWcoKDAsIHV0aWxzXzEuc3RyaW5nRm9ybWF0KShjb25zdGFudHNfMS5MT0dHSU5HX01TRy5MRVZFTF9DSEFOR0VELCB0aGlzLmxldmVsLnRvU3RyaW5nKCksIGxldmVsLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgdGhpcy5sZXZlbCA9IGxldmVsO1xuICAgIH07XG4gICAgcmV0dXJuIExvZ2dlckltcDtcbn0oKSk7XG5leHBvcnRzLkxvZ2dlckltcCA9IExvZ2dlckltcDtcbnZhciBjdXJyZW50TG9nZ2VyO1xuZnVuY3Rpb24gZ2V0TG9nZ2VyKCkge1xuICAgIGlmICghY3VycmVudExvZ2dlcilcbiAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICByZXR1cm4gY3VycmVudExvZ2dlcjtcbn1cbmV4cG9ydHMuZ2V0TG9nZ2VyID0gZ2V0TG9nZ2VyO1xuZnVuY3Rpb24gc2V0TG9nZ2VyKGxvZ2dlcikge1xuICAgIGN1cnJlbnRMb2dnZXIgPSBsb2dnZXI7XG4gICAgZ2V0TG9nZ2VyKCkuZGVidWcoY29uc3RhbnRzXzEuTE9HR0lOR19NU0cuTE9HR0VSX0NIQU5HRUQpO1xufVxuZXhwb3J0cy5zZXRMb2dnZXIgPSBzZXRMb2dnZXI7XG52YXIgaW5mbyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS5pbmZvLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLmluZm8gPSBpbmZvO1xudmFyIGFsbCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS5hbGwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xufTtcbmV4cG9ydHMuYWxsID0gYWxsO1xudmFyIGRlYnVnID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB2YXIgX2E7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKF9hID0gZ2V0TG9nZ2VyKCkpLmRlYnVnLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLmRlYnVnID0gZGVidWc7XG52YXIgd2FybiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS53YXJuLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLndhcm4gPSB3YXJuO1xudmFyIGVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB2YXIgX2E7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKF9hID0gZ2V0TG9nZ2VyKCkpLmVycm9yLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLmVycm9yID0gZXJyb3I7XG52YXIgY3JpdGljYWwgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIHZhciBfYTtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiAoX2EgPSBnZXRMb2dnZXIoKSkuY3JpdGljYWwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xufTtcbmV4cG9ydHMuY3JpdGljYWwgPSBjcml0aWNhbDsiLCIvKipcbiAqIEBuYW1lc3BhY2UgbG9nZ2luZy5sb2dnaW5nXG4gKiBAbWVtYmVyT2YgbG9nZ2luZ1xuICovXG5cbmV4cG9ydCAqIGZyb20gJy4vY29uc3RhbnRzJztcbmV4cG9ydCAqIGZyb20gJy4vbG9nZ2luZyc7XG5leHBvcnQgKiBmcm9tICcuL2RlY29yYXRvcnMnOyIsIi8qKlxuICogVXRpbCBmdW5jdGlvbiB0byBwcm92aWRlIHN0cmluZyBmb3JtYXQgZnVuY3Rpb25hbGl0eSBzaW1pbGFyIHRvIEMjJ3Mgc3RyaW5nLmZvcm1hdFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBzdHJpbmdcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcmdzIHJlcGxhY2VtZW50cyBtYWRlIGJ5IG9yZGVyIG9mIGFwcGVhcmFuY2UgKHJlcGxhY2VtZW50MCB3aWwgcmVwbGFjZSB7MH0gYW5kIHNvIG9uKVxuICogQHJldHVybiB7c3RyaW5nfSBmb3JtYXR0ZWQgc3RyaW5nXG4gKlxuICogQGZ1bmN0aW9uIHN0cmluZ0Zvcm1hdFxuICpcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuaW1wb3J0IHtEQVlTX09GX1dFRUtfTkFNRVMsIE1PTlRIX05BTUVTfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHN0cmluZ0Zvcm1hdChzdHJpbmc6IHN0cmluZywgLi4uYXJnczogc3RyaW5nW10pe1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgveyhcXGQrKX0vZywgZnVuY3Rpb24obWF0Y2gsIG51bWJlcikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGFyZ3NbbnVtYmVyXSAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgID8gYXJnc1tudW1iZXJdXG4gICAgICAgICAgICA6IG1hdGNoO1xuICAgIH0pO1xufVxuXG4vKipcbiAqIERhdGUgRm9ybWF0IEhhbmRsaW5nXG4gKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8zNTUyNDYxL2hvdy10by1mb3JtYXQtYS1qYXZhc2NyaXB0LWRhdGVcbiAqXG4gKiA8cHJlPlxuICogICAgICBVc2luZyBzaW1pbGFyIGZvcm1hdHRpbmcgYXMgTW9tZW50LmpzLCBDbGFzcyBEYXRlVGltZUZvcm1hdHRlciAoSmF2YSksIGFuZCBDbGFzcyBTaW1wbGVEYXRlRm9ybWF0IChKYXZhKSxcbiAqICAgICAgSSBpbXBsZW1lbnRlZCBhIGNvbXByZWhlbnNpdmUgc29sdXRpb24gZm9ybWF0RGF0ZShkYXRlLCBwYXR0ZXJuU3RyKSB3aGVyZSB0aGUgY29kZSBpcyBlYXN5IHRvIHJlYWQgYW5kIG1vZGlmeS5cbiAqICAgICAgWW91IGNhbiBkaXNwbGF5IGRhdGUsIHRpbWUsIEFNL1BNLCBldGMuXG4gKlxuICogICAgICBEYXRlIGFuZCBUaW1lIFBhdHRlcm5zXG4gKiAgICAgIHl5ID0gMi1kaWdpdCB5ZWFyOyB5eXl5ID0gZnVsbCB5ZWFyXG4gKiAgICAgIE0gPSBkaWdpdCBtb250aDsgTU0gPSAyLWRpZ2l0IG1vbnRoOyBNTU0gPSBzaG9ydCBtb250aCBuYW1lOyBNTU1NID0gZnVsbCBtb250aCBuYW1lXG4gKiAgICAgIEVFRUUgPSBmdWxsIHdlZWtkYXkgbmFtZTsgRUVFID0gc2hvcnQgd2Vla2RheSBuYW1lXG4gKiAgICAgIGQgPSBkaWdpdCBkYXk7IGRkID0gMi1kaWdpdCBkYXlcbiAqICAgICAgaCA9IGhvdXJzIGFtL3BtOyBoaCA9IDItZGlnaXQgaG91cnMgYW0vcG07IEggPSBob3VyczsgSEggPSAyLWRpZ2l0IGhvdXJzXG4gKiAgICAgIG0gPSBtaW51dGVzOyBtbSA9IDItZGlnaXQgbWludXRlczsgYWFhID0gQU0vUE1cbiAqICAgICAgcyA9IHNlY29uZHM7IHNzID0gMi1kaWdpdCBzZWNvbmRzXG4gKiAgICAgIFMgPSBtaWxpc2Vjb25kc1xuICogPC9wcmU+XG4gKlxuICogQHBhcmFtIHtEYXRlfSBkYXRlXG4gKiBAcGFyYW0ge3N0cmluZ30gW3BhdHRlcm5TdHJdIGRlZmF1bHRzIHRvICd5eXl5L01NL2RkJ1xuICogQHJldHVybiB7c3RyaW5nfSB0aGUgZm9ybWF0dGVkIGRhdGVcbiAqXG4gKiBAZnVuY3Rpb24gZm9ybWF0RGF0ZVxuICpcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZTogRGF0ZSwgcGF0dGVyblN0cjogc3RyaW5nID0gJ3l5eXkvTU0vZGQnKXtcbiAgICBjb25zdCBkYXk6IG51bWJlciA9IGRhdGUuZ2V0RGF0ZSgpLFxuICAgICAgICBtb250aDogbnVtYmVyID0gZGF0ZS5nZXRNb250aCgpLFxuICAgICAgICB5ZWFyOiBudW1iZXIgPSBkYXRlLmdldEZ1bGxZZWFyKCksXG4gICAgICAgIGhvdXI6IG51bWJlciA9IGRhdGUuZ2V0SG91cnMoKSxcbiAgICAgICAgbWludXRlOiBudW1iZXIgPSBkYXRlLmdldE1pbnV0ZXMoKSxcbiAgICAgICAgc2Vjb25kOiBudW1iZXIgPSBkYXRlLmdldFNlY29uZHMoKSxcbiAgICAgICAgbWlsaXNlY29uZHM6IG51bWJlciA9IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCksXG4gICAgICAgIGg6IG51bWJlciA9IGhvdXIgJSAxMixcbiAgICAgICAgaGg6IHN0cmluZyA9IHR3b0RpZ2l0UGFkKGgpLFxuICAgICAgICBISDogc3RyaW5nID0gdHdvRGlnaXRQYWQoaG91ciksXG4gICAgICAgIG1tOiBzdHJpbmcgPSB0d29EaWdpdFBhZChtaW51dGUpLFxuICAgICAgICBzczogc3RyaW5nID0gdHdvRGlnaXRQYWQoc2Vjb25kKSxcbiAgICAgICAgYWFhOiBzdHJpbmcgPSBob3VyIDwgMTIgPyAnQU0nIDogJ1BNJyxcbiAgICAgICAgRUVFRTogc3RyaW5nID0gREFZU19PRl9XRUVLX05BTUVTW2RhdGUuZ2V0RGF5KCldLFxuICAgICAgICBFRUU6IHN0cmluZyA9IEVFRUUuc3Vic3RyKDAsIDMpLFxuICAgICAgICBkZDogc3RyaW5nID0gdHdvRGlnaXRQYWQoZGF5KSxcbiAgICAgICAgTTogbnVtYmVyID0gbW9udGggKyAxLFxuICAgICAgICBNTTogc3RyaW5nID0gdHdvRGlnaXRQYWQoTSksXG4gICAgICAgIE1NTU06IHN0cmluZyA9IE1PTlRIX05BTUVTW21vbnRoXSxcbiAgICAgICAgTU1NIDogc3RyaW5nPSBNTU1NLnN1YnN0cigwLCAzKSxcbiAgICAgICAgeXl5eTogc3RyaW5nID0geWVhciArIFwiXCIsXG4gICAgICAgIHl5OiBzdHJpbmcgPSB5eXl5LnN1YnN0cigyLCAyKVxuICAgIDtcbiAgICAvLyBjaGVja3MgdG8gc2VlIGlmIG1vbnRoIG5hbWUgd2lsbCBiZSB1c2VkXG4gICAgcGF0dGVyblN0ciA9IHBhdHRlcm5TdHJcbiAgICAgICAgLnJlcGxhY2UoJ2hoJywgaGgpLnJlcGxhY2UoJ2gnLCBoLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdISCcsIEhIKS5yZXBsYWNlKCdIJywgaG91ci50b1N0cmluZygpKVxuICAgICAgICAucmVwbGFjZSgnbW0nLCBtbSkucmVwbGFjZSgnbScsIG1pbnV0ZS50b1N0cmluZygpKVxuICAgICAgICAucmVwbGFjZSgnc3MnLCBzcykucmVwbGFjZSgncycsIHNlY29uZC50b1N0cmluZygpKVxuICAgICAgICAucmVwbGFjZSgnUycsIG1pbGlzZWNvbmRzLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdkZCcsIGRkKS5yZXBsYWNlKCdkJywgZGF5LnRvU3RyaW5nKCkpXG5cbiAgICAgICAgLnJlcGxhY2UoJ0VFRUUnLCBFRUVFKS5yZXBsYWNlKCdFRUUnLCBFRUUpXG4gICAgICAgIC5yZXBsYWNlKCd5eXl5JywgeXl5eSlcbiAgICAgICAgLnJlcGxhY2UoJ3l5JywgeXkpXG4gICAgICAgIC5yZXBsYWNlKCdhYWEnLCBhYWEpO1xuICAgIGlmIChwYXR0ZXJuU3RyLmluZGV4T2YoJ01NTScpID4gLTEpIHtcbiAgICAgICAgcGF0dGVyblN0ciA9IHBhdHRlcm5TdHJcbiAgICAgICAgICAgIC5yZXBsYWNlKCdNTU1NJywgTU1NTSlcbiAgICAgICAgICAgIC5yZXBsYWNlKCdNTU0nLCBNTU0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcGF0dGVyblN0ciA9IHBhdHRlcm5TdHJcbiAgICAgICAgICAgIC5yZXBsYWNlKCdNTScsIE1NKVxuICAgICAgICAgICAgLnJlcGxhY2UoJ00nLCBNLnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICByZXR1cm4gcGF0dGVyblN0cjtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IG51bVxuICpcbiAqIEByZXR1cm4ge3N0cmluZ31cbiAqXG4gKiBAZnVuY3Rpb24gdHdvRGlnaXRQYWRcbiAqXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0d29EaWdpdFBhZChudW06IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIG51bSA8IDEwID8gXCIwXCIgKyBudW0gOiBudW0udG9TdHJpbmcoKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMudHdvRGlnaXRQYWQgPSBleHBvcnRzLmZvcm1hdERhdGUgPSBleHBvcnRzLnN0cmluZ0Zvcm1hdCA9IHZvaWQgMDtcbnZhciBjb25zdGFudHNfMSA9IHJlcXVpcmUoXCIuL2NvbnN0YW50c1wiKTtcbmZ1bmN0aW9uIHN0cmluZ0Zvcm1hdChzdHJpbmcpIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgveyhcXGQrKX0vZywgZnVuY3Rpb24gKG1hdGNoLCBudW1iZXIpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBhcmdzW251bWJlcl0gIT09ICd1bmRlZmluZWQnXG4gICAgICAgICAgICA/IGFyZ3NbbnVtYmVyXVxuICAgICAgICAgICAgOiBtYXRjaDtcbiAgICB9KTtcbn1cbmV4cG9ydHMuc3RyaW5nRm9ybWF0ID0gc3RyaW5nRm9ybWF0O1xuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlLCBwYXR0ZXJuU3RyKSB7XG4gICAgaWYgKHBhdHRlcm5TdHIgPT09IHZvaWQgMCkgeyBwYXR0ZXJuU3RyID0gJ3l5eXkvTU0vZGQnOyB9XG4gICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF0ZSgpLCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKSwgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKSwgaG91ciA9IGRhdGUuZ2V0SG91cnMoKSwgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCksIHNlY29uZCA9IGRhdGUuZ2V0U2Vjb25kcygpLCBtaWxpc2Vjb25kcyA9IGRhdGUuZ2V0TWlsbGlzZWNvbmRzKCksIGggPSBob3VyICUgMTIsIGhoID0gdHdvRGlnaXRQYWQoaCksIEhIID0gdHdvRGlnaXRQYWQoaG91ciksIG1tID0gdHdvRGlnaXRQYWQobWludXRlKSwgc3MgPSB0d29EaWdpdFBhZChzZWNvbmQpLCBhYWEgPSBob3VyIDwgMTIgPyAnQU0nIDogJ1BNJywgRUVFRSA9IGNvbnN0YW50c18xLkRBWVNfT0ZfV0VFS19OQU1FU1tkYXRlLmdldERheSgpXSwgRUVFID0gRUVFRS5zdWJzdHIoMCwgMyksIGRkID0gdHdvRGlnaXRQYWQoZGF5KSwgTSA9IG1vbnRoICsgMSwgTU0gPSB0d29EaWdpdFBhZChNKSwgTU1NTSA9IGNvbnN0YW50c18xLk1PTlRIX05BTUVTW21vbnRoXSwgTU1NID0gTU1NTS5zdWJzdHIoMCwgMyksIHl5eXkgPSB5ZWFyICsgXCJcIiwgeXkgPSB5eXl5LnN1YnN0cigyLCAyKTtcbiAgICBwYXR0ZXJuU3RyID0gcGF0dGVyblN0clxuICAgICAgICAucmVwbGFjZSgnaGgnLCBoaCkucmVwbGFjZSgnaCcsIGgudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ0hIJywgSEgpLnJlcGxhY2UoJ0gnLCBob3VyLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdtbScsIG1tKS5yZXBsYWNlKCdtJywgbWludXRlLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdzcycsIHNzKS5yZXBsYWNlKCdzJywgc2Vjb25kLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdTJywgbWlsaXNlY29uZHMudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ2RkJywgZGQpLnJlcGxhY2UoJ2QnLCBkYXkudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ0VFRUUnLCBFRUVFKS5yZXBsYWNlKCdFRUUnLCBFRUUpXG4gICAgICAgIC5yZXBsYWNlKCd5eXl5JywgeXl5eSlcbiAgICAgICAgLnJlcGxhY2UoJ3l5JywgeXkpXG4gICAgICAgIC5yZXBsYWNlKCdhYWEnLCBhYWEpO1xuICAgIGlmIChwYXR0ZXJuU3RyLmluZGV4T2YoJ01NTScpID4gLTEpIHtcbiAgICAgICAgcGF0dGVyblN0ciA9IHBhdHRlcm5TdHJcbiAgICAgICAgICAgIC5yZXBsYWNlKCdNTU1NJywgTU1NTSlcbiAgICAgICAgICAgIC5yZXBsYWNlKCdNTU0nLCBNTU0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcGF0dGVyblN0ciA9IHBhdHRlcm5TdHJcbiAgICAgICAgICAgIC5yZXBsYWNlKCdNTScsIE1NKVxuICAgICAgICAgICAgLnJlcGxhY2UoJ00nLCBNLnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICByZXR1cm4gcGF0dGVyblN0cjtcbn1cbmV4cG9ydHMuZm9ybWF0RGF0ZSA9IGZvcm1hdERhdGU7XG5mdW5jdGlvbiB0d29EaWdpdFBhZChudW0pIHtcbiAgICByZXR1cm4gbnVtIDwgMTAgPyBcIjBcIiArIG51bSA6IG51bS50b1N0cmluZygpO1xufVxuZXhwb3J0cy50d29EaWdpdFBhZCA9IHR3b0RpZ2l0UGFkOyJdfQ==
