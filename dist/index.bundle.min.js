"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(t,r,e,o){void 0===o&&(o=e),Object.defineProperty(t,o,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,o){t[o=void 0===o?e:o]=r[e]}),__exportStar=this&&this.__exportStar||function(t,r){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(r,e)||__createBinding(r,t,e)},__extends=(Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(require("./errors"),exports),__exportStar(require("./logging"),exports),this&&this.__extends||function(){var o=function(t,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function e(){this.constructor=t}o(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}}()),logging_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.CriticalError=exports.LoggedError=exports.criticalCallback=exports.errorCallback=exports.warningCallback=exports.infoCallback=exports.debugCallback=exports.allCallback=exports.loggedCallback=void 0,require("../logging"));function loggedCallback(t,r,e){e||(e=r,r=logging_1.LOGGER_LEVELS.INFO),(0,logging_1.getLogger)().report(t instanceof Error?t:new LoggedError(t),r,"loggedCallback"!==this.name?this:void 0),e(t)}function allCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.ALL,r)}function debugCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.DEBUG,r)}function infoCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.INFO,r)}function warningCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.WARN,r)}function errorCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.ERROR,r)}function criticalCallback(t,r){loggedCallback.call(this,t,logging_1.LOGGER_LEVELS.CRITICAL,r)}exports.loggedCallback=loggedCallback,exports.allCallback=allCallback,exports.debugCallback=debugCallback,exports.infoCallback=infoCallback,exports.warningCallback=warningCallback,exports.errorCallback=errorCallback,exports.criticalCallback=criticalCallback;var LoggedError=function(o){function n(t,r){void 0===r&&(r=logging_1.LOGGER_LEVELS.ERROR);var e=o.call(this,t instanceof Error?t.message:t)||this;return e.logged=!1,e.logged=t instanceof n&&t.logged,e.logged||(0,logging_1.getLogger)().report(t,r),e}return __extends(n,o),n}(Error),CriticalError=function(r){function t(t){return r.call(this,t,logging_1.LOGGER_LEVELS.CRITICAL)||this}return __extends(t,r),t}(exports.LoggedError=LoggedError),__createBinding=(exports.CriticalError=CriticalError,this&&this.__createBinding||(Object.create?function(t,r,e,o){void 0===o&&(o=e),Object.defineProperty(t,o,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,o){t[o=void 0===o?e:o]=r[e]})),__exportStar=this&&this.__exportStar||function(t,r){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(r,e)||__createBinding(r,t,e)},__spreadArray=(Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(require("./errors"),exports),Object.defineProperty(exports,"__esModule",{value:!0}),exports.DAYS_OF_WEEK_NAMES=exports.MONTH_NAMES=exports.DEFAULT_TIMESTAMP_FORMAT=exports.LOGGING_MSG=exports.LOGGER_LEVELS=void 0,exports.LOGGER_LEVELS={ALL:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,CRITICAL:5},exports.LOGGING_MSG={LEVEL_CHANGED:"Logger Level changed from {0} to {1}",LOGGER_CHANGED:"Logger changed"},exports.DEFAULT_TIMESTAMP_FORMAT="dd/MM/yyyy HH:mm:ss:S",exports.MONTH_NAMES=["January","February","March","April","May","June","July","August","September","October","November","December"],exports.DAYS_OF_WEEK_NAMES=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this&&this.__spreadArray||function(t,r,e){if(e||2===arguments.length)for(var o,n=0,a=r.length;n<a;n++)!o&&n in r||((o=o||Array.prototype.slice.call(r,0,n))[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}),errors_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.logSync=exports.logAsync=exports.StopWatch=void 0,require("../errors")),logging_1=require("./logging"),constants_1=require("./constants"),StopWatch=function(){function t(){}return t.prototype.start=function(){this.startTime=Date.now()},t.prototype.check=function(){if(!this.startTime)throw new Error("StopWatch didnt start");return Date.now()-this.startTime},t.prototype.stop=function(){var t=this.check();return this.startTime=void 0,t},t}();function logAsync(s,g){return void 0===s&&(s=constants_1.LOGGER_LEVELS.DEBUG),g||"boolean"!=typeof s||(g=s,s=constants_1.LOGGER_LEVELS.DEBUG),function(t,i,r){var e=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=t.pop();if(!o||"function"!=typeof o)throw new errors_1.CriticalError("Missing Callback");var n,a=this.name&&"Function"!==this.name?this.name:this.constructor&&this.constructor.name||this;(0,logging_1.getLogger)().report("[{0}] - Entering Method {1} with args: {2}",s,a,i,t.map(function(t){return t.toString()}).join(" | "));g&&(n=new StopWatch).start(),e.call.apply(e,__spreadArray(__spreadArray([this.__originalObject||this],t,!1),[function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];if(n&&(0,logging_1.getLogger)().report("[{0}][BENCHMARK] - Leaving Method {1} after {2}ms",s,a,i,n.stop()),t)return(0,logging_1.getLogger)().report("[{0}][ERROR] - Leaving Method {1} with error {2}",s,a,i,t),o(t);(0,logging_1.getLogger)().report("[{0}] - Leaving Method {1} with results: {2}",s,a,i,r?r.map(function(t){return t.toString()}).join(" | "):"void"),o.apply(void 0,__spreadArray([void 0],r,!1))}],!1))}}}function logSync(s,g){return void 0===s&&(s=constants_1.LOGGER_LEVELS.DEBUG),g||"boolean"!=typeof s||(g=s,s=constants_1.LOGGER_LEVELS.DEBUG),function(t,a,r){var i=r.value;r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e,o=this.name&&"Function"!==this.name?this.name:this.constructor&&this.constructor.name||this,n=((0,logging_1.getLogger)().report("[{0}] - Entering Method {1} with args: {2}",s,o,a,t.map(function(t){return t.toString()}).join(" | ")),void 0);g&&(n=new StopWatch).start();try{e=i.call.apply(i,__spreadArray([this.__originalObject||this],t,!1))}catch(t){throw n&&(0,logging_1.getLogger)().report("[{0}][BENCHMARK] - Leaving Method {1} after {2}ms",s,o,a,n.stop()),(0,logging_1.getLogger)().report("[{0}][ERROR] - Leaving Method {1} with error {2}",s,o,a,t),t}return n&&(0,logging_1.getLogger)().report("[{0}][BENCHMARK] - Leaving Method {1} after {2}ms",s,o,a,n.stop()),(0,logging_1.getLogger)().report("[{0}] - Leaving Method {1} with results: {2}",s,o,a,e||"void"),e}}}exports.StopWatch=StopWatch,exports.logAsync=logAsync,exports.logSync=logSync;var currentLogger,__createBinding=this&&this.__createBinding||(Object.create?function(t,r,e,o){void 0===o&&(o=e),Object.defineProperty(t,o,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,o){t[o=void 0===o?e:o]=r[e]}),__exportStar=this&&this.__exportStar||function(t,r){for(var e in t)"default"===e||Object.prototype.hasOwnProperty.call(r,e)||__createBinding(r,t,e)},__spreadArray=(Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(require("./constants"),exports),__exportStar(require("./logging"),exports),__exportStar(require("./decorators"),exports),__exportStar(require("./utils"),exports),this&&this.__spreadArray||function(t,r,e){if(e||2===arguments.length)for(var o,n=0,a=r.length;n<a;n++)!o&&n in r||((o=o||Array.prototype.slice.call(r,0,n))[n]=r[n]);return t.concat(o||Array.prototype.slice.call(r))}),constants_1=(Object.defineProperty(exports,"__esModule",{value:!0}),exports.critical=exports.error=exports.warn=exports.debug=exports.all=exports.info=exports.setLogger=exports.getLogger=exports.LoggerImp=void 0,require("./constants")),errors_1=require("../errors"),utils_1=require("./utils"),LoggerImp=function(){function t(t,r,e,o,n){void 0===t&&(t=constants_1.LOGGER_LEVELS.INFO),void 0===r&&(r=!0),void 0===e&&(e=!0),void 0===o&&(o=!1),void 0===n&&(n=constants_1.DEFAULT_TIMESTAMP_FORMAT),this.level=t,this.useTimestamp=r,this.logLevel=e,this.logStackTrace=o,this.timestampFormat=n}return t.prototype.buildMessage=function(t,r,e){void 0===e&&(e=void 0);for(var o=[],n=3;n<arguments.length;n++)o[n-3]=arguments[n];return t instanceof Error&&(t.stack,t=t.message),this.logLevel&&(t="[".concat(Object.keys(constants_1.LOGGER_LEVELS)[r],"] - ").concat(t)),e&&(t="[".concat(e.toString(),"]").concat(t)),this.useTimestamp&&(t="[".concat((0,utils_1.formatDate)(new Date,this.timestampFormat),"]").concat(t)),utils_1.stringFormat.apply(void 0,__spreadArray([t],o,!1))},t.prototype.report=function(t,r){void 0===r&&(r=constants_1.LOGGER_LEVELS.INFO);for(var e,o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];if(!(r<this.level||t instanceof errors_1.LoggedError&&t.logged)){switch(r){case constants_1.LOGGER_LEVELS.WARN:e=console.warn;break;case constants_1.LOGGER_LEVELS.ERROR:case constants_1.LOGGER_LEVELS.CRITICAL:e=console.error;break;case constants_1.LOGGER_LEVELS.INFO:case constants_1.LOGGER_LEVELS.DEBUG:case constants_1.LOGGER_LEVELS.ALL:default:e=console.log}e(this.buildMessage.apply(this,__spreadArray([t,r,void 0],o,!1))),t instanceof Error&&t.stack&&this.logStackTrace&&(console.log(t),e(this.buildMessage("\n-- StackStrace:\n".concat(t.stack),r))),t instanceof errors_1.LoggedError&&(t.logged=!0)}},t.prototype.info=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.INFO],r,!1))},t.prototype.all=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.ALL],r,!1))},t.prototype.debug=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.DEBUG],r,!1))},t.prototype.warn=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.WARN],r,!1))},t.prototype.error=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.ERROR],r,!1))},t.prototype.critical=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];this.report.apply(this,__spreadArray([t,constants_1.LOGGER_LEVELS.CRITICAL],r,!1))},t.prototype.setLevel=function(t){this.debug((0,utils_1.stringFormat)(constants_1.LOGGING_MSG.LEVEL_CHANGED,this.level.toString(),t.toString())),this.level=t},t}();function getLogger(){return currentLogger=currentLogger||new LoggerImp}function setLogger(t){currentLogger=t,getLogger().debug(constants_1.LOGGING_MSG.LOGGER_CHANGED)}exports.LoggerImp=LoggerImp,exports.getLogger=getLogger,exports.setLogger=setLogger;var info=function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).info.apply(r,__spreadArray([t],e,!1))},all=(exports.info=info,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).all.apply(r,__spreadArray([t],e,!1))}),debug=(exports.all=all,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).debug.apply(r,__spreadArray([t],e,!1))}),warn=(exports.debug=debug,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).warn.apply(r,__spreadArray([t],e,!1))}),error=(exports.warn=warn,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).error.apply(r,__spreadArray([t],e,!1))}),critical=(exports.error=error,function(t){for(var r,e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return(r=getLogger()).critical.apply(r,__spreadArray([t],e,!1))}),constants_1=(exports.critical=critical,Object.defineProperty(exports,"__esModule",{value:!0}),exports.twoDigitPad=exports.formatDate=exports.stringFormat=void 0,require("./constants"));function stringFormat(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.replace(/{(\d+)}/g,function(t,r){return void 0!==e[r]?e[r]:t})}function formatDate(t,r){void 0===r&&(r="yyyy/MM/dd");var e=t.getDate(),o=t.getMonth(),n=t.getFullYear(),a=t.getHours(),i=t.getMinutes(),s=t.getSeconds(),l=t.getMilliseconds(),g=a%12,p=twoDigitPad(g),_=twoDigitPad(a),u=twoDigitPad(i),d=twoDigitPad(s),L=a<12?"AM":"PM",t=constants_1.DAYS_OF_WEEK_NAMES[t.getDay()],E=t.substr(0,3),f=twoDigitPad(e),c=o+1,h=twoDigitPad(c),o=constants_1.MONTH_NAMES[o],y=o.substr(0,3),n=n+"",v=n.substr(2,2);return r=-1<(r=r.replace("hh",p).replace("h",g.toString()).replace("HH",_).replace("H",a.toString()).replace("mm",u).replace("m",i.toString()).replace("ss",d).replace("s",s.toString()).replace("S",l.toString()).replace("dd",f).replace("d",e.toString()).replace("EEEE",t).replace("EEE",E).replace("yyyy",n).replace("yy",v).replace("aaa",L)).indexOf("MMM")?r.replace("MMMM",o).replace("MMM",y):r.replace("MM",h).replace("M",c.toString())}function twoDigitPad(t){return t<10?"0"+t:t.toString()}exports.stringFormat=stringFormat,exports.formatDate=formatDate,exports.twoDigitPad=twoDigitPad;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIiwiZXJyb3JzL2Vycm9ycy5qcyIsImluZGV4LnRzIiwiZXJyb3JzL2Vycm9ycy50cyIsImVycm9ycy9pbmRleC5qcyIsImxvZ2dpbmcvZGVjb3JhdG9ycy5qcyIsImVycm9ycy9pbmRleC50cyIsImxvZ2dpbmcvY29uc3RhbnRzLmpzIiwibG9nZ2luZy9jb25zdGFudHMudHMiLCJsb2dnaW5nL2RlY29yYXRvcnMudHMiLCJsb2dnaW5nL2luZGV4LmpzIiwibG9nZ2luZy9sb2dnaW5nLnRzIiwibG9nZ2luZy9sb2dnaW5nLmpzIiwibG9nZ2luZy9pbmRleC50cyIsImxvZ2dpbmcvdXRpbHMudHMiLCJsb2dnaW5nL3V0aWxzLmpzIl0sIm5hbWVzIjpbIl9fY3JlYXRlQmluZGluZyIsInRoaXMiLCJPYmplY3QiLCJjcmVhdGUiLCJvIiwibSIsImsiLCJrMiIsInVuZGVmaW5lZCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIl9fZXhwb3J0U3RhciIsImV4cG9ydHMiLCJwIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX19leHRlbmRzIiwidmFsdWUiLCJyZXF1aXJlIiwiZXh0ZW5kU3RhdGljcyIsImQiLCJiIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJBcnJheSIsIlR5cGVFcnJvciIsIlN0cmluZyIsIl9fIiwiY29uc3RydWN0b3IiLCJsb2dnaW5nXzEiLCJDcml0aWNhbEVycm9yIiwiTG9nZ2VkRXJyb3IiLCJjcml0aWNhbENhbGxiYWNrIiwiZXJyb3JDYWxsYmFjayIsIndhcm5pbmdDYWxsYmFjayIsImluZm9DYWxsYmFjayIsImRlYnVnQ2FsbGJhY2siLCJhbGxDYWxsYmFjayIsImxvZ2dlZENhbGxiYWNrIiwibWVzc2FnZSIsImxldmVsIiwiY2FsbGJhY2siLCJMT0dHRVJfTEVWRUxTIiwiSU5GTyIsImdldExvZ2dlciIsInJlcG9ydCIsIkVycm9yIiwibmFtZSIsIkFMTCIsIkRFQlVHIiwiV0FSTiIsIkVSUk9SIiwiQ1JJVElDQUwiLCJfc3VwZXIiLCJlcnJvciIsIl90aGlzIiwibG9nZ2VkIiwiX19zcHJlYWRBcnJheSIsIkRBWVNfT0ZfV0VFS19OQU1FUyIsIk1PTlRIX05BTUVTIiwiREVGQVVMVF9USU1FU1RBTVBfRk9STUFUIiwiTE9HR0lOR19NU0ciLCJMRVZFTF9DSEFOR0VEIiwiTE9HR0VSX0NIQU5HRUQiLCJ0byIsImZyb20iLCJwYWNrIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiYXIiLCJpIiwibCIsInNsaWNlIiwiY29uY2F0IiwiZXJyb3JzXzEiLCJsb2dTeW5jIiwibG9nQXN5bmMiLCJTdG9wV2F0Y2giLCJjb25zdGFudHNfMSIsInN0YXJ0Iiwic3RhcnRUaW1lIiwiRGF0ZSIsIm5vdyIsImNoZWNrIiwic3RvcCIsInJlc3VsdCIsImJlbmNobWFyayIsInRhcmdldCIsInByb3BlcnR5S2V5IiwiZGVzY3JpcHRvciIsIm9yaWdpbmFsTWV0aG9kIiwiYXJncyIsIl9pIiwicG9wIiwic3RvcFdhdGNoIiwibWFwIiwiYSIsInRvU3RyaW5nIiwiam9pbiIsImFwcGx5IiwiX19vcmlnaW5hbE9iamVjdCIsImVyciIsInJlc3VsdHMiLCJlIiwiY3VycmVudExvZ2dlciIsImNyaXRpY2FsIiwid2FybiIsImRlYnVnIiwiYWxsIiwiaW5mbyIsInNldExvZ2dlciIsIkxvZ2dlckltcCIsInV0aWxzXzEiLCJkZWZhdWx0TGV2ZWwiLCJ1c2VUaW1lc3RhbXAiLCJsb2dMZXZlbCIsImxvZ1N0YWNrVHJhY2UiLCJ0aW1lc3RhbXBGb3JtYXQiLCJidWlsZE1lc3NhZ2UiLCJpc3N1ZXIiLCJzdGFjayIsImtleXMiLCJmb3JtYXREYXRlIiwic3RyaW5nRm9ybWF0IiwicmVwb3J0TWV0aG9kIiwiY29uc29sZSIsImxvZyIsInNldExldmVsIiwibG9nZ2VyIiwiX2EiLCJ0d29EaWdpdFBhZCIsInN0cmluZyIsInJlcGxhY2UiLCJtYXRjaCIsIm51bWJlciIsImRhdGUiLCJwYXR0ZXJuU3RyIiwiZGF5IiwiZ2V0RGF0ZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJob3VyIiwiZ2V0SG91cnMiLCJtaW51dGUiLCJnZXRNaW51dGVzIiwic2Vjb25kIiwiZ2V0U2Vjb25kcyIsIm1pbGlzZWNvbmRzIiwiZ2V0TWlsbGlzZWNvbmRzIiwiaCIsImhoIiwiSEgiLCJtbSIsInNzIiwiYWFhIiwiRUVFRSIsImdldERheSIsIkVFRSIsInN1YnN0ciIsImRkIiwiTSIsIk1NIiwiTU1NTSIsIk1NTSIsInl5eXkiLCJ5eSIsImluZGV4T2YiLCJudW0iXSwibWFwcGluZ3MiOiJhQUNBLElBQUlBLGdCQUFtQkMsTUFBUUEsS0FBS0Qsa0JBQXFCRSxPQUFPQyxPQUFVLFNBQVNDLEVBQUdDLEVBQUdDLEVBQUdDLFFBQzdFQyxJQUFQRCxJQUFrQkEsRUFBS0QsR0FDM0JKLE9BQU9PLGVBQWVMLEVBQUdHLEVBQUksQ0FBRUcsWUFBWSxFQUFNQyxJQUFLLFdBQWEsT0FBT04sRUFBRUMsT0FDMUUsU0FBU0YsRUFBR0MsRUFBR0MsRUFBR0MsR0FFcEJILEVBRHNCRyxPQUFYQyxJQUFQRCxFQUF1QkQsRUFDekJDLEdBQU1GLEVBQUVDLEtBRVZNLGFBQWdCWCxNQUFRQSxLQUFLVyxjQUFpQixTQUFTUCxFQUFHUSxHQUMxRCxJQUFLLElBQUlDLEtBQUtULEVBQWEsWUFBTlMsR0FBb0JaLE9BQU9hLFVBQVVDLGVBQWVDLEtBQUtKLEVBQVNDLElBQUlkLGdCQUFnQmEsRUFBU1IsRUFBR1MsSUNSdkhJLFdEVUpoQixPQUFPTyxlQUFlSSxRQUFTLGFBQWMsQ0FBRU0sT0FBTyxJRVB0RFAsYUFBQVEsUUFBQSxZQUFBUCxTQUNBRCxhQUFBUSxRQUFBLGFBQUFQLFNESmlCWixNQUFRQSxLQUFLaUIsV0FBZSxXQUN6QyxJQUFJRyxFQUFnQixTQUFVQyxFQUFHQyxHQUk3QixPQUhBRixFQUFnQm5CLE9BQU9zQixnQkFDbEIsQ0FBRUMsVUFBVyxjQUFnQkMsT0FBUyxTQUFVSixFQUFHQyxHQUFLRCxFQUFF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ImluZGV4LmJ1bmRsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2NyZWF0ZUJpbmRpbmcgPSAodGhpcyAmJiB0aGlzLl9fY3JlYXRlQmluZGluZykgfHwgKE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBrMiwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbVtrXTsgfSB9KTtcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XG4gICAgaWYgKGsyID09PSB1bmRlZmluZWQpIGsyID0gaztcbiAgICBvW2syXSA9IG1ba107XG59KSk7XG52YXIgX19leHBvcnRTdGFyID0gKHRoaXMgJiYgdGhpcy5fX2V4cG9ydFN0YXIpIHx8IGZ1bmN0aW9uKG0sIGV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmIChwICE9PSBcImRlZmF1bHRcIiAmJiAhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGV4cG9ydHMsIHApKSBfX2NyZWF0ZUJpbmRpbmcoZXhwb3J0cywgbSwgcCk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuX19leHBvcnRTdGFyKHJlcXVpcmUoXCIuL2Vycm9yc1wiKSwgZXhwb3J0cyk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vbG9nZ2luZ1wiKSwgZXhwb3J0cyk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5Dcml0aWNhbEVycm9yID0gZXhwb3J0cy5Mb2dnZWRFcnJvciA9IGV4cG9ydHMuY3JpdGljYWxDYWxsYmFjayA9IGV4cG9ydHMuZXJyb3JDYWxsYmFjayA9IGV4cG9ydHMud2FybmluZ0NhbGxiYWNrID0gZXhwb3J0cy5pbmZvQ2FsbGJhY2sgPSBleHBvcnRzLmRlYnVnQ2FsbGJhY2sgPSBleHBvcnRzLmFsbENhbGxiYWNrID0gZXhwb3J0cy5sb2dnZWRDYWxsYmFjayA9IHZvaWQgMDtcbnZhciBsb2dnaW5nXzEgPSByZXF1aXJlKFwiLi4vbG9nZ2luZ1wiKTtcbmZ1bmN0aW9uIGxvZ2dlZENhbGxiYWNrKG1lc3NhZ2UsIGxldmVsLCBjYWxsYmFjaykge1xuICAgIGlmICghY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2sgPSBsZXZlbDtcbiAgICAgICAgbGV2ZWwgPSBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5JTkZPO1xuICAgIH1cbiAgICAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKS5yZXBvcnQobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yID8gbWVzc2FnZSA6IG5ldyBMb2dnZWRFcnJvcihtZXNzYWdlKSwgbGV2ZWwsIHRoaXMubmFtZSAhPT0gXCJsb2dnZWRDYWxsYmFja1wiID8gdGhpcyA6IHVuZGVmaW5lZCk7XG4gICAgY2FsbGJhY2sobWVzc2FnZSk7XG59XG5leHBvcnRzLmxvZ2dlZENhbGxiYWNrID0gbG9nZ2VkQ2FsbGJhY2s7XG5mdW5jdGlvbiBhbGxDYWxsYmFjayhtZXNzYWdlLCBjYWxsYmFjaykge1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuQUxMLCBjYWxsYmFjayk7XG59XG5leHBvcnRzLmFsbENhbGxiYWNrID0gYWxsQ2FsbGJhY2s7XG5mdW5jdGlvbiBkZWJ1Z0NhbGxiYWNrKG1lc3NhZ2UsIGNhbGxiYWNrKSB7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5ERUJVRywgY2FsbGJhY2spO1xufVxuZXhwb3J0cy5kZWJ1Z0NhbGxiYWNrID0gZGVidWdDYWxsYmFjaztcbmZ1bmN0aW9uIGluZm9DYWxsYmFjayhtZXNzYWdlLCBjYWxsYmFjaykge1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuSU5GTywgY2FsbGJhY2spO1xufVxuZXhwb3J0cy5pbmZvQ2FsbGJhY2sgPSBpbmZvQ2FsbGJhY2s7XG5mdW5jdGlvbiB3YXJuaW5nQ2FsbGJhY2sobWVzc2FnZSwgY2FsbGJhY2spIHtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLldBUk4sIGNhbGxiYWNrKTtcbn1cbmV4cG9ydHMud2FybmluZ0NhbGxiYWNrID0gd2FybmluZ0NhbGxiYWNrO1xuZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhtZXNzYWdlLCBjYWxsYmFjaykge1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgbG9nZ2luZ18xLkxPR0dFUl9MRVZFTFMuRVJST1IsIGNhbGxiYWNrKTtcbn1cbmV4cG9ydHMuZXJyb3JDYWxsYmFjayA9IGVycm9yQ2FsbGJhY2s7XG5mdW5jdGlvbiBjcml0aWNhbENhbGxiYWNrKG1lc3NhZ2UsIGNhbGxiYWNrKSB7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBsb2dnaW5nXzEuTE9HR0VSX0xFVkVMUy5DUklUSUNBTCwgY2FsbGJhY2spO1xufVxuZXhwb3J0cy5jcml0aWNhbENhbGxiYWNrID0gY3JpdGljYWxDYWxsYmFjaztcbnZhciBMb2dnZWRFcnJvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExvZ2dlZEVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExvZ2dlZEVycm9yKGVycm9yLCBsZXZlbCkge1xuICAgICAgICBpZiAobGV2ZWwgPT09IHZvaWQgMCkgeyBsZXZlbCA9IGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLkVSUk9SOyB9XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmxvZ2dlZCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5sb2dnZWQgPSBlcnJvciBpbnN0YW5jZW9mIExvZ2dlZEVycm9yICYmIGVycm9yLmxvZ2dlZDtcbiAgICAgICAgaWYgKCFfdGhpcy5sb2dnZWQpXG4gICAgICAgICAgICAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKS5yZXBvcnQoZXJyb3IsIGxldmVsKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gTG9nZ2VkRXJyb3I7XG59KEVycm9yKSk7XG5leHBvcnRzLkxvZ2dlZEVycm9yID0gTG9nZ2VkRXJyb3I7XG52YXIgQ3JpdGljYWxFcnJvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENyaXRpY2FsRXJyb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ3JpdGljYWxFcnJvcihlcnJvcikge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgZXJyb3IsIGxvZ2dpbmdfMS5MT0dHRVJfTEVWRUxTLkNSSVRJQ0FMKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gQ3JpdGljYWxFcnJvcjtcbn0oTG9nZ2VkRXJyb3IpKTtcbmV4cG9ydHMuQ3JpdGljYWxFcnJvciA9IENyaXRpY2FsRXJyb3I7IiwiLyoqXG4gKiBAbW9kdWxlIGxvZ2dpbmdcbiAqL1xuXG5leHBvcnQgKiBmcm9tICcuL2Vycm9ycyc7XG5leHBvcnQgKiBmcm9tICcuL2xvZ2dpbmcnOyIsImltcG9ydCB7Q2FsbGJhY2ssIGdldExvZ2dlciwgTE9HR0VSX0xFVkVMUywgTG9nZ2VyTWVzc2FnZX0gZnJvbSBcIi4uL2xvZ2dpbmdcIjtcblxuLyoqXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbFxuICogQHBhcmFtIHtDYWxsYmFja30gY2FsbGJhY2tcbiAqXG4gKiBAZnVuY3Rpb24gbG9nZ2VkQ2FsbGJhY2tcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ2dlZENhbGxiYWNrKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgbGV2ZWw6IG51bWJlciB8IENhbGxiYWNrLCBjYWxsYmFjazogQ2FsbGJhY2spe1xuICAgIGlmICghY2FsbGJhY2spe1xuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGNhbGxiYWNrID0gbGV2ZWw7XG4gICAgICAgIGxldmVsID0gTE9HR0VSX0xFVkVMUy5JTkZPO1xuICAgIH1cblxuICAgIGdldExvZ2dlcigpLnJlcG9ydChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IgPyBtZXNzYWdlIDogbmV3IExvZ2dlZEVycm9yKG1lc3NhZ2UpLCBsZXZlbCBhcyBudW1iZXIsIHRoaXMubmFtZSAhPT0gXCJsb2dnZWRDYWxsYmFja1wiID8gdGhpcyA6IHVuZGVmaW5lZCk7XG4gICAgY2FsbGJhY2sobWVzc2FnZSk7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHtDYWxsYmFja30gY2FsbGJhY2tcbiAqXG4gKiBAZnVuY3Rpb24gYWxsQ2FsbGJhY2tcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFsbENhbGxiYWNrKHRoaXM6IGFueSwgbWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgY2FsbGJhY2s6IENhbGxiYWNrKXtcbiAgICBsb2dnZWRDYWxsYmFjay5jYWxsKHRoaXMsIG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuQUxMLCBjYWxsYmFjayk7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHtDYWxsYmFja30gY2FsbGJhY2tcbiAqXG4gKiBAZnVuY3Rpb24gZGVidWdDYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZGVidWdDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGNhbGxiYWNrOiBDYWxsYmFjayl7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkRFQlVHLCBjYWxsYmFjayk7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHtDYWxsYmFja30gY2FsbGJhY2tcbiAqXG4gKiBAZnVuY3Rpb24gaW5mb0NhbGxiYWNrXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMuZXJyb3JzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBpbmZvQ2FsbGJhY2sodGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBjYWxsYmFjazogQ2FsbGJhY2spe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5JTkZPLCBjYWxsYmFjayk7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHtDYWxsYmFja30gY2FsbGJhY2tcbiAqXG4gKiBAZnVuY3Rpb24gd2FybmluZ0NhbGxiYWNrXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMuZXJyb3JzXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB3YXJuaW5nQ2FsbGJhY2sodGhpczogYW55LCBtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBjYWxsYmFjazogQ2FsbGJhY2spe1xuICAgIGxvZ2dlZENhbGxiYWNrLmNhbGwodGhpcywgbWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5XQVJOLCBjYWxsYmFjayk7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHtDYWxsYmFja30gY2FsbGJhY2tcbiAqXG4gKiBAZnVuY3Rpb24gZXJyb3JDYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGNhbGxiYWNrOiBDYWxsYmFjayl7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkVSUk9SLCBjYWxsYmFjayk7XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHtDYWxsYmFja30gY2FsbGJhY2tcbiAqXG4gKiBAZnVuY3Rpb24gY3JpdGljYWxDYWxsYmFja1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmVycm9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gY3JpdGljYWxDYWxsYmFjayh0aGlzOiBhbnksIG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIGNhbGxiYWNrOiBDYWxsYmFjayl7XG4gICAgbG9nZ2VkQ2FsbGJhY2suY2FsbCh0aGlzLCBtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMLCBjYWxsYmFjayk7XG59XG5cbi8qKlxuICogV3JhcHBlciBDbGFzcyBmb3IgTG9nZ2VkIEVycm9yc1xuICpcbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gZXJyb3JcbiAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbCBkZWZhdWx0cyB0byB7QGxpbmsgTE9HR0VSX0xFVkVMUy5FUlJPUn1cbiAqXG4gKiBAY2xhc3MgTG9nZ2VkRXJyb3JcbiAqIEBleHRlbmRzIEVycm9yXG4gKlxuICovXG5leHBvcnQgY2xhc3MgTG9nZ2VkRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgLyoqXG4gICAgICogQHByb3BlcnR5IGxvZ2dlZFxuICAgICAqL1xuICAgIGxvZ2dlZCA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IoZXJyb3I6IExvZ2dlck1lc3NhZ2UsIGxldmVsOiBudW1iZXIgPSBMT0dHRVJfTEVWRUxTLkVSUk9SKSB7XG4gICAgICAgIHN1cGVyKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogZXJyb3IpO1xuICAgICAgICB0aGlzLmxvZ2dlZCA9IGVycm9yIGluc3RhbmNlb2YgTG9nZ2VkRXJyb3IgJiYgZXJyb3IubG9nZ2VkO1xuICAgICAgICBpZiAoIXRoaXMubG9nZ2VkKVxuICAgICAgICAgICAgZ2V0TG9nZ2VyKCkucmVwb3J0KGVycm9yLCBsZXZlbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFdyYXBwZXIgQ2xhc3MgZm9yIENyaXRpY2FsIEVycm9yc1xuICpcbiAqIEBjbGFzcyBDcml0aWNhbEVycm9yXG4gKiBAZXh0ZW5kcyBMb2dnZWRFcnJvclxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIENyaXRpY2FsRXJyb3IgZXh0ZW5kcyBMb2dnZWRFcnJvcntcbiAgICBjb25zdHJ1Y3RvcihlcnJvcjogTG9nZ2VyTWVzc2FnZSkge1xuICAgICAgICBzdXBlcihlcnJvciwgTE9HR0VSX0xFVkVMUy5DUklUSUNBTCk7XG4gICAgfVxufSIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH0pO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX2V4cG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9fZXhwb3J0U3RhcikgfHwgZnVuY3Rpb24obSwgZXhwb3J0cykge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0cywgcCkpIF9fY3JlYXRlQmluZGluZyhleHBvcnRzLCBtLCBwKTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vZXJyb3JzXCIpLCBleHBvcnRzKTsiLCJcInVzZSBzdHJpY3RcIjtcbnZhciBfX3NwcmVhZEFycmF5ID0gKHRoaXMgJiYgdGhpcy5fX3NwcmVhZEFycmF5KSB8fCBmdW5jdGlvbiAodG8sIGZyb20sIHBhY2spIHtcbiAgICBpZiAocGFjayB8fCBhcmd1bWVudHMubGVuZ3RoID09PSAyKSBmb3IgKHZhciBpID0gMCwgbCA9IGZyb20ubGVuZ3RoLCBhcjsgaSA8IGw7IGkrKykge1xuICAgICAgICBpZiAoYXIgfHwgIShpIGluIGZyb20pKSB7XG4gICAgICAgICAgICBpZiAoIWFyKSBhciA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZyb20sIDAsIGkpO1xuICAgICAgICAgICAgYXJbaV0gPSBmcm9tW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0by5jb25jYXQoYXIgfHwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSkpO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMubG9nU3luYyA9IGV4cG9ydHMubG9nQXN5bmMgPSBleHBvcnRzLlN0b3BXYXRjaCA9IHZvaWQgMDtcbnZhciBlcnJvcnNfMSA9IHJlcXVpcmUoXCIuLi9lcnJvcnNcIik7XG52YXIgbG9nZ2luZ18xID0gcmVxdWlyZShcIi4vbG9nZ2luZ1wiKTtcbnZhciBjb25zdGFudHNfMSA9IHJlcXVpcmUoXCIuL2NvbnN0YW50c1wiKTtcbnZhciBTdG9wV2F0Y2ggPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFN0b3BXYXRjaCgpIHtcbiAgICB9XG4gICAgU3RvcFdhdGNoLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIH07XG4gICAgU3RvcFdhdGNoLnByb3RvdHlwZS5jaGVjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0VGltZSlcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU3RvcFdhdGNoIGRpZG50IHN0YXJ0Jyk7XG4gICAgICAgIHJldHVybiBEYXRlLm5vdygpIC0gdGhpcy5zdGFydFRpbWU7XG4gICAgfTtcbiAgICBTdG9wV2F0Y2gucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmNoZWNrKCk7XG4gICAgICAgIHRoaXMuc3RhcnRUaW1lID0gdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIFN0b3BXYXRjaDtcbn0oKSk7XG5leHBvcnRzLlN0b3BXYXRjaCA9IFN0b3BXYXRjaDtcbmZ1bmN0aW9uIGxvZ0FzeW5jKGxldmVsLCBiZW5jaG1hcmspIHtcbiAgICBpZiAobGV2ZWwgPT09IHZvaWQgMCkgeyBsZXZlbCA9IGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuREVCVUc7IH1cbiAgICBpZiAoIWJlbmNobWFyayAmJiB0eXBlb2YgbGV2ZWwgPT09ICdib29sZWFuJykge1xuICAgICAgICBiZW5jaG1hcmsgPSBsZXZlbDtcbiAgICAgICAgbGV2ZWwgPSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwgcHJvcGVydHlLZXksIGRlc2NyaXB0b3IpIHtcbiAgICAgICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgdmFyIG1ldGhvZFdyYXBwZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2FsbGJhY2sgPSBhcmdzLnBvcCgpO1xuICAgICAgICAgICAgaWYgKCFjYWxsYmFjayB8fCB0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IGVycm9yc18xLkNyaXRpY2FsRXJyb3IoXCJNaXNzaW5nIENhbGxiYWNrXCIpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSB0aGlzLm5hbWUgJiYgdGhpcy5uYW1lICE9PSAnRnVuY3Rpb24nID8gdGhpcy5uYW1lIDogdGhpcy5jb25zdHJ1Y3RvciAmJiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUgfHwgdGhpcztcbiAgICAgICAgICAgICgwLCBsb2dnaW5nXzEuZ2V0TG9nZ2VyKSgpLnJlcG9ydChcIlt7MH1dIC0gRW50ZXJpbmcgTWV0aG9kIHsxfSB3aXRoIGFyZ3M6IHsyfVwiLCBsZXZlbCwgbmFtZSwgcHJvcGVydHlLZXksIGFyZ3MubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnRvU3RyaW5nKCk7IH0pLmpvaW4oJyB8ICcpKTtcbiAgICAgICAgICAgIHZhciBzdG9wV2F0Y2g7XG4gICAgICAgICAgICB2YXIgY2IgPSBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc3RvcFdhdGNoKVxuICAgICAgICAgICAgICAgICAgICAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKS5yZXBvcnQoXCJbezB9XVtCRU5DSE1BUktdIC0gTGVhdmluZyBNZXRob2QgezF9IGFmdGVyIHsyfW1zXCIsIGxldmVsLCBuYW1lLCBwcm9wZXJ0eUtleSwgc3RvcFdhdGNoLnN0b3AoKSk7XG4gICAgICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICAgICAgICAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKS5yZXBvcnQoXCJbezB9XVtFUlJPUl0gLSBMZWF2aW5nIE1ldGhvZCB7MX0gd2l0aCBlcnJvciB7Mn1cIiwgbGV2ZWwsIG5hbWUsIHByb3BlcnR5S2V5LCBlcnIpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FsbGJhY2soZXJyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KFwiW3swfV0gLSBMZWF2aW5nIE1ldGhvZCB7MX0gd2l0aCByZXN1bHRzOiB7Mn1cIiwgbGV2ZWwsIG5hbWUsIHByb3BlcnR5S2V5LCByZXN1bHRzID8gcmVzdWx0cy5tYXAoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEudG9TdHJpbmcoKTsgfSkuam9pbignIHwgJykgOiBcInZvaWRcIik7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodm9pZCAwLCBfX3NwcmVhZEFycmF5KFt1bmRlZmluZWRdLCByZXN1bHRzLCBmYWxzZSkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChiZW5jaG1hcmspIHtcbiAgICAgICAgICAgICAgICBzdG9wV2F0Y2ggPSBuZXcgU3RvcFdhdGNoKCk7XG4gICAgICAgICAgICAgICAgc3RvcFdhdGNoLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvcmlnaW5hbE1ldGhvZC5jYWxsLmFwcGx5KG9yaWdpbmFsTWV0aG9kLCBfX3NwcmVhZEFycmF5KF9fc3ByZWFkQXJyYXkoW3RoaXMuX19vcmlnaW5hbE9iamVjdCB8fCB0aGlzXSwgYXJncywgZmFsc2UpLCBbY2JdLCBmYWxzZSkpO1xuICAgICAgICB9O1xuICAgICAgICBkZXNjcmlwdG9yLnZhbHVlID0gbWV0aG9kV3JhcHBlcjtcbiAgICB9O1xufVxuZXhwb3J0cy5sb2dBc3luYyA9IGxvZ0FzeW5jO1xuZnVuY3Rpb24gbG9nU3luYyhsZXZlbCwgYmVuY2htYXJrKSB7XG4gICAgaWYgKGxldmVsID09PSB2b2lkIDApIHsgbGV2ZWwgPSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHOyB9XG4gICAgaWYgKCFiZW5jaG1hcmsgJiYgdHlwZW9mIGxldmVsID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgYmVuY2htYXJrID0gbGV2ZWw7XG4gICAgICAgIGxldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5ERUJVRztcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIHByb3BlcnR5S2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XG4gICAgICAgIHZhciBtZXRob2RXcmFwcGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5hbWUgPSB0aGlzLm5hbWUgJiYgdGhpcy5uYW1lICE9PSAnRnVuY3Rpb24nID8gdGhpcy5uYW1lIDogdGhpcy5jb25zdHJ1Y3RvciAmJiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUgfHwgdGhpcztcbiAgICAgICAgICAgICgwLCBsb2dnaW5nXzEuZ2V0TG9nZ2VyKSgpLnJlcG9ydChcIlt7MH1dIC0gRW50ZXJpbmcgTWV0aG9kIHsxfSB3aXRoIGFyZ3M6IHsyfVwiLCBsZXZlbCwgbmFtZSwgcHJvcGVydHlLZXksIGFyZ3MubWFwKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnRvU3RyaW5nKCk7IH0pLmpvaW4oJyB8ICcpKTtcbiAgICAgICAgICAgIHZhciBzdG9wV2F0Y2ggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgaWYgKGJlbmNobWFyaykge1xuICAgICAgICAgICAgICAgIHN0b3BXYXRjaCA9IG5ldyBTdG9wV2F0Y2goKTtcbiAgICAgICAgICAgICAgICBzdG9wV2F0Y2guc3RhcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gb3JpZ2luYWxNZXRob2QuY2FsbC5hcHBseShvcmlnaW5hbE1ldGhvZCwgX19zcHJlYWRBcnJheShbdGhpcy5fX29yaWdpbmFsT2JqZWN0IHx8IHRoaXNdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoc3RvcFdhdGNoKVxuICAgICAgICAgICAgICAgICAgICAoMCwgbG9nZ2luZ18xLmdldExvZ2dlcikoKS5yZXBvcnQoXCJbezB9XVtCRU5DSE1BUktdIC0gTGVhdmluZyBNZXRob2QgezF9IGFmdGVyIHsyfW1zXCIsIGxldmVsLCBuYW1lLCBwcm9wZXJ0eUtleSwgc3RvcFdhdGNoLnN0b3AoKSk7XG4gICAgICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KFwiW3swfV1bRVJST1JdIC0gTGVhdmluZyBNZXRob2QgezF9IHdpdGggZXJyb3IgezJ9XCIsIGxldmVsLCBuYW1lLCBwcm9wZXJ0eUtleSwgZSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdG9wV2F0Y2gpXG4gICAgICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KFwiW3swfV1bQkVOQ0hNQVJLXSAtIExlYXZpbmcgTWV0aG9kIHsxfSBhZnRlciB7Mn1tc1wiLCBsZXZlbCwgbmFtZSwgcHJvcGVydHlLZXksIHN0b3BXYXRjaC5zdG9wKCkpO1xuICAgICAgICAgICAgKDAsIGxvZ2dpbmdfMS5nZXRMb2dnZXIpKCkucmVwb3J0KFwiW3swfV0gLSBMZWF2aW5nIE1ldGhvZCB7MX0gd2l0aCByZXN1bHRzOiB7Mn1cIiwgbGV2ZWwsIG5hbWUsIHByb3BlcnR5S2V5LCByZXN1bHQgPyByZXN1bHQgOiBcInZvaWRcIik7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICBkZXNjcmlwdG9yLnZhbHVlID0gbWV0aG9kV3JhcHBlcjtcbiAgICB9O1xufVxuZXhwb3J0cy5sb2dTeW5jID0gbG9nU3luYzsiLCIvKipcbiAqIEBuYW1lc3BhY2UgZGItZGVjb3JhdG9ycy5lcnJvcnNcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzXG4gKi9cblxuZXhwb3J0ICogZnJvbSAnLi9lcnJvcnMnOyIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5EQVlTX09GX1dFRUtfTkFNRVMgPSBleHBvcnRzLk1PTlRIX05BTUVTID0gZXhwb3J0cy5ERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQgPSBleHBvcnRzLkxPR0dJTkdfTVNHID0gZXhwb3J0cy5MT0dHRVJfTEVWRUxTID0gdm9pZCAwO1xuZXhwb3J0cy5MT0dHRVJfTEVWRUxTID0ge1xuICAgIEFMTDogMCxcbiAgICBERUJVRzogMSxcbiAgICBJTkZPOiAyLFxuICAgIFdBUk46IDMsXG4gICAgRVJST1I6IDQsXG4gICAgQ1JJVElDQUw6IDVcbn07XG5leHBvcnRzLkxPR0dJTkdfTVNHID0ge1xuICAgIExFVkVMX0NIQU5HRUQ6IFwiTG9nZ2VyIExldmVsIGNoYW5nZWQgZnJvbSB7MH0gdG8gezF9XCIsXG4gICAgTE9HR0VSX0NIQU5HRUQ6IFwiTG9nZ2VyIGNoYW5nZWRcIlxufTtcbmV4cG9ydHMuREVGQVVMVF9USU1FU1RBTVBfRk9STUFUID0gXCJkZC9NTS95eXl5IEhIOm1tOnNzOlNcIjtcbmV4cG9ydHMuTU9OVEhfTkFNRVMgPSBbXG4gICAgXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLCBcIkp1bHlcIixcbiAgICBcIkF1Z3VzdFwiLCBcIlNlcHRlbWJlclwiLCBcIk9jdG9iZXJcIiwgXCJOb3ZlbWJlclwiLCBcIkRlY2VtYmVyXCJcbl07XG5leHBvcnRzLkRBWVNfT0ZfV0VFS19OQU1FUyA9IFtcbiAgICBcIlN1bmRheVwiLCBcIk1vbmRheVwiLCBcIlR1ZXNkYXlcIixcbiAgICBcIldlZG5lc2RheVwiLCBcIlRodXJzZGF5XCIsIFwiRnJpZGF5XCIsIFwiU2F0dXJkYXlcIlxuXTsiLCIvKipcbiAqIEBlbnVtIExPR0dFUl9MRVZFTFNcbiAqXG4gKiBAY2F0ZWdvcnkgQ29uc3RhbnRzXG4gKi9cbmV4cG9ydCBjb25zdCBMT0dHRVJfTEVWRUxTID0ge1xuICAgIEFMTDogMCxcbiAgICBERUJVRzogMSxcbiAgICBJTkZPOiAyLFxuICAgIFdBUk46IDMsXG4gICAgRVJST1I6IDQsXG4gICAgQ1JJVElDQUw6IDVcbn1cblxuLyoqXG4gKiBEZWZhdWx0IG1lc3NhZ2VzXG4gKlxuICogY29uc3RhbnQgTE9HR0lOR19NU0dcbiAqXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBMT0dHSU5HX01TRyA9IHtcbiAgICBMRVZFTF9DSEFOR0VEOiBcIkxvZ2dlciBMZXZlbCBjaGFuZ2VkIGZyb20gezB9IHRvIHsxfVwiLFxuICAgIExPR0dFUl9DSEFOR0VEOiBcIkxvZ2dlciBjaGFuZ2VkXCJcbn1cblxuLyoqXG4gKiBAdHlwZWRlZiBFcnJcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqICovXG5leHBvcnQgdHlwZSBFcnIgPSBFcnJvciB8IHN0cmluZyB8IHVuZGVmaW5lZDtcbi8qKlxuICogQHR5cGVkZWYgQ2FsbGJhY2tcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqICovXG5leHBvcnQgdHlwZSBDYWxsYmFjayA9IChlcnI/OiBFcnIsIC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkO1xuXG4vKipcbiAqIEBjb25zdGFudCBERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVRcbiAqIEBjYXRlZ29yeSBDb25zdGFudHNcbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfVElNRVNUQU1QX0ZPUk1BVCA9IFwiZGQvTU0veXl5eSBISDptbTpzczpTXCI7XG5cbi8qKlxuICogQ2FuIGJlIGNoYW5nZWQgZm9yIGxvY2FsaXphdGlvbiBwdXJwb3Nlc1xuICpcbiAqIEBjb25zdGFudCBNT05USF9OQU1FU1xuICovXG5leHBvcnQgY29uc3QgTU9OVEhfTkFNRVMgPSBbXG4gICAgXCJKYW51YXJ5XCIsIFwiRmVicnVhcnlcIiwgXCJNYXJjaFwiLCBcIkFwcmlsXCIsIFwiTWF5XCIsIFwiSnVuZVwiLCBcIkp1bHlcIixcbiAgICBcIkF1Z3VzdFwiLCBcIlNlcHRlbWJlclwiLCBcIk9jdG9iZXJcIiwgXCJOb3ZlbWJlclwiLCBcIkRlY2VtYmVyXCJcbl07XG5cbi8qKlxuICogQ2FuIGJlIGNoYW5nZWQgZm9yIGxvY2FsaXphdGlvbiBwdXJwb3Nlc1xuICpcbiAqIEBjb25zdGFudCBEQVlTX09GX1dFRUtfTkFNRVNcbiAqL1xuZXhwb3J0IGNvbnN0IERBWVNfT0ZfV0VFS19OQU1FUyA9IFtcbiAgICBcIlN1bmRheVwiLCBcIk1vbmRheVwiLCBcIlR1ZXNkYXlcIixcbiAgICBcIldlZG5lc2RheVwiLCBcIlRodXJzZGF5XCIsIFwiRnJpZGF5XCIsIFwiU2F0dXJkYXlcIlxuXTsiLCJpbXBvcnQge0NyaXRpY2FsRXJyb3J9IGZyb20gXCIuLi9lcnJvcnNcIjtcbmltcG9ydCB7Z2V0TG9nZ2VyfSBmcm9tIFwiLi9sb2dnaW5nXCI7XG5pbXBvcnQge0NhbGxiYWNrLCBFcnIsIExPR0dFUl9MRVZFTFN9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG4vKipcbiAqIFV0aWwgY2xhc3MgdG8gbWVhc3VyZSB0aW1lIGJldHdlZW4gdHdvIHBvaW50cyBpbiB0aW1lO1xuICpcbiAqIEBjbGFzcyBTdG9wV2F0Y2hcbiAqXG4gKi9cbmV4cG9ydCBjbGFzcyBTdG9wV2F0Y2h7XG4gICAgcHJpdmF0ZSBzdGFydFRpbWU/OiBudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIHN0YXJ0IHRpbWVcbiAgICAgKi9cbiAgICBzdGFydCgpe1xuICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmV0dXJucyB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIG5vdyBhbmQgdGhlIHN0YXJ0IHRpbWVcbiAgICAgKi9cbiAgICBjaGVjaygpOiBudW1iZXIge1xuICAgICAgICBpZiAoIXRoaXMuc3RhcnRUaW1lKVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTdG9wV2F0Y2ggZGlkbnQgc3RhcnQnKTtcbiAgICAgICAgcmV0dXJuIERhdGUubm93KCkgLSB0aGlzLnN0YXJ0VGltZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZXR1cm5zIHRoZSBkaWZmZXJlbmNlIGJldHdlZW4gbm93IGFuZCB0aGUgc3RhcnQgdGltZVxuICAgICAqIHN0b3BzIHRoZSBUaW1lV2F0Y2hcbiAgICAgKi9cbiAgICBzdG9wKCk6IG51bWJlciB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuY2hlY2soKTtcbiAgICAgICAgdGhpcy5zdGFydFRpbWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEFzeW5jIE1ldGhvZCBkZWNvcmF0b3IgdG8gbG9nIHRoZSBpbnB1dCBhbmQgb3V0cHV0IG9mIHRoYXQgbWV0aG9kXG4gKlxuICogQHBhcmFtIHtudW1iZXJ9IFtsZXZlbF0gTG9nZ2luZyBMZXZlbCBhcyBpbiB7QGxpbmsgTE9HR0VSX0xFVkVMU30gZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuREVCVUd9XG4gKiBAcGFyYW0ge2Jvb2xlYW59IFtiZW5jaG1hcmtdIGRldGVybWluZXMgaWYgdGhlIGxvZ2dpbmcgaW5jbHVkZXMgdGhlIGR1cmF0aW9uIGluIG1zLiBkZWZhdWx0cyB0byBmYWxzZVxuICpcbiAqIEBkZWNvcmF0b3IgbG9nQXN5bmNcbiAqXG4gKiBAY2F0ZWdvcnkgRGVjb3JhdG9yc1xuICovXG5leHBvcnQgZnVuY3Rpb24gbG9nQXN5bmMobGV2ZWw6IG51bWJlciB8IGJvb2xlYW4gPSBMT0dHRVJfTEVWRUxTLkRFQlVHLCBiZW5jaG1hcms/OiBib29sZWFuKSB7XG5cbiAgICBpZiAoIWJlbmNobWFyayAmJiB0eXBlb2YgbGV2ZWwgPT09ICdib29sZWFuJyl7XG4gICAgICAgIGJlbmNobWFyayA9IGxldmVsO1xuICAgICAgICBsZXZlbCA9IExPR0dFUl9MRVZFTFMuREVCVUc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQ6IGFueSwgcHJvcGVydHlLZXk6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XG5cbiAgICAgICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuXG4gICAgICAgIGNvbnN0IG1ldGhvZFdyYXBwZXIgPSBmdW5jdGlvbih0aGlzOiBhbnksIC4uLmFyZ3M6IGFueVtdKXtcbiAgICAgICAgICAgIGxldCBjYWxsYmFjazogQ2FsbGJhY2sgPSBhcmdzLnBvcCgpO1xuICAgICAgICAgICAgaWYgKCFjYWxsYmFjayB8fCB0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IENyaXRpY2FsRXJyb3IoYE1pc3NpbmcgQ2FsbGJhY2tgKTtcblxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IHRoaXMubmFtZSAmJiB0aGlzLm5hbWUgIT09ICdGdW5jdGlvbicgPyB0aGlzLm5hbWUgOiB0aGlzLmNvbnN0cnVjdG9yICYmIHRoaXMuY29uc3RydWN0b3IubmFtZSB8fCB0aGlzO1xuICAgICAgICAgICAgZ2V0TG9nZ2VyKCkucmVwb3J0KGBbezB9XSAtIEVudGVyaW5nIE1ldGhvZCB7MX0gd2l0aCBhcmdzOiB7Mn1gLCBsZXZlbCBhcyBudW1iZXIsIG5hbWUsIHByb3BlcnR5S2V5LCBhcmdzLm1hcChhID0+IGEudG9TdHJpbmcoKSkuam9pbignIHwgJykpO1xuXG4gICAgICAgICAgICBsZXQgc3RvcFdhdGNoOiBTdG9wV2F0Y2g7XG5cbiAgICAgICAgICAgIGNvbnN0IGNiID0gKGVycjogRXJyLCAuLi5yZXN1bHRzOiBhbnlbXSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChzdG9wV2F0Y2gpXG4gICAgICAgICAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChgW3swfV1bQkVOQ0hNQVJLXSAtIExlYXZpbmcgTWV0aG9kIHsxfSBhZnRlciB7Mn1tc2AsIGxldmVsIGFzIG51bWJlciwgbmFtZSwgcHJvcGVydHlLZXksIHN0b3BXYXRjaC5zdG9wKCkpO1xuICAgICAgICAgICAgICAgIGlmIChlcnIpe1xuICAgICAgICAgICAgICAgICAgICBnZXRMb2dnZXIoKS5yZXBvcnQoYFt7MH1dW0VSUk9SXSAtIExlYXZpbmcgTWV0aG9kIHsxfSB3aXRoIGVycm9yIHsyfWAsIGxldmVsIGFzIG51bWJlciwgbmFtZSwgcHJvcGVydHlLZXksIGVycik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhlcnIpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChgW3swfV0gLSBMZWF2aW5nIE1ldGhvZCB7MX0gd2l0aCByZXN1bHRzOiB7Mn1gLCBsZXZlbCBhcyBudW1iZXIsIG5hbWUsIHByb3BlcnR5S2V5LCByZXN1bHRzID8gcmVzdWx0cy5tYXAoYSA9PiBhLnRvU3RyaW5nKCkpLmpvaW4oJyB8ICcpIDogXCJ2b2lkXCIpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKHVuZGVmaW5lZCwgLi4ucmVzdWx0cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChiZW5jaG1hcmspe1xuICAgICAgICAgICAgICAgIHN0b3BXYXRjaCA9IG5ldyBTdG9wV2F0Y2goKTtcbiAgICAgICAgICAgICAgICBzdG9wV2F0Y2guc3RhcnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb3JpZ2luYWxNZXRob2QuY2FsbCh0aGlzLl9fb3JpZ2luYWxPYmplY3QgfHwgdGhpcywgLi4uYXJncywgY2IpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IG1ldGhvZFdyYXBwZXI7XG4gICAgfVxufVxuXG4vKipcbiAqIFN5bmMgTWV0aG9kIGRlY29yYXRvciB0byBsb2cgdGhlIGlucHV0IGFuZCBvdXRwdXQgb2YgdGhhdCBtZXRob2RcbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gW2xldmVsXSBMb2dnaW5nIExldmVsIGFzIGluIHtAbGluayBMT0dHRVJfTEVWRUxTfSBkZWZhdWx0cyB0byB7QGxpbmsgTE9HR0VSX0xFVkVMUy5ERUJVR31cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gW2JlbmNobWFya10gZGV0ZXJtaW5lcyBpZiB0aGUgbG9nZ2luZyBpbmNsdWRlcyB0aGUgZHVyYXRpb24gaW4gbXMuIGRlZmF1bHRzIHRvIGZhbHNlXG4gKlxuICogQGRlY29yYXRvciBsb2dTeW5jXG4gKlxuICogQGNhdGVnb3J5IERlY29yYXRvcnNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGxvZ1N5bmMobGV2ZWw6IG51bWJlciB8IGJvb2xlYW4gPSBMT0dHRVJfTEVWRUxTLkRFQlVHLCBiZW5jaG1hcms/OiBib29sZWFuKSB7XG5cbiAgICBpZiAoIWJlbmNobWFyayAmJiB0eXBlb2YgbGV2ZWwgPT09ICdib29sZWFuJyl7XG4gICAgICAgIGJlbmNobWFyayA9IGxldmVsO1xuICAgICAgICBsZXZlbCA9IExPR0dFUl9MRVZFTFMuREVCVUc7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQ6IGFueSwgcHJvcGVydHlLZXk6IHN0cmluZywgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yKSB7XG5cbiAgICAgICAgY29uc3Qgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuXG4gICAgICAgIGNvbnN0IG1ldGhvZFdyYXBwZXIgPSBmdW5jdGlvbih0aGlzOiBhbnksIC4uLmFyZ3M6IGFueVtdKXtcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLm5hbWUgJiYgdGhpcy5uYW1lICE9PSAnRnVuY3Rpb24nID8gdGhpcy5uYW1lIDogdGhpcy5jb25zdHJ1Y3RvciAmJiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUgfHwgdGhpcztcblxuICAgICAgICAgICAgZ2V0TG9nZ2VyKCkucmVwb3J0KGBbezB9XSAtIEVudGVyaW5nIE1ldGhvZCB7MX0gd2l0aCBhcmdzOiB7Mn1gLCBsZXZlbCBhcyBudW1iZXIsIG5hbWUsIHByb3BlcnR5S2V5LCBhcmdzLm1hcChhID0+IGEudG9TdHJpbmcoKSkuam9pbignIHwgJykpO1xuICAgICAgICAgICAgbGV0IHN0b3BXYXRjaDogU3RvcFdhdGNoIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICBsZXQgcmVzdWx0O1xuICAgICAgICAgICAgaWYgKGJlbmNobWFyayl7XG4gICAgICAgICAgICAgICAgc3RvcFdhdGNoID0gbmV3IFN0b3BXYXRjaCgpO1xuICAgICAgICAgICAgICAgIHN0b3BXYXRjaC5zdGFydCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IG9yaWdpbmFsTWV0aG9kLmNhbGwodGhpcy5fX29yaWdpbmFsT2JqZWN0IHx8IHRoaXMsIC4uLmFyZ3MpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChzdG9wV2F0Y2gpXG4gICAgICAgICAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChgW3swfV1bQkVOQ0hNQVJLXSAtIExlYXZpbmcgTWV0aG9kIHsxfSBhZnRlciB7Mn1tc2AsIGxldmVsIGFzIG51bWJlciwgbmFtZSwgcHJvcGVydHlLZXksIHN0b3BXYXRjaC5zdG9wKCkpO1xuICAgICAgICAgICAgICAgIGdldExvZ2dlcigpLnJlcG9ydChgW3swfV1bRVJST1JdIC0gTGVhdmluZyBNZXRob2QgezF9IHdpdGggZXJyb3IgezJ9YCwgbGV2ZWwgYXMgbnVtYmVyLCBuYW1lLCBwcm9wZXJ0eUtleSwgZSk7XG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzdG9wV2F0Y2gpXG4gICAgICAgICAgICAgICAgZ2V0TG9nZ2VyKCkucmVwb3J0KGBbezB9XVtCRU5DSE1BUktdIC0gTGVhdmluZyBNZXRob2QgezF9IGFmdGVyIHsyfW1zYCwgbGV2ZWwgYXMgbnVtYmVyLCBuYW1lLCBwcm9wZXJ0eUtleSwgc3RvcFdhdGNoLnN0b3AoKSk7XG4gICAgICAgICAgICBnZXRMb2dnZXIoKS5yZXBvcnQoYFt7MH1dIC0gTGVhdmluZyBNZXRob2QgezF9IHdpdGggcmVzdWx0czogezJ9YCwgbGV2ZWwgYXMgbnVtYmVyLCBuYW1lLCBwcm9wZXJ0eUtleSwgcmVzdWx0ID8gcmVzdWx0IDogXCJ2b2lkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGRlc2NyaXB0b3IudmFsdWUgPSBtZXRob2RXcmFwcGVyO1xuICAgIH1cbn1cbiIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fY3JlYXRlQmluZGluZyA9ICh0aGlzICYmIHRoaXMuX19jcmVhdGVCaW5kaW5nKSB8fCAoT2JqZWN0LmNyZWF0ZSA/IChmdW5jdGlvbihvLCBtLCBrLCBrMikge1xuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG8sIGsyLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZnVuY3Rpb24oKSB7IHJldHVybiBtW2tdOyB9IH0pO1xufSkgOiAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xuICAgIG9bazJdID0gbVtrXTtcbn0pKTtcbnZhciBfX2V4cG9ydFN0YXIgPSAodGhpcyAmJiB0aGlzLl9fZXhwb3J0U3RhcikgfHwgZnVuY3Rpb24obSwgZXhwb3J0cykge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKHAgIT09IFwiZGVmYXVsdFwiICYmICFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZXhwb3J0cywgcCkpIF9fY3JlYXRlQmluZGluZyhleHBvcnRzLCBtLCBwKTtcbn07XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5fX2V4cG9ydFN0YXIocmVxdWlyZShcIi4vY29uc3RhbnRzXCIpLCBleHBvcnRzKTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9sb2dnaW5nXCIpLCBleHBvcnRzKTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi9kZWNvcmF0b3JzXCIpLCBleHBvcnRzKTtcbl9fZXhwb3J0U3RhcihyZXF1aXJlKFwiLi91dGlsc1wiKSwgZXhwb3J0cyk7IiwiaW1wb3J0IHtERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQsIExPR0dFUl9MRVZFTFMsIExPR0dJTkdfTVNHfSBmcm9tIFwiLi9jb25zdGFudHNcIjtcbmltcG9ydCB7TG9nZ2VkRXJyb3J9IGZyb20gXCIuLi9lcnJvcnNcIjtcbmltcG9ydCB7Zm9ybWF0RGF0ZSwgc3RyaW5nRm9ybWF0fSBmcm9tIFwiLi91dGlsc1wiO1xuXG4vKipcbiAqIEB0eXBlZGVmIExvZ2dlck1lc3NhZ2VcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IHR5cGUgTG9nZ2VyTWVzc2FnZSA9IEVycm9yIHwgc3RyaW5nO1xuXG4vKipcbiAqIEBpbnRlcmZhY2UgTG9nZ2VyXG4gKiBAbWVtYmVyT2YgbG9nZ2luZy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9nZ2VyIHtcbiAgICAvKipcbiAgICAgKiBSZXBvcnRzIGEgbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBsZXZlbFxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHJlcG9ydChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQUxMfVxuICAgICAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICAgICAqIEBwYXJhbSB7YW55W119IFthcmdzXVxuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIGFsbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBpbmZvKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5ERUJVR31cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBkZWJ1ZyhtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICB3YXJuKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiB7QGxpbmsgTG9nZ2VyI3JlcG9ydH1zIGEgbWVzc2FnZSB1bmRlciB7QGxpbmsgTE9HR0VSX0xFVkVMUy5FUlJPUn1cbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBbYXJnc11cbiAgICAgKlxuICAgICAqIEBtZW1iZXJPZiBMb2dnZXJcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICoge0BsaW5rIExvZ2dlciNyZXBvcnR9cyBhIG1lc3NhZ2UgdW5kZXIge0BsaW5rIExPR0dFUl9MRVZFTFMuQ1JJVElDQUx9XG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHthbnlbXX0gW2FyZ3NdXG4gICAgICpcbiAgICAgKiBAbWVtYmVyT2YgTG9nZ2VyXG4gICAgICovXG4gICAgY3JpdGljYWwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIERlZmluZXMgdGhlIExvZ2dlciBsZXZlbFxuICAgICAqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsXG4gICAgICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICAgICAqXG4gICAgICogQG1lbWJlck9mIExvZ2dlclxuICAgICAqL1xuICAgIHNldExldmVsKGxldmVsOiBudW1iZXIsIC4uLmFyZ3M6IGFueVtdKTogdm9pZDtcbn1cblxuLyoqXG4gKiBEZWZhdWx0IExvZ2dlciBJbXBsZW1lbnRhdGlvblxuICpcbiAqIEBwYXJhbSB7bnVtYmVyfSBkZWZhdWx0TGV2ZWwgZGVmYXVsdHMgdG8ge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7Ym9vbGVhbn0gdXNlVGltZXN0YW1wIGRlZmF1bHRzIHRvIHRydWVcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nTGV2ZWxcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gbG9nU3RhY2tUcmFjZVxuICogQHBhcmFtIHtzdHJpbmd9IHRpbWVzdGFtcEZvcm1hdFxuICpcbiAqIEBjbGFzcyBMb2dnZXJJbXBcbiAqIEBpbXBsZW1lbnRzIExvZ2dlclxuICovXG5leHBvcnQgY2xhc3MgTG9nZ2VySW1wIGltcGxlbWVudHMgTG9nZ2VyIHtcbiAgICBwcml2YXRlIGxldmVsOiBudW1iZXI7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IHVzZVRpbWVzdGFtcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGxvZ0xldmVsOiBib29sZWFuO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgdGltZXN0YW1wRm9ybWF0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSByZWFkb25seSBsb2dTdGFja1RyYWNlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoZGVmYXVsdExldmVsOiBudW1iZXIgPSBMT0dHRVJfTEVWRUxTLklORk8sIHVzZVRpbWVzdGFtcCA9IHRydWUsIGxvZ0xldmVsOiBib29sZWFuID0gdHJ1ZSwgbG9nU3RhY2tUcmFjZTogYm9vbGVhbiA9IGZhbHNlLCB0aW1lc3RhbXBGb3JtYXQgPSBERUZBVUxUX1RJTUVTVEFNUF9GT1JNQVQpe1xuICAgICAgICB0aGlzLmxldmVsID0gZGVmYXVsdExldmVsO1xuICAgICAgICB0aGlzLnVzZVRpbWVzdGFtcCA9IHVzZVRpbWVzdGFtcDtcbiAgICAgICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsO1xuICAgICAgICB0aGlzLmxvZ1N0YWNrVHJhY2UgPSBsb2dTdGFja1RyYWNlO1xuICAgICAgICB0aGlzLnRpbWVzdGFtcEZvcm1hdCA9IHRpbWVzdGFtcEZvcm1hdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBCdWlsdHMgdGhlIGFjdHVhbCBsb2dnaW5nIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gbG9nTGV2ZWwgaWYgdGhlIGxldmVsIGlzIHRvIGJlIGxvZ2dlZFxuICAgICAqIEBwYXJhbSB7YW55fSBpc3N1ZXIgd2hvIGlzIGxvZ2dpbmcgdGhlIG1lc3NhZ2VcbiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gICAgICogQHByb3RlY3RlZFxuICAgICAqL1xuICAgIHByb3RlY3RlZCBidWlsZE1lc3NhZ2UobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgbG9nTGV2ZWw6IG51bWJlciwgaXNzdWVyOiBhbnkgPSB1bmRlZmluZWQsIC4uLmFyZ3M6IGFueVtdKXtcbiAgICAgICAgbGV0IHN0YWNrc1RyYWNlOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3Ipe1xuICAgICAgICAgICAgc3RhY2tzVHJhY2UgPSBtZXNzYWdlLnN0YWNrO1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UubWVzc2FnZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmxvZ0xldmVsKVxuICAgICAgICAgICAgbWVzc2FnZSA9IGBbJHtPYmplY3Qua2V5cyhMT0dHRVJfTEVWRUxTKVtsb2dMZXZlbF19XSAtICR7bWVzc2FnZX1gO1xuICAgICAgICBpZiAoaXNzdWVyKVxuICAgICAgICAgICAgbWVzc2FnZSA9IGBbJHtpc3N1ZXIudG9TdHJpbmcoKX1dJHttZXNzYWdlfWA7XG4gICAgICAgIGlmICh0aGlzLnVzZVRpbWVzdGFtcClcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBgWyR7Zm9ybWF0RGF0ZShuZXcgRGF0ZSgpLCB0aGlzLnRpbWVzdGFtcEZvcm1hdCl9XSR7bWVzc2FnZX1gO1xuICAgICAgICByZXR1cm4gc3RyaW5nRm9ybWF0KG1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGxldmVsIGRlZmF1bHRzIHRvIHtAbGluayBMT0dHRVJfTEVWRUxTLklORk99XG4gICAgICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICAgICAqL1xuICAgIHJlcG9ydChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCBsZXZlbDogbnVtYmVyID0gTE9HR0VSX0xFVkVMUy5JTkZPLCAuLi5hcmdzOiBhbnlbXSkgOiB2b2lkIHtcbiAgICAgICAgaWYgKGxldmVsIDwgdGhpcy5sZXZlbClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBMb2dnZWRFcnJvciAmJiBtZXNzYWdlLmxvZ2dlZClcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBsZXQgcmVwb3J0TWV0aG9kOiBGdW5jdGlvbjtcbiAgICAgICAgc3dpdGNoIChsZXZlbCl7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLndhcm47XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICBjYXNlIExPR0dFUl9MRVZFTFMuQ1JJVElDQUw6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5lcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgTE9HR0VSX0xFVkVMUy5JTkZPOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkRFQlVHOlxuICAgICAgICAgICAgY2FzZSBMT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5sb2c7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgZmluYWxNZXNzYWdlID0gdGhpcy5idWlsZE1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIHVuZGVmaW5lZCwgLi4uYXJncyk7XG4gICAgICAgIHJlcG9ydE1ldGhvZChmaW5hbE1lc3NhZ2UpO1xuXG4gICAgICAgIGlmIChtZXNzYWdlIGluc3RhbmNlb2YgRXJyb3IgJiYgbWVzc2FnZS5zdGFjayAmJiB0aGlzLmxvZ1N0YWNrVHJhY2Upe1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoYFxcbi0tIFN0YWNrU3RyYWNlOlxcbiR7bWVzc2FnZS5zdGFja31gLCBsZXZlbCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBMb2dnZWRFcnJvcilcbiAgICAgICAgICAgIG1lc3NhZ2UubG9nZ2VkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGluZm8obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5JTkZPLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBhbGwobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5BTEwsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIGRlYnVnKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVwb3J0KG1lc3NhZ2UsIExPR0dFUl9MRVZFTFMuREVCVUcsIC4uLmFyZ3MpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW5oZXJpdERvY1xuICAgICAqL1xuICAgIHdhcm4obWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5yZXBvcnQobWVzc2FnZSwgTE9HR0VSX0xFVkVMUy5XQVJOLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBlcnJvcihtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkVSUk9SLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBjcml0aWNhbChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlcG9ydChtZXNzYWdlLCBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMLCAuLi5hcmdzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGluaGVyaXREb2NcbiAgICAgKi9cbiAgICBzZXRMZXZlbChsZXZlbDogbnVtYmVyKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZGVidWcoc3RyaW5nRm9ybWF0KExPR0dJTkdfTVNHLkxFVkVMX0NIQU5HRUQsIHRoaXMubGV2ZWwudG9TdHJpbmcoKSwgbGV2ZWwudG9TdHJpbmcoKSkpO1xuICAgICAgICB0aGlzLmxldmVsID0gbGV2ZWw7XG4gICAgfVxufVxuXG5sZXQgY3VycmVudExvZ2dlcjogTG9nZ2VyO1xuXG4vKipcbiAqIGdldHMgdGhlIGN1cnJlbnQgTG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIGdldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldExvZ2dlcigpe1xuICAgIGlmICghY3VycmVudExvZ2dlcilcbiAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICByZXR1cm4gY3VycmVudExvZ2dlcjtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSBsb2dnZXJcbiAqXG4gKiBAcGFyYW0ge0xvZ2dlcn0gbG9nZ2VyXG4gKlxuICogQGZ1bmN0aW9uIHNldExvZ2dlclxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNldExvZ2dlcihsb2dnZXI6IExvZ2dlcil7XG4gICAgY3VycmVudExvZ2dlciA9IGxvZ2dlcjtcbiAgICBnZXRMb2dnZXIoKS5kZWJ1ZyhMT0dHSU5HX01TRy5MT0dHRVJfQ0hBTkdFRCk7XG59XG5cbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuSU5GT31cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBpbmZvXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgaW5mbyA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkuaW5mbyhtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuQUxMfVxuICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGFsbFxuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGFsbCA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkuYWxsKG1lc3NhZ2UsIC4uLmFyZ3MpO1xuLyoqXG4gKiBSZXBvcnRzIGEgbWVzc2FnZSB0byB0aGUgbG9nZ2VyIHVuZGVyIHRoZSBsZXZlbCB7QGxpbmsgTE9HR0VSX0xFVkVMUy5ERUJVR31cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiBkZWJ1Z1xuICpcbiAqIEBtZW1iZXJPZiBkYi1kZWNvcmF0b3JzLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGNvbnN0IGRlYnVnID0gKG1lc3NhZ2U6IExvZ2dlck1lc3NhZ2UsIC4uLmFyZ3M6IGFueVtdKSA9PiBnZXRMb2dnZXIoKS5kZWJ1ZyhtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuV0FSTn1cbiAqIEBwYXJhbSB7TG9nZ2VyTWVzc2FnZX0gbWVzc2FnZVxuICogQHBhcmFtIHthbnlbXX0gYXJnc1xuICpcbiAqIEBmdW5jdGlvbiB3YXJuXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3Qgd2FybiA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkud2FybihtZXNzYWdlLCAuLi5hcmdzKTtcbi8qKlxuICogUmVwb3J0cyBhIG1lc3NhZ2UgdG8gdGhlIGxvZ2dlciB1bmRlciB0aGUgbGV2ZWwge0BsaW5rIExPR0dFUl9MRVZFTFMuRVJST1J9XG4gKiBAcGFyYW0ge0xvZ2dlck1lc3NhZ2V9IG1lc3NhZ2VcbiAqIEBwYXJhbSB7YW55W119IGFyZ3NcbiAqXG4gKiBAZnVuY3Rpb24gZXJyb3JcbiAqXG4gKiBAbWVtYmVyT2YgZGItZGVjb3JhdG9ycy5sb2dnaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBlcnJvciA9IChtZXNzYWdlOiBMb2dnZXJNZXNzYWdlLCAuLi5hcmdzOiBhbnlbXSkgPT4gZ2V0TG9nZ2VyKCkuZXJyb3IobWVzc2FnZSwgLi4uYXJncyk7XG4vKipcbiAqIFJlcG9ydHMgYSBtZXNzYWdlIHRvIHRoZSBsb2dnZXIgdW5kZXIgdGhlIGxldmVsIHtAbGluayBMT0dHRVJfTEVWRUxTLkNSSVRJQ0FMfVxuICogQHBhcmFtIHtMb2dnZXJNZXNzYWdlfSBtZXNzYWdlXG4gKiBAcGFyYW0ge2FueVtdfSBhcmdzXG4gKlxuICogQGZ1bmN0aW9uIGNyaXRpY2FsXG4gKlxuICogQG1lbWJlck9mIGRiLWRlY29yYXRvcnMubG9nZ2luZ1xuICovXG5leHBvcnQgY29uc3QgY3JpdGljYWwgPSAobWVzc2FnZTogTG9nZ2VyTWVzc2FnZSwgLi4uYXJnczogYW55W10pID0+IGdldExvZ2dlcigpLmNyaXRpY2FsKG1lc3NhZ2UsIC4uLmFyZ3MpOyIsIlwidXNlIHN0cmljdFwiO1xudmFyIF9fc3ByZWFkQXJyYXkgPSAodGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXkpIHx8IGZ1bmN0aW9uICh0bywgZnJvbSwgcGFjaykge1xuICAgIGlmIChwYWNrIHx8IGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIGZvciAodmFyIGkgPSAwLCBsID0gZnJvbS5sZW5ndGgsIGFyOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGlmIChhciB8fCAhKGkgaW4gZnJvbSkpIHtcbiAgICAgICAgICAgIGlmICghYXIpIGFyID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbSwgMCwgaSk7XG4gICAgICAgICAgICBhcltpXSA9IGZyb21baV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRvLmNvbmNhdChhciB8fCBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tKSk7XG59O1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy5jcml0aWNhbCA9IGV4cG9ydHMuZXJyb3IgPSBleHBvcnRzLndhcm4gPSBleHBvcnRzLmRlYnVnID0gZXhwb3J0cy5hbGwgPSBleHBvcnRzLmluZm8gPSBleHBvcnRzLnNldExvZ2dlciA9IGV4cG9ydHMuZ2V0TG9nZ2VyID0gZXhwb3J0cy5Mb2dnZXJJbXAgPSB2b2lkIDA7XG52YXIgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb25zdGFudHNcIik7XG52YXIgZXJyb3JzXzEgPSByZXF1aXJlKFwiLi4vZXJyb3JzXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcbnZhciBMb2dnZXJJbXAgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExvZ2dlckltcChkZWZhdWx0TGV2ZWwsIHVzZVRpbWVzdGFtcCwgbG9nTGV2ZWwsIGxvZ1N0YWNrVHJhY2UsIHRpbWVzdGFtcEZvcm1hdCkge1xuICAgICAgICBpZiAoZGVmYXVsdExldmVsID09PSB2b2lkIDApIHsgZGVmYXVsdExldmVsID0gY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOyB9XG4gICAgICAgIGlmICh1c2VUaW1lc3RhbXAgPT09IHZvaWQgMCkgeyB1c2VUaW1lc3RhbXAgPSB0cnVlOyB9XG4gICAgICAgIGlmIChsb2dMZXZlbCA9PT0gdm9pZCAwKSB7IGxvZ0xldmVsID0gdHJ1ZTsgfVxuICAgICAgICBpZiAobG9nU3RhY2tUcmFjZSA9PT0gdm9pZCAwKSB7IGxvZ1N0YWNrVHJhY2UgPSBmYWxzZTsgfVxuICAgICAgICBpZiAodGltZXN0YW1wRm9ybWF0ID09PSB2b2lkIDApIHsgdGltZXN0YW1wRm9ybWF0ID0gY29uc3RhbnRzXzEuREVGQVVMVF9USU1FU1RBTVBfRk9STUFUOyB9XG4gICAgICAgIHRoaXMubGV2ZWwgPSBkZWZhdWx0TGV2ZWw7XG4gICAgICAgIHRoaXMudXNlVGltZXN0YW1wID0gdXNlVGltZXN0YW1wO1xuICAgICAgICB0aGlzLmxvZ0xldmVsID0gbG9nTGV2ZWw7XG4gICAgICAgIHRoaXMubG9nU3RhY2tUcmFjZSA9IGxvZ1N0YWNrVHJhY2U7XG4gICAgICAgIHRoaXMudGltZXN0YW1wRm9ybWF0ID0gdGltZXN0YW1wRm9ybWF0O1xuICAgIH1cbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmJ1aWxkTWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlLCBsb2dMZXZlbCwgaXNzdWVyKSB7XG4gICAgICAgIGlmIChpc3N1ZXIgPT09IHZvaWQgMCkgeyBpc3N1ZXIgPSB1bmRlZmluZWQ7IH1cbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAzOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAzXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YWNrc1RyYWNlID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICBzdGFja3NUcmFjZSA9IG1lc3NhZ2Uuc3RhY2s7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZS5tZXNzYWdlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmxvZ0xldmVsKVxuICAgICAgICAgICAgbWVzc2FnZSA9IFwiW1wiLmNvbmNhdChPYmplY3Qua2V5cyhjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTKVtsb2dMZXZlbF0sIFwiXSAtIFwiKS5jb25jYXQobWVzc2FnZSk7XG4gICAgICAgIGlmIChpc3N1ZXIpXG4gICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KGlzc3Vlci50b1N0cmluZygpLCBcIl1cIikuY29uY2F0KG1lc3NhZ2UpO1xuICAgICAgICBpZiAodGhpcy51c2VUaW1lc3RhbXApXG4gICAgICAgICAgICBtZXNzYWdlID0gXCJbXCIuY29uY2F0KCgwLCB1dGlsc18xLmZvcm1hdERhdGUpKG5ldyBEYXRlKCksIHRoaXMudGltZXN0YW1wRm9ybWF0KSwgXCJdXCIpLmNvbmNhdChtZXNzYWdlKTtcbiAgICAgICAgcmV0dXJuIHV0aWxzXzEuc3RyaW5nRm9ybWF0LmFwcGx5KHZvaWQgMCwgX19zcHJlYWRBcnJheShbbWVzc2FnZV0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLnJlcG9ydCA9IGZ1bmN0aW9uIChtZXNzYWdlLCBsZXZlbCkge1xuICAgICAgICBpZiAobGV2ZWwgPT09IHZvaWQgMCkgeyBsZXZlbCA9IGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GTzsgfVxuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGV2ZWwgPCB0aGlzLmxldmVsKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBpZiAobWVzc2FnZSBpbnN0YW5jZW9mIGVycm9yc18xLkxvZ2dlZEVycm9yICYmIG1lc3NhZ2UubG9nZ2VkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgcmVwb3J0TWV0aG9kO1xuICAgICAgICBzd2l0Y2ggKGxldmVsKSB7XG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuV0FSTjpcbiAgICAgICAgICAgICAgICByZXBvcnRNZXRob2QgPSBjb25zb2xlLndhcm47XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuRVJST1I6XG4gICAgICAgICAgICBjYXNlIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuQ1JJVElDQUw6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5lcnJvcjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5JTkZPOlxuICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHOlxuICAgICAgICAgICAgY2FzZSBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkFMTDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmVwb3J0TWV0aG9kID0gY29uc29sZS5sb2c7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbmFsTWVzc2FnZSA9IHRoaXMuYnVpbGRNZXNzYWdlLmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGxldmVsLCB1bmRlZmluZWRdLCBhcmdzLCBmYWxzZSkpO1xuICAgICAgICByZXBvcnRNZXRob2QoZmluYWxNZXNzYWdlKTtcbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBFcnJvciAmJiBtZXNzYWdlLnN0YWNrICYmIHRoaXMubG9nU3RhY2tUcmFjZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2cobWVzc2FnZSk7XG4gICAgICAgICAgICByZXBvcnRNZXRob2QodGhpcy5idWlsZE1lc3NhZ2UoXCJcXG4tLSBTdGFja1N0cmFjZTpcXG5cIi5jb25jYXQobWVzc2FnZS5zdGFjayksIGxldmVsKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lc3NhZ2UgaW5zdGFuY2VvZiBlcnJvcnNfMS5Mb2dnZWRFcnJvcilcbiAgICAgICAgICAgIG1lc3NhZ2UubG9nZ2VkID0gdHJ1ZTtcbiAgICB9O1xuICAgIExvZ2dlckltcC5wcm90b3R5cGUuaW5mbyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuSU5GT10sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmFsbCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuQUxMXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIExvZ2dlckltcC5wcm90b3R5cGUuZGVidWcgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlcG9ydC5hcHBseSh0aGlzLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlLCBjb25zdGFudHNfMS5MT0dHRVJfTEVWRUxTLkRFQlVHXSwgYXJncywgZmFsc2UpKTtcbiAgICB9O1xuICAgIExvZ2dlckltcC5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVwb3J0LmFwcGx5KHRoaXMsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2UsIGNvbnN0YW50c18xLkxPR0dFUl9MRVZFTFMuV0FSTl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5FUlJPUl0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLmNyaXRpY2FsID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXBvcnQuYXBwbHkodGhpcywgX19zcHJlYWRBcnJheShbbWVzc2FnZSwgY29uc3RhbnRzXzEuTE9HR0VSX0xFVkVMUy5DUklUSUNBTF0sIGFyZ3MsIGZhbHNlKSk7XG4gICAgfTtcbiAgICBMb2dnZXJJbXAucHJvdG90eXBlLnNldExldmVsID0gZnVuY3Rpb24gKGxldmVsKSB7XG4gICAgICAgIHRoaXMuZGVidWcoKDAsIHV0aWxzXzEuc3RyaW5nRm9ybWF0KShjb25zdGFudHNfMS5MT0dHSU5HX01TRy5MRVZFTF9DSEFOR0VELCB0aGlzLmxldmVsLnRvU3RyaW5nKCksIGxldmVsLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgdGhpcy5sZXZlbCA9IGxldmVsO1xuICAgIH07XG4gICAgcmV0dXJuIExvZ2dlckltcDtcbn0oKSk7XG5leHBvcnRzLkxvZ2dlckltcCA9IExvZ2dlckltcDtcbnZhciBjdXJyZW50TG9nZ2VyO1xuZnVuY3Rpb24gZ2V0TG9nZ2VyKCkge1xuICAgIGlmICghY3VycmVudExvZ2dlcilcbiAgICAgICAgY3VycmVudExvZ2dlciA9IG5ldyBMb2dnZXJJbXAoKTtcbiAgICByZXR1cm4gY3VycmVudExvZ2dlcjtcbn1cbmV4cG9ydHMuZ2V0TG9nZ2VyID0gZ2V0TG9nZ2VyO1xuZnVuY3Rpb24gc2V0TG9nZ2VyKGxvZ2dlcikge1xuICAgIGN1cnJlbnRMb2dnZXIgPSBsb2dnZXI7XG4gICAgZ2V0TG9nZ2VyKCkuZGVidWcoY29uc3RhbnRzXzEuTE9HR0lOR19NU0cuTE9HR0VSX0NIQU5HRUQpO1xufVxuZXhwb3J0cy5zZXRMb2dnZXIgPSBzZXRMb2dnZXI7XG52YXIgaW5mbyA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS5pbmZvLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLmluZm8gPSBpbmZvO1xudmFyIGFsbCA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS5hbGwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xufTtcbmV4cG9ydHMuYWxsID0gYWxsO1xudmFyIGRlYnVnID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB2YXIgX2E7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKF9hID0gZ2V0TG9nZ2VyKCkpLmRlYnVnLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLmRlYnVnID0gZGVidWc7XG52YXIgd2FybiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgdmFyIF9hO1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIChfYSA9IGdldExvZ2dlcigpKS53YXJuLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLndhcm4gPSB3YXJuO1xudmFyIGVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICB2YXIgX2E7XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICByZXR1cm4gKF9hID0gZ2V0TG9nZ2VyKCkpLmVycm9yLmFwcGx5KF9hLCBfX3NwcmVhZEFycmF5KFttZXNzYWdlXSwgYXJncywgZmFsc2UpKTtcbn07XG5leHBvcnRzLmVycm9yID0gZXJyb3I7XG52YXIgY3JpdGljYWwgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIHZhciBfYTtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMTsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHJldHVybiAoX2EgPSBnZXRMb2dnZXIoKSkuY3JpdGljYWwuYXBwbHkoX2EsIF9fc3ByZWFkQXJyYXkoW21lc3NhZ2VdLCBhcmdzLCBmYWxzZSkpO1xufTtcbmV4cG9ydHMuY3JpdGljYWwgPSBjcml0aWNhbDsiLCIvKipcbiAqIEBuYW1lc3BhY2UgbG9nZ2luZy5sb2dnaW5nXG4gKiBAbWVtYmVyT2YgbG9nZ2luZ1xuICovXG5cbmV4cG9ydCAqIGZyb20gJy4vY29uc3RhbnRzJztcbmV4cG9ydCAqIGZyb20gJy4vbG9nZ2luZyc7XG5leHBvcnQgKiBmcm9tICcuL2RlY29yYXRvcnMnO1xuZXhwb3J0ICogZnJvbSAnLi91dGlscyc7IiwiLyoqXG4gKiBVdGlsIGZ1bmN0aW9uIHRvIHByb3ZpZGUgc3RyaW5nIGZvcm1hdCBmdW5jdGlvbmFsaXR5IHNpbWlsYXIgdG8gQyMncyBzdHJpbmcuZm9ybWF0XG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZ1xuICogQHBhcmFtIHtzdHJpbmd9IGFyZ3MgcmVwbGFjZW1lbnRzIG1hZGUgYnkgb3JkZXIgb2YgYXBwZWFyYW5jZSAocmVwbGFjZW1lbnQwIHdpbCByZXBsYWNlIHswfSBhbmQgc28gb24pXG4gKiBAcmV0dXJuIHtzdHJpbmd9IGZvcm1hdHRlZCBzdHJpbmdcbiAqXG4gKiBAZnVuY3Rpb24gc3RyaW5nRm9ybWF0XG4gKlxuICogQG1lbWJlck9mIGxvZ2dpbmcubG9nZ2luZ1xuICovXG5pbXBvcnQge0RBWVNfT0ZfV0VFS19OQU1FUywgTU9OVEhfTkFNRVN9IGZyb20gXCIuL2NvbnN0YW50c1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gc3RyaW5nRm9ybWF0KHN0cmluZzogc3RyaW5nLCAuLi5hcmdzOiBzdHJpbmdbXSl7XG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC97KFxcZCspfS9nLCBmdW5jdGlvbihtYXRjaCwgbnVtYmVyKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgYXJnc1tudW1iZXJdICE9PSAndW5kZWZpbmVkJ1xuICAgICAgICAgICAgPyBhcmdzW251bWJlcl1cbiAgICAgICAgICAgIDogbWF0Y2g7XG4gICAgfSk7XG59XG5cbi8qKlxuICogRGF0ZSBGb3JtYXQgSGFuZGxpbmdcbiAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzM1NTI0NjEvaG93LXRvLWZvcm1hdC1hLWphdmFzY3JpcHQtZGF0ZVxuICpcbiAqIDxwcmU+XG4gKiAgICAgIFVzaW5nIHNpbWlsYXIgZm9ybWF0dGluZyBhcyBNb21lbnQuanMsIENsYXNzIERhdGVUaW1lRm9ybWF0dGVyIChKYXZhKSwgYW5kIENsYXNzIFNpbXBsZURhdGVGb3JtYXQgKEphdmEpLFxuICogICAgICBJIGltcGxlbWVudGVkIGEgY29tcHJlaGVuc2l2ZSBzb2x1dGlvbiBmb3JtYXREYXRlKGRhdGUsIHBhdHRlcm5TdHIpIHdoZXJlIHRoZSBjb2RlIGlzIGVhc3kgdG8gcmVhZCBhbmQgbW9kaWZ5LlxuICogICAgICBZb3UgY2FuIGRpc3BsYXkgZGF0ZSwgdGltZSwgQU0vUE0sIGV0Yy5cbiAqXG4gKiAgICAgIERhdGUgYW5kIFRpbWUgUGF0dGVybnNcbiAqICAgICAgeXkgPSAyLWRpZ2l0IHllYXI7IHl5eXkgPSBmdWxsIHllYXJcbiAqICAgICAgTSA9IGRpZ2l0IG1vbnRoOyBNTSA9IDItZGlnaXQgbW9udGg7IE1NTSA9IHNob3J0IG1vbnRoIG5hbWU7IE1NTU0gPSBmdWxsIG1vbnRoIG5hbWVcbiAqICAgICAgRUVFRSA9IGZ1bGwgd2Vla2RheSBuYW1lOyBFRUUgPSBzaG9ydCB3ZWVrZGF5IG5hbWVcbiAqICAgICAgZCA9IGRpZ2l0IGRheTsgZGQgPSAyLWRpZ2l0IGRheVxuICogICAgICBoID0gaG91cnMgYW0vcG07IGhoID0gMi1kaWdpdCBob3VycyBhbS9wbTsgSCA9IGhvdXJzOyBISCA9IDItZGlnaXQgaG91cnNcbiAqICAgICAgbSA9IG1pbnV0ZXM7IG1tID0gMi1kaWdpdCBtaW51dGVzOyBhYWEgPSBBTS9QTVxuICogICAgICBzID0gc2Vjb25kczsgc3MgPSAyLWRpZ2l0IHNlY29uZHNcbiAqICAgICAgUyA9IG1pbGlzZWNvbmRzXG4gKiA8L3ByZT5cbiAqXG4gKiBAcGFyYW0ge0RhdGV9IGRhdGVcbiAqIEBwYXJhbSB7c3RyaW5nfSBbcGF0dGVyblN0cl0gZGVmYXVsdHMgdG8gJ3l5eXkvTU0vZGQnXG4gKiBAcmV0dXJuIHtzdHJpbmd9IHRoZSBmb3JtYXR0ZWQgZGF0ZVxuICpcbiAqIEBmdW5jdGlvbiBmb3JtYXREYXRlXG4gKlxuICogQG1lbWJlck9mIGxvZ2dpbmcubG9nZ2luZ1xuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlOiBEYXRlLCBwYXR0ZXJuU3RyOiBzdHJpbmcgPSAneXl5eS9NTS9kZCcpe1xuICAgIGNvbnN0IGRheTogbnVtYmVyID0gZGF0ZS5nZXREYXRlKCksXG4gICAgICAgIG1vbnRoOiBudW1iZXIgPSBkYXRlLmdldE1vbnRoKCksXG4gICAgICAgIHllYXI6IG51bWJlciA9IGRhdGUuZ2V0RnVsbFllYXIoKSxcbiAgICAgICAgaG91cjogbnVtYmVyID0gZGF0ZS5nZXRIb3VycygpLFxuICAgICAgICBtaW51dGU6IG51bWJlciA9IGRhdGUuZ2V0TWludXRlcygpLFxuICAgICAgICBzZWNvbmQ6IG51bWJlciA9IGRhdGUuZ2V0U2Vjb25kcygpLFxuICAgICAgICBtaWxpc2Vjb25kczogbnVtYmVyID0gZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSxcbiAgICAgICAgaDogbnVtYmVyID0gaG91ciAlIDEyLFxuICAgICAgICBoaDogc3RyaW5nID0gdHdvRGlnaXRQYWQoaCksXG4gICAgICAgIEhIOiBzdHJpbmcgPSB0d29EaWdpdFBhZChob3VyKSxcbiAgICAgICAgbW06IHN0cmluZyA9IHR3b0RpZ2l0UGFkKG1pbnV0ZSksXG4gICAgICAgIHNzOiBzdHJpbmcgPSB0d29EaWdpdFBhZChzZWNvbmQpLFxuICAgICAgICBhYWE6IHN0cmluZyA9IGhvdXIgPCAxMiA/ICdBTScgOiAnUE0nLFxuICAgICAgICBFRUVFOiBzdHJpbmcgPSBEQVlTX09GX1dFRUtfTkFNRVNbZGF0ZS5nZXREYXkoKV0sXG4gICAgICAgIEVFRTogc3RyaW5nID0gRUVFRS5zdWJzdHIoMCwgMyksXG4gICAgICAgIGRkOiBzdHJpbmcgPSB0d29EaWdpdFBhZChkYXkpLFxuICAgICAgICBNOiBudW1iZXIgPSBtb250aCArIDEsXG4gICAgICAgIE1NOiBzdHJpbmcgPSB0d29EaWdpdFBhZChNKSxcbiAgICAgICAgTU1NTTogc3RyaW5nID0gTU9OVEhfTkFNRVNbbW9udGhdLFxuICAgICAgICBNTU0gOiBzdHJpbmc9IE1NTU0uc3Vic3RyKDAsIDMpLFxuICAgICAgICB5eXl5OiBzdHJpbmcgPSB5ZWFyICsgXCJcIixcbiAgICAgICAgeXk6IHN0cmluZyA9IHl5eXkuc3Vic3RyKDIsIDIpXG4gICAgO1xuICAgIC8vIGNoZWNrcyB0byBzZWUgaWYgbW9udGggbmFtZSB3aWxsIGJlIHVzZWRcbiAgICBwYXR0ZXJuU3RyID0gcGF0dGVyblN0clxuICAgICAgICAucmVwbGFjZSgnaGgnLCBoaCkucmVwbGFjZSgnaCcsIGgudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ0hIJywgSEgpLnJlcGxhY2UoJ0gnLCBob3VyLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdtbScsIG1tKS5yZXBsYWNlKCdtJywgbWludXRlLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdzcycsIHNzKS5yZXBsYWNlKCdzJywgc2Vjb25kLnRvU3RyaW5nKCkpXG4gICAgICAgIC5yZXBsYWNlKCdTJywgbWlsaXNlY29uZHMudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ2RkJywgZGQpLnJlcGxhY2UoJ2QnLCBkYXkudG9TdHJpbmcoKSlcblxuICAgICAgICAucmVwbGFjZSgnRUVFRScsIEVFRUUpLnJlcGxhY2UoJ0VFRScsIEVFRSlcbiAgICAgICAgLnJlcGxhY2UoJ3l5eXknLCB5eXl5KVxuICAgICAgICAucmVwbGFjZSgneXknLCB5eSlcbiAgICAgICAgLnJlcGxhY2UoJ2FhYScsIGFhYSk7XG4gICAgaWYgKHBhdHRlcm5TdHIuaW5kZXhPZignTU1NJykgPiAtMSkge1xuICAgICAgICBwYXR0ZXJuU3RyID0gcGF0dGVyblN0clxuICAgICAgICAgICAgLnJlcGxhY2UoJ01NTU0nLCBNTU1NKVxuICAgICAgICAgICAgLnJlcGxhY2UoJ01NTScsIE1NTSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBwYXR0ZXJuU3RyID0gcGF0dGVyblN0clxuICAgICAgICAgICAgLnJlcGxhY2UoJ01NJywgTU0pXG4gICAgICAgICAgICAucmVwbGFjZSgnTScsIE0udG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHJldHVybiBwYXR0ZXJuU3RyO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0ge251bWJlcn0gbnVtXG4gKlxuICogQHJldHVybiB7c3RyaW5nfVxuICpcbiAqIEBmdW5jdGlvbiB0d29EaWdpdFBhZFxuICpcbiAqIEBtZW1iZXJPZiBsb2dnaW5nLmxvZ2dpbmdcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHR3b0RpZ2l0UGFkKG51bTogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gbnVtIDwgMTAgPyBcIjBcIiArIG51bSA6IG51bS50b1N0cmluZygpO1xufSIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZXhwb3J0cy50d29EaWdpdFBhZCA9IGV4cG9ydHMuZm9ybWF0RGF0ZSA9IGV4cG9ydHMuc3RyaW5nRm9ybWF0ID0gdm9pZCAwO1xudmFyIGNvbnN0YW50c18xID0gcmVxdWlyZShcIi4vY29uc3RhbnRzXCIpO1xuZnVuY3Rpb24gc3RyaW5nRm9ybWF0KHN0cmluZykge1xuICAgIHZhciBhcmdzID0gW107XG4gICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC97KFxcZCspfS9nLCBmdW5jdGlvbiAobWF0Y2gsIG51bWJlcikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGFyZ3NbbnVtYmVyXSAhPT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgID8gYXJnc1tudW1iZXJdXG4gICAgICAgICAgICA6IG1hdGNoO1xuICAgIH0pO1xufVxuZXhwb3J0cy5zdHJpbmdGb3JtYXQgPSBzdHJpbmdGb3JtYXQ7XG5mdW5jdGlvbiBmb3JtYXREYXRlKGRhdGUsIHBhdHRlcm5TdHIpIHtcbiAgICBpZiAocGF0dGVyblN0ciA9PT0gdm9pZCAwKSB7IHBhdHRlcm5TdHIgPSAneXl5eS9NTS9kZCc7IH1cbiAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXRlKCksIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpLCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpLCBob3VyID0gZGF0ZS5nZXRIb3VycygpLCBtaW51dGUgPSBkYXRlLmdldE1pbnV0ZXMoKSwgc2Vjb25kID0gZGF0ZS5nZXRTZWNvbmRzKCksIG1pbGlzZWNvbmRzID0gZGF0ZS5nZXRNaWxsaXNlY29uZHMoKSwgaCA9IGhvdXIgJSAxMiwgaGggPSB0d29EaWdpdFBhZChoKSwgSEggPSB0d29EaWdpdFBhZChob3VyKSwgbW0gPSB0d29EaWdpdFBhZChtaW51dGUpLCBzcyA9IHR3b0RpZ2l0UGFkKHNlY29uZCksIGFhYSA9IGhvdXIgPCAxMiA/ICdBTScgOiAnUE0nLCBFRUVFID0gY29uc3RhbnRzXzEuREFZU19PRl9XRUVLX05BTUVTW2RhdGUuZ2V0RGF5KCldLCBFRUUgPSBFRUVFLnN1YnN0cigwLCAzKSwgZGQgPSB0d29EaWdpdFBhZChkYXkpLCBNID0gbW9udGggKyAxLCBNTSA9IHR3b0RpZ2l0UGFkKE0pLCBNTU1NID0gY29uc3RhbnRzXzEuTU9OVEhfTkFNRVNbbW9udGhdLCBNTU0gPSBNTU1NLnN1YnN0cigwLCAzKSwgeXl5eSA9IHllYXIgKyBcIlwiLCB5eSA9IHl5eXkuc3Vic3RyKDIsIDIpO1xuICAgIHBhdHRlcm5TdHIgPSBwYXR0ZXJuU3RyXG4gICAgICAgIC5yZXBsYWNlKCdoaCcsIGhoKS5yZXBsYWNlKCdoJywgaC50b1N0cmluZygpKVxuICAgICAgICAucmVwbGFjZSgnSEgnLCBISCkucmVwbGFjZSgnSCcsIGhvdXIudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ21tJywgbW0pLnJlcGxhY2UoJ20nLCBtaW51dGUudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ3NzJywgc3MpLnJlcGxhY2UoJ3MnLCBzZWNvbmQudG9TdHJpbmcoKSlcbiAgICAgICAgLnJlcGxhY2UoJ1MnLCBtaWxpc2Vjb25kcy50b1N0cmluZygpKVxuICAgICAgICAucmVwbGFjZSgnZGQnLCBkZCkucmVwbGFjZSgnZCcsIGRheS50b1N0cmluZygpKVxuICAgICAgICAucmVwbGFjZSgnRUVFRScsIEVFRUUpLnJlcGxhY2UoJ0VFRScsIEVFRSlcbiAgICAgICAgLnJlcGxhY2UoJ3l5eXknLCB5eXl5KVxuICAgICAgICAucmVwbGFjZSgneXknLCB5eSlcbiAgICAgICAgLnJlcGxhY2UoJ2FhYScsIGFhYSk7XG4gICAgaWYgKHBhdHRlcm5TdHIuaW5kZXhPZignTU1NJykgPiAtMSkge1xuICAgICAgICBwYXR0ZXJuU3RyID0gcGF0dGVyblN0clxuICAgICAgICAgICAgLnJlcGxhY2UoJ01NTU0nLCBNTU1NKVxuICAgICAgICAgICAgLnJlcGxhY2UoJ01NTScsIE1NTSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBwYXR0ZXJuU3RyID0gcGF0dGVyblN0clxuICAgICAgICAgICAgLnJlcGxhY2UoJ01NJywgTU0pXG4gICAgICAgICAgICAucmVwbGFjZSgnTScsIE0udG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHJldHVybiBwYXR0ZXJuU3RyO1xufVxuZXhwb3J0cy5mb3JtYXREYXRlID0gZm9ybWF0RGF0ZTtcbmZ1bmN0aW9uIHR3b0RpZ2l0UGFkKG51bSkge1xuICAgIHJldHVybiBudW0gPCAxMCA/IFwiMFwiICsgbnVtIDogbnVtLnRvU3RyaW5nKCk7XG59XG5leHBvcnRzLnR3b0RpZ2l0UGFkID0gdHdvRGlnaXRQYWQ7Il19
