name: herebedragons-studios/ts-logging
on:
  push:
    branches: [ master ]
    pull_request:

jobs:
  install:
    runs-on: ubuntu-latest
    container:
      image: node:18
    timeout-minutes: 60
    steps:
      - uses: actions/checkout@v4.0.0
      - uses: actions/setup-node@v3
        with:
          node-version: 18
      - name: Cache Node Modules
        uses: actions/cache@v3.3.2
        with:
          path: |
            node_modules/
            .npm/
          key: dependencies-${{ github.ref }}-${{ github.workspace }}${{ hashFiles('**/package-lock.json') }}
      - name: Install Dependencies
        run: npm ci --cache .npm --prefer-offline
#
#  build:
#    needs: install
#    runs-on: ubuntu-latest
#    container:
#      image: node:18
#    timeout-minutes: 60
#    steps:
#      - uses: actions/checkout@v4.0.0
#      - name:  Restoring Node Modules
#        uses: actions/cache@v3.3.2
#        with:
#          key: dependencies-${{ github.ref }}-${{ github.workspace }}${{ hashFiles('**/package-lock.json') }}
#      - name: Caching build code
#        uses: actions/cache@v3.3.2
#        with:
#          path: |
#            dist/
#            lib/
#          key: build-${{ github.ref }}-${{ github.workspace }}
#      - name: Building solution...
#        run: npm run build:prod
#
#  tests:
#    needs: build
#    runs-on: ubuntu-latest
#    container:
#      image: node:18
#    timeout-minutes: 60
#    steps:
#      - uses: actions/checkout@v4.0.0
#      - name: Restoring Node Modules
#        uses: actions/cache@v3.3.2
#        with:
#          key: dependencies-${{ github.ref }}-${{ github.workspace }}${{ hashFiles('**/package-lock.json') }}
#      - name: Restoring built solution...
#        uses: actions/cache@v3.3.2
#          with:
#            key: build-${{ github.ref }}-${{ github.workspace }}
#      - name: Caching test results...
#        uses: actions/cache@v3.3.2
#        with:
#          path: workdocs/coverage/
#          key: test-${{ github.ref }}-${{ github.workspace }}
#      - run: npm run test:ci
#  #     # 'artifacts.junit' was not transformed because there is no suitable equivalent in GitHub Actions
#  #     # 'coverage' was not transformed because there is no suitable equivalent in GitHub Actions.
#
#  npm-deploy:
#    needs:
#      - tests
#      - build
#    runs-on: ubuntu-latest
#    permissions:
#      contents: read
#      packages: write # allow GITHUB_TOKEN to publish packages
#    container:
#      image: node:18
#    if: (startsWith(github.ref, 'refs/tags')) && !(startsWith(github.ref, 'refs/heads'))
#    timeout-minutes: 60
#    steps:
#      - uses: actions/checkout@v4.0.0
#      - name: Restoring Node Modules
#        uses: actions/cache@v3.3.2
#        with:
#          key: dependencies-${{ github.ref }}-${{ github.workspace }}${{ hashFiles('**/package-lock.json') }}
#      - name: Restoring built solution...
#        uses: actions/cache@v3.3.2
#        with:
#          key: build-${{ github.ref }}-${{ github.workspace }}
#      - run: echo "Attempting to publish package ${NPM_PACKAGE_NAME} version ${NPM_PACKAGE_VERSION} to NPM registry."
#      - name: Publishing to npm...
#        uses: JS-DevTools/npm-publish@v2
#        with:
#          token: ${{ secrets.GITHUB_TOKEN }}
#          registry: "https://npm.pkg.github.com"
#
#  pages:
#    needs: tests
#    runs-on: ubuntu-latest
#    container:
#      image: node:18
#    timeout-minutes: 60
#    continue-on-error: true
#    steps:
#      - uses: actions/checkout@v4.0.0
#      - name: Restoring Node Modules
#        uses: actions/cache@v3.3.2
#        with:
#          key: dependencies-${{ github.ref }}-${{ github.workspace }}${{ hashFiles('**/package-lock.json') }}
#      - name: Restoring built solution...
#        uses: actions/cache@v3.3.2
#        with:
#          key: test-${{ github.ref }}-${{ github.workspace }}
#      - run: npm run docs
#      - run: mv docs public
#      - uses: actions/upload-artifact@v3.1.3
#        if: success()
#        with:
#          name: "${{ github.job }}"
#          path: public
#      - uses: JamesIves/github-pages-deploy-action@v4.4.3
#        with:
#          branch: gh-pages
#          folder: public
